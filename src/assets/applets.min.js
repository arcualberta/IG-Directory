var Applets=function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){i(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var o,r,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw r}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var c={pageId:{required:!1,type:null},blockId:{required:!1,type:null},appletTitle:{required:!1,type:String},dataAttributes:{required:!1,type:null},queryParameters:{required:!1,type:null}},u=e.defineComponent({name:"Carousel",components:{},props:c,setup:function(e,t){console.log("Carousel setup ..."),console.log("props: ",e),console.log("context: ",t)},mounted:function(){console.log("Carousel mounted ...")}}),d=e.createElementVNode("h2",null,"Carousel",-1),m={class:"row"},f={class:"row"},_={class:"row"};function p(){return"undefined"!=typeof navigator&&"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}u.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",null,[d,e.createElementVNode("div",m,"Page Id: "+e.toDisplayString(t.pageId),1),e.createElementVNode("div",f,"Block Id: "+e.toDisplayString(t.blockId),1),e.createElementVNode("div",_,"Data Attributes "+e.toDisplayString(t.dataAttributes),1)])};const h="function"==typeof Proxy;class v{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const t in e.settings){const o=e.settings[t];n[t]=o.defaultValue}const o=`__vue-devtools-plugin-settings__${e.id}`;let r={...n};try{const e=localStorage.getItem(o),t=JSON.parse(e);Object.assign(r,t)}catch(e){}this.fallbacks={getSettings:()=>r,setSettings(e){try{localStorage.setItem(o,JSON.stringify(e))}catch(e){}r=e}},t.on("plugin:settings:set",((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((n=>{this.targetQueue.push({method:t,args:e,resolve:n})}))})}async setRealTarget(e){this.target=e;for(const e of this.onQueue)this.target.on[e.method](...e.args);for(const e of this.targetQueue)e.resolve(await this.target[e.method](...e.args))}}function b(e,t){const n=p(),o=p().__VUE_DEVTOOLS_GLOBAL_HOOK__,r=h&&e.enableEarlyProxy;if(!o||!n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&r){const a=r?new v(e,o):null;(n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:e,setupFn:t,proxy:a}),a&&t(a.proxiedTarget)}else o.emit("devtools-plugin:setup",e,t)}
/*!
 * vuex v4.0.2
 * (c) 2021 Evan You
 * @license MIT
 */var g="store";function E(t){return void 0===t&&(t=null),e.inject(null!==t?t:g)}function S(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function k(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function y(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;B(e,n,[],e._modules.root,!0),T(e,n,t)}function T(t,n,o){var r=t._state;t.getters={},t._makeLocalGettersCache=Object.create(null);var a=t._wrappedGetters,i={};S(a,(function(e,n){i[n]=function(e,t){return function(){return e(t)}}(e,t),Object.defineProperty(t.getters,n,{get:function(){return i[n]()},enumerable:!0})})),t._state=e.reactive({data:n}),t.strict&&function(t){e.watch((function(){return t._state.data}),(function(){}),{deep:!0,flush:"sync"})}(t),r&&o&&t._withCommit((function(){r.data=null}))}function B(e,t,n,o,r){var a=!n.length,i=e._modules.getNamespace(n);if(o.namespaced&&(e._modulesNamespaceMap[i],e._modulesNamespaceMap[i]=o),!a&&!r){var l=I(t,n.slice(0,-1)),s=n[n.length-1];e._withCommit((function(){l[s]=o.state}))}var c=o.context=function(e,t,n){var o=""===t,r={dispatch:o?e.dispatch:function(n,o,r){var a=R(n,o,r),i=a.payload,l=a.options,s=a.type;return l&&l.root||(s=t+s),e.dispatch(s,i)},commit:o?e.commit:function(n,o,r){var a=R(n,o,r),i=a.payload,l=a.options,s=a.type;l&&l.root||(s=t+s),e.commit(s,i,l)}};return Object.defineProperties(r,{getters:{get:o?function(){return e.getters}:function(){return A(e,t)}},state:{get:function(){return I(e.state,n)}}}),r}(e,i,n);o.forEachMutation((function(t,n){!function(e,t,n,o){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){n.call(e,o.state,t)}))}(e,i+n,t,c)})),o.forEachAction((function(t,n){var o=t.root?n:i+n,r=t.handler||t;!function(e,t,n,o){(e._actions[t]||(e._actions[t]=[])).push((function(t){var r,a=n.call(e,{dispatch:o.dispatch,commit:o.commit,getters:o.getters,state:o.state,rootGetters:e.getters,rootState:e.state},t);return(r=a)&&"function"==typeof r.then||(a=Promise.resolve(a)),e._devtoolHook?a.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):a}))}(e,o,r,c)})),o.forEachGetter((function(t,n){!function(e,t,n,o){if(e._wrappedGetters[t])return;e._wrappedGetters[t]=function(e){return n(o.state,o.getters,e.state,e.getters)}}(e,i+n,t,c)})),o.forEachChild((function(o,a){B(e,t,n.concat(a),o,r)}))}function A(e,t){if(!e._makeLocalGettersCache[t]){var n={},o=t.length;Object.keys(e.getters).forEach((function(r){if(r.slice(0,o)===t){var a=r.slice(o);Object.defineProperty(n,a,{get:function(){return e.getters[r]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function I(e,t){return t.reduce((function(e,t){return e[t]}),e)}function R(e,t,n){var o;return null!==(o=e)&&"object"==typeof o&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}var M="vuex:mutations",w="vuex:actions",C="vuex",x=0;function F(e,t){b({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:["vuex bindings"]},(function(n){n.addTimelineLayer({id:M,label:"Vuex Mutations",color:N}),n.addTimelineLayer({id:w,label:"Vuex Actions",color:N}),n.addInspector({id:C,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree((function(n){if(n.app===e&&n.inspectorId===C)if(n.filter){var o=[];L(o,t._modules.root,n.filter,""),n.rootNodes=o}else n.rootNodes=[O(t._modules.root,"")]})),n.on.getInspectorState((function(n){if(n.app===e&&n.inspectorId===C){var o=n.nodeId;A(t,o),n.state=function(e,t,n){t="root"===n?t:t[n];var o=Object.keys(t),r={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(o.length){var a=function(e){var t={};return Object.keys(e).forEach((function(n){var o=n.split("/");if(o.length>1){var r=t,a=o.pop();o.forEach((function(e){r[e]||(r[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),r=r[e]._custom.value})),r[a]=P((function(){return e[n]}))}else t[n]=P((function(){return e[n]}))})),t}(t);r.getters=Object.keys(a).map((function(e){return{key:e.endsWith("/")?V(e):e,editable:!1,value:P((function(){return a[e]}))}}))}return r}((r=t._modules,(i=(a=o).split("/").filter((function(e){return e}))).reduce((function(e,t,n){var o=e[t];if(!o)throw new Error('Missing module "'+t+'" for path "'+a+'".');return n===i.length-1?o:o._children}),"root"===a?r:r.root._children)),"root"===o?t.getters:t._makeLocalGettersCache,o)}var r,a,i})),n.on.editInspectorState((function(n){if(n.app===e&&n.inspectorId===C){var o=n.nodeId,r=n.path;"root"!==o&&(r=o.split("/").filter(Boolean).concat(r)),t._withCommit((function(){n.set(t._state.data,r,n.state.value)}))}})),t.subscribe((function(e,t){var o={};e.payload&&(o.payload=e.payload),o.state=t,n.notifyComponentUpdate(),n.sendInspectorTree(C),n.sendInspectorState(C),n.addTimelineEvent({layerId:M,event:{time:Date.now(),title:e.type,data:o}})})),t.subscribeAction({before:function(e,t){var o={};e.payload&&(o.payload=e.payload),e._id=x++,e._time=Date.now(),o.state=t,n.addTimelineEvent({layerId:w,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:o}})},after:function(e,t){var o={},r=Date.now()-e._time;o.duration={_custom:{type:"duration",display:r+"ms",tooltip:"Action duration",value:r}},e.payload&&(o.payload=e.payload),o.state=t,n.addTimelineEvent({layerId:w,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:o}})}})}))}var N=8702998,D={label:"namespaced",textColor:16777215,backgroundColor:6710886};function V(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function O(e,t){return{id:t||"root",label:V(t),tags:e.namespaced?[D]:[],children:Object.keys(e._children).map((function(n){return O(e._children[n],t+n+"/")}))}}function L(e,t,n,o){o.includes(n)&&e.push({id:o||"root",label:o.endsWith("/")?o.slice(0,o.length-1):o||"Root",tags:t.namespaced?[D]:[]}),Object.keys(t._children).forEach((function(r){L(e,t._children[r],n,o+r+"/")}))}function P(e){try{return e()}catch(e){return e}}var H=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"==typeof n?n():n)||{}},U={namespaced:{configurable:!0}};U.namespaced.get=function(){return!!this._rawModule.namespaced},H.prototype.addChild=function(e,t){this._children[e]=t},H.prototype.removeChild=function(e){delete this._children[e]},H.prototype.getChild=function(e){return this._children[e]},H.prototype.hasChild=function(e){return e in this._children},H.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},H.prototype.forEachChild=function(e){S(this._children,e)},H.prototype.forEachGetter=function(e){this._rawModule.getters&&S(this._rawModule.getters,e)},H.prototype.forEachAction=function(e){this._rawModule.actions&&S(this._rawModule.actions,e)},H.prototype.forEachMutation=function(e){this._rawModule.mutations&&S(this._rawModule.mutations,e)},Object.defineProperties(H.prototype,U);var q=function(e){this.register([],e,!1)};function Y(e,t,n){if(t.update(n),n.modules)for(var o in n.modules){if(!t.getChild(o))return;Y(e.concat(o),t.getChild(o),n.modules[o])}}q.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},q.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return e+((t=t.getChild(n)).namespaced?n+"/":"")}),"")},q.prototype.update=function(e){Y([],this.root,e)},q.prototype.register=function(e,t,n){var o=this;void 0===n&&(n=!0);var r=new H(t,n);0===e.length?this.root=r:this.get(e.slice(0,-1)).addChild(e[e.length-1],r);t.modules&&S(t.modules,(function(t,r){o.register(e.concat(r),t,n)}))},q.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],o=t.getChild(n);o&&o.runtime&&t.removeChild(n)},q.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var X=function(e){var t=this;void 0===e&&(e={});var n=e.plugins;void 0===n&&(n=[]);var o=e.strict;void 0===o&&(o=!1);var r=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new q(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._devtools=r;var a=this,i=this.dispatch,l=this.commit;this.dispatch=function(e,t){return i.call(a,e,t)},this.commit=function(e,t,n){return l.call(a,e,t,n)},this.strict=o;var s=this._modules.root.state;B(this,s,[],this._modules.root),T(this,s),n.forEach((function(e){return e(t)}))},j={state:{configurable:!0}};X.prototype.install=function(e,t){e.provide(t||g,this),e.config.globalProperties.$store=this,(void 0!==this._devtools?this._devtools:__VUE_PROD_DEVTOOLS__)&&F(e,this)},j.state.get=function(){return this._state.data},j.state.set=function(e){},X.prototype.commit=function(e,t,n){var o=this,r=R(e,t,n),a=r.type,i=r.payload,l={type:a,payload:i},s=this._mutations[a];s&&(this._withCommit((function(){s.forEach((function(e){e(i)}))})),this._subscribers.slice().forEach((function(e){return e(l,o.state)})))},X.prototype.dispatch=function(e,t){var n=this,o=R(e,t),r=o.type,a=o.payload,i={type:r,payload:a},l=this._actions[r];if(l){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(i,n.state)}))}catch(e){}var s=l.length>1?Promise.all(l.map((function(e){return e(a)}))):l[0](a);return new Promise((function(e,t){s.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(i,n.state)}))}catch(e){}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(i,n.state,e)}))}catch(e){}t(e)}))}))}},X.prototype.subscribe=function(e,t){return k(e,this._subscribers,t)},X.prototype.subscribeAction=function(e,t){return k("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},X.prototype.watch=function(t,n,o){var r=this;return e.watch((function(){return t(r.state,r.getters)}),n,Object.assign({},o))},X.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},X.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),B(this,this.state,e,this._modules.get(e),n.preserveState),T(this,this.state)},X.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){delete I(t.state,e.slice(0,-1))[e[e.length-1]]})),y(this)},X.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},X.prototype.hotUpdate=function(e){this._modules.update(e),y(this,!0)},X.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(X.prototype,j);var G,$={id:null,item:null};!function(e){e.Home="Home",e.List="List",e.Details="Details"}(G||(G={}));var z,K,W=n({keywordQueryModel:null,searchResult:null,offset:0,max:25,pageId:null,blockId:null,freeSearchText:null,activePage:G.Home},$);!function(e){e.SET_ID="SET_ID",e.SET_ITEM="SET_ITEM",e.CHANGE_STATE="CHANGE_STATE"}(K||(K={}));var Q,Z,J=(i(z={},K.SET_ID,(function(e,t){e.id=t})),i(z,K.SET_ITEM,(function(e,t){e.item=t,t&&(e.id=t.id)})),i(z,K.CHANGE_STATE,(function(e,t){console.log(JSON.stringify(e)),console.log(JSON.stringify(t))})),z);!function(e){e.SET_SOURCE="SET_SOURCE",e.SET_KEYWORDS="SET_KEYWORDS",e.SET_RESULTS="SET_RESULTS",e.SET_OFFSET="SET_OFFSET",e.SET_PAGE_SIZE="SET_PAGE_SIZE",e.SET_FREE_TEXT_SEARCH="SET_FREE_TEXT_SEARCH",e.SET_ACTIVE_PAGE="SET_ACTIVE_PAGE",e.TOGGLE_KEYWORD="TOGGLE_KEYWORD",e.CLEAR_KEYWORD_SELECTIONS="CLEAR_KEYWORD_SELECTIONS",e.SELECT_KEYWORD="SELECT_KEYWORD",e.CLEAR_KEYWORD="CLEAR_KEYWORD"}(Z||(Z={}));var ee,te,ne=n(n({},J),{},(i(Q={},Z.SET_SOURCE,(function(e,t){e.pageId=t.pageId,e.blockId=t.blockId})),i(Q,Z.SET_KEYWORDS,(function(e,t){console.log("SET_KEYWORDS Payload: ",t),e.keywordQueryModel=t})),i(Q,Z.SET_RESULTS,(function(e,t){e.searchResult=t,e.offset=t.first-1})),i(Q,Z.SET_OFFSET,(function(e,t){e.offset=t})),i(Q,Z.SET_PAGE_SIZE,(function(e,t){e.max=t})),i(Q,Z.SET_FREE_TEXT_SEARCH,(function(e,t){e.freeSearchText=t})),i(Q,Z.SET_ACTIVE_PAGE,(function(e,t){e.activePage=t})),i(Q,Z.TOGGLE_KEYWORD,(function(e,t){e.keywordQueryModel&&(e.keywordQueryModel.containers[t.containerIndex].fields[t.fieldIndex].selected[t.valueIndex]=!e.keywordQueryModel.containers[t.containerIndex].fields[t.fieldIndex].selected[t.valueIndex])})),i(Q,Z.SELECT_KEYWORD,(function(e,t){e.keywordQueryModel&&(e.keywordQueryModel.containers[t.containerIndex].fields[t.fieldIndex].selected[t.valueIndex]=!0)})),i(Q,Z.CLEAR_KEYWORD,(function(e,t){e.keywordQueryModel&&(e.keywordQueryModel.containers[t.containerIndex].fields[t.fieldIndex].selected[t.valueIndex]=!1)})),i(Q,Z.CLEAR_KEYWORD_SELECTIONS,(function(e){var t;null===(t=e.keywordQueryModel)||void 0===t||t.containers.forEach((function(e){return e.fields.forEach((function(e){return e.selected=new Array(e.values.length).fill(!1)}))}))})),Q));!function(e){e.LOAD_ITEM="LOAD_ITEM",e.CHANGE_STATE="CHANGE_STATE"}(te||(te={}));var oe,re,ae=(i(ee={},te.LOAD_ITEM,(function(e){var t=window.location.origin+"/applets/api/items/".concat(e.state.id);console.log("Item Load API: ",t),fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(K.SET_ITEM,t)}))})),i(ee,te.CHANGE_STATE,(function(e,t){console.log(JSON.stringify(e.state));var n=window.location.origin+"/applets/api/items/deleteItem/".concat(t);console.log("Item Load API: ",n),fetch(n,{method:"post"}).then((function(e){switch(console.log(e.status),e.status){case 200:window.location.href="/";break;case 401:alert("Authorization failed.");break;case 404:alert("Item not found.");break;case 500:alert("Internal server error occurred.");break;default:alert("Unknown error occurred.")}})).catch((function(e){alert("Unknown error occurred."),console.log(e)}))})),ee);!function(e){e.INIT_FILTER="INIT_FILTER",e.FILTER_BY_KEYWORDS="FILTER_BY_KEYWORDS",e.NEXT_PAGE="NEXT_PAGE",e.PREVIOUS_PAGE="PREVIOUS_PAGE",e.FRESH_SEARCH="FRESH_SEARCH",e.SAVE_KEYWORDS="SAVE_KEYWORDS",e.SEARCH_FREE_TEXT="SEARCH_FREE_TEXT",e.SET_SEARCH_TEXT="SET_SEARCH_TEXT",e.LOAD_ITEM="LOAD_ITEM"}(re||(re={}));var ie=n(n({},ae),{},(i(oe={},re.INIT_FILTER,(function(e){var t=window.location.origin+"/applets/api/keywordsearch/keywords/page/".concat(e.state.pageId,"/block/").concat(e.state.blockId);console.log("Keyword Load API: ",t),fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Z.SET_KEYWORDS,t)}))})),i(oe,re.FILTER_BY_KEYWORDS,(function(e){if(e.state.blockId){var t={keywords:e.state.keywordQueryModel,offset:e.state.offset,max:e.state.max};localStorage.setItem(e.getters.searchParamStorageKey,JSON.stringify(t))}var n=window.location.origin+"/applets/api/keywordsearch/items/";console.log("Item Load API: ",n);var o=new FormData;e.state.pageId&&o.append("pageId",e.state.pageId.toString()),e.state.blockId&&o.append("blockId",e.state.blockId.toString()),o.append("offset",e.state.offset.toString()),o.append("max",e.state.max.toString()),o.append("queryParams",JSON.stringify(e.state.keywordQueryModel)),fetch(n,{method:"POST",body:o}).then((function(e){return e.json()})).then((function(t){e.commit(Z.SET_RESULTS,t)})).catch((function(e){console.error("Item Load API Error:",e)}))})),i(oe,re.NEXT_PAGE,(function(e){e.commit(Z.SET_OFFSET,e.state.offset+e.state.max),e.dispatch(re.FILTER_BY_KEYWORDS)})),i(oe,re.PREVIOUS_PAGE,(function(e){var t=Math.max(e.state.offset-e.state.max,0);e.commit(Z.SET_OFFSET,t),e.dispatch(re.FILTER_BY_KEYWORDS)})),i(oe,re.FRESH_SEARCH,(function(e,t){e.commit(Z.SET_OFFSET,0),t&&e.commit(Z.SET_PAGE_SIZE,t),e.dispatch(re.FILTER_BY_KEYWORDS)})),i(oe,re.SAVE_KEYWORDS,(function(e,t){e.commit(Z.SET_KEYWORDS,t)})),i(oe,re.SET_SEARCH_TEXT,(function(e,t){e.commit(Z.SET_FREE_TEXT_SEARCH,t)})),i(oe,re.SEARCH_FREE_TEXT,(function(e){var t,n;console.log("executing search for: "+(null===(t=e.state.freeSearchText)||void 0===t?void 0:t.toString()));var o=window.location.origin+"/api/solr/executefreetext/".concat(null===(n=e.state.freeSearchText)||void 0===n?void 0:n.toString());fetch(o).then((function(e){return e.json()})).then((function(e){console.log("results:"),console.log(e)}))})),oe)),le={searchParamStorageKey:function(e){var t;return(null===(t=e.blockId)||void 0===t?void 0:t.toString())+"SearchParams"},isKeywordSelected:function(e){return function(t,n,o){var r;return null===(r=e.keywordQueryModel)||void 0===r?void 0:r.containers[t].fields[n].selected[o]}},getItem:function(e){return function(t){var n;return console.log("inside getter getitem: "+t),null===(n=e.searchResult)||void 0===n?void 0:n.items.filter((function(e){return e.id===t}))}}},se=e.defineComponent({name:"KeywordFilter",setup:function(){var t=E();return{runFreshSearch:function(){return t.dispatch(re.FRESH_SEARCH)},keywordQueryModel:e.computed((function(){return t.state.keywordQueryModel}))}}}),ce={key:0},ue={key:0,class:"font-weight-bold"},de=["value","onUpdate:modelValue"],me={class:"ml-1"};se.render=function(t,n,o,r,a,i){var l;return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.keywordQueryModel)||void 0===l?void 0:l.containers,(function(o,r){var a,i;return e.openBlock(),e.createElementBlock("div",{key:o},[(null===(a=t.keywordQueryModel)||void 0===a?void 0:a.containers.length)>1&&(null==o||null===(i=o.name)||void 0===i?void 0:i.length)>0?(e.openBlock(),e.createElementBlock("div",ce,e.toDisplayString(o.name),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.fields,(function(o,a){return e.openBlock(),e.createElementBlock("div",{key:o,class:"mb-3"},[o.name.length>0?(e.openBlock(),e.createElementBlock("div",ue,e.toDisplayString(o.name),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.values,(function(o,i){return e.openBlock(),e.createElementBlock("div",{key:o},[e.withDirectives(e.createElementVNode("input",{type:"checkbox",value:o,"onUpdate:modelValue":function(e){return t.keywordQueryModel.containers[r].fields[a].selected[i]=e},onChange:n[0]||(n[0]=function(){return t.runFreshSearch&&t.runFreshSearch.apply(t,arguments)})},null,40,de),[[e.vModelCheckbox,t.keywordQueryModel.containers[r].fields[a].selected[i]]]),e.createElementVNode("label",me,e.toDisplayString(o),1)])})),128))])})),128))])})),128)};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function fe(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var _e=fe((function(e,t){e.exports=function(){var e=1e3,t=6e4,n=36e5,o="millisecond",r="second",a="minute",i="hour",l="day",s="week",c="month",u="quarter",d="year",m="date",f="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},v=function(e,t,n){var o=String(e);return!o||o.length>=t?e:""+Array(t+1-o.length).join(n)+e},b={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),o=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+v(o,2,"0")+":"+v(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var o=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(o,c),a=n-r<0,i=t.clone().add(o+(a?-1:1),c);return+(-(o+(n-r)/(a?r-i:i-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:s,d:l,D:m,h:i,m:a,s:r,ms:o,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},g="en",E={};E[g]=h;var S=function(e){return e instanceof B},k=function(e,t,n){var o;if(!e)return g;if("string"==typeof e)E[e]&&(o=e),t&&(E[e]=t,o=e);else{var r=e.name;E[r]=e,o=r}return!n&&o&&(g=o),o||!n&&g},y=function(e,t){if(S(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new B(n)},T=b;T.l=k,T.i=S,T.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var B=function(){function h(e){this.$L=k(e.locale,null,!0),this.parse(e)}var v=h.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var o=t.match(_);if(o){var r=o[2]-1||0,a=(o[7]||"0").substring(0,3);return n?new Date(Date.UTC(o[1],r,o[3]||1,o[4]||0,o[5]||0,o[6]||0,a)):new Date(o[1],r,o[3]||1,o[4]||0,o[5]||0,o[6]||0,a)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return T},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(e,t){var n=y(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return y(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<y(e)},v.$g=function(e,t,n){return T.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,o=!!T.u(t)||t,u=T.p(e),f=function(e,t){var r=T.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return o?r:r.endOf(l)},_=function(e,t){return T.w(n.toDate()[e].apply(n.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},p=this.$W,h=this.$M,v=this.$D,b="set"+(this.$u?"UTC":"");switch(u){case d:return o?f(1,0):f(31,11);case c:return o?f(1,h):f(0,h+1);case s:var g=this.$locale().weekStart||0,E=(p<g?p+7:p)-g;return f(o?v-E:v+(6-E),h);case l:case m:return _(b+"Hours",0);case i:return _(b+"Minutes",1);case a:return _(b+"Seconds",2);case r:return _(b+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,s=T.p(e),u="set"+(this.$u?"UTC":""),f=(n={},n[l]=u+"Date",n[m]=u+"Date",n[c]=u+"Month",n[d]=u+"FullYear",n[i]=u+"Hours",n[a]=u+"Minutes",n[r]=u+"Seconds",n[o]=u+"Milliseconds",n)[s],_=s===l?this.$D+(t-this.$W):t;if(s===c||s===d){var p=this.clone().set(m,1);p.$d[f](_),p.init(),this.$d=p.set(m,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](_);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[T.p(e)]()},v.add=function(o,u){var m,f=this;o=Number(o);var _=T.p(u),p=function(e){var t=y(f);return T.w(t.date(t.date()+Math.round(e*o)),f)};if(_===c)return this.set(c,this.$M+o);if(_===d)return this.set(d,this.$y+o);if(_===l)return p(1);if(_===s)return p(7);var h=(m={},m[a]=t,m[i]=n,m[r]=e,m)[_]||1,v=this.$d.getTime()+o*h;return T.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var o=e||"YYYY-MM-DDTHH:mm:ssZ",r=T.z(this),a=this.$H,i=this.$m,l=this.$M,s=n.weekdays,c=n.months,u=function(e,n,r,a){return e&&(e[n]||e(t,o))||r[n].substr(0,a)},d=function(e){return T.s(a%12||12,e,"0")},m=n.meridiem||function(e,t,n){var o=e<12?"AM":"PM";return n?o.toLowerCase():o},_={YY:String(this.$y).slice(-2),YYYY:this.$y,M:l+1,MM:T.s(l+1,2,"0"),MMM:u(n.monthsShort,l,c,3),MMMM:u(c,l),D:this.$D,DD:T.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,s,2),ddd:u(n.weekdaysShort,this.$W,s,3),dddd:s[this.$W],H:String(a),HH:T.s(a,2,"0"),h:d(1),hh:d(2),a:m(a,i,!0),A:m(a,i,!1),m:String(i),mm:T.s(i,2,"0"),s:String(this.$s),ss:T.s(this.$s,2,"0"),SSS:T.s(this.$ms,3,"0"),Z:r};return o.replace(p,(function(e,t){return t||_[e]||r.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(o,m,f){var _,p=T.p(m),h=y(o),v=(h.utcOffset()-this.utcOffset())*t,b=this-h,g=T.m(this,h);return g=(_={},_[d]=g/12,_[c]=g,_[u]=g/3,_[s]=(b-v)/6048e5,_[l]=(b-v)/864e5,_[i]=b/n,_[a]=b/t,_[r]=b/e,_)[p]||b,f?g:T.a(g)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return E[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),o=k(e,t,!0);return o&&(n.$L=o),n},v.clone=function(){return T.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},h}(),A=B.prototype;return y.prototype=A,[["$ms",o],["$s",r],["$m",a],["$H",i],["$W",l],["$M",c],["$y",d],["$D",m]].forEach((function(e){A[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),y.extend=function(e,t){return e.$i||(e(t,B,y),e.$i=!0),y},y.locale=k,y.isDayjs=S,y.unix=function(e){return y(1e3*e)},y.en=E[g],y.Ls=E,y.p={},y}()})),pe=_e,he=e.defineComponent({name:"ItemList",props:{},setup:function(){var t=E(),n=e.ref(25);return{items:e.computed((function(){var e;return null===(e=t.state.searchResult)||void 0===e?void 0:e.items})),freshSearch:function(e){return t.dispatch(re.FRESH_SEARCH,e)},nextPage:function(){return t.dispatch(re.NEXT_PAGE)},previousPage:function(){return t.dispatch(re.PREVIOUS_PAGE)},selectedPageSize:n,count:e.computed((function(){var e;return null===(e=t.state.searchResult)||void 0===e?void 0:e.count})),first:e.computed((function(){var e;return null===(e=t.state.searchResult)||void 0===e?void 0:e.first})),last:e.computed((function(){var e;return null===(e=t.state.searchResult)||void 0===e?void 0:e.last}))}},methods:{formatDate:function(e){return pe(e).format("MMM DD, YYYY")}}}),ve={class:"itemList"},be={key:0},ge={key:0},Ee={key:1},Se=[e.createElementVNode("option",null,"25",-1),e.createElementVNode("option",null,"50",-1),e.createElementVNode("option",null,"100",-1)],ke={key:1},ye={class:"item"},Te={class:"item-title"},Be=["href"],Ae={key:1},Ie={class:"item-date"},Re={class:"item-subtitle"},Me={class:"categories"},we={class:"badge rounded-pill bg-dark text-white m-1"},Ce={class:"content"};he.render=function(t,n,o,r,a,i){var l;return e.openBlock(),e.createElementBlock("div",ve,[(null===(l=t.items)||void 0===l?void 0:l.length)>0?(e.openBlock(),e.createElementBlock("div",be,[t.first>1?(e.openBlock(),e.createElementBlock("span",ge,[e.createElementVNode("i",{class:"fas fa-angle-double-left",onClick:n[0]||(n[0]=function(){return t.previousPage&&t.previousPage.apply(t,arguments)})})])):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(t.first)+"-"+e.toDisplayString(t.last)+" of "+e.toDisplayString(t.count)+" ",1),t.count>t.last?(e.openBlock(),e.createElementBlock("span",Ee,[e.createElementVNode("i",{class:"fas fa-angle-double-right",onClick:n[1]||(n[1]=function(){return t.nextPage&&t.nextPage.apply(t,arguments)})})])):e.createCommentVNode("",!0),e.createElementVNode("span",null,[e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":n[2]||(n[2]=function(e){return t.selectedPageSize=e}),class:"pull-right",onChange:n[3]||(n[3]=function(e){return t.freshSearch(Number(t.selectedPageSize))})},Se,544),[[e.vModelSelect,t.selectedPageSize]])])])):(e.openBlock(),e.createElementBlock("div",ke,"No results found.")),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.items,(function(n){var o;return e.openBlock(),e.createElementBlock("div",{key:n.id},[e.createElementVNode("div",ye,[e.createElementVNode("h3",Te,[(null===(o=n.detailedViewUrl)||void 0===o?void 0:o.length)>0?(e.openBlock(),e.createElementBlock("a",{key:0,href:n.detailedViewUrl},e.toDisplayString(n.title),9,Be)):(e.openBlock(),e.createElementBlock("span",Ae,e.toDisplayString(n.title),1))]),e.createElementVNode("div",Ie,e.toDisplayString(t.formatDate(n.date)),1),e.createElementVNode("h5",Re,e.toDisplayString(n.subtitle),1),e.createElementVNode("div",Me,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.categories,(function(t){return e.openBlock(),e.createElementBlock("span",we,e.toDisplayString(t),1)})),256))]),e.createElementVNode("div",Ce,e.toDisplayString(n.content),1)])])})),128))])};var xe=e.defineComponent({name:"ListView",components:{KeywordFilter:se,ItemList:he}}),Fe={class:"col-md-4 text-left"},Ne={class:"col-md-8"};xe.render=function(t,n,o,r,a,i){var l=e.resolveComponent("KeywordFilter"),s=e.resolveComponent("ItemList");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Fe,[e.createVNode(l)]),e.createElementVNode("div",Ne,[e.createVNode(s)])],64)};var De=e.defineComponent({name:"FreeTextSearch",components:{},props:{},setup:function(){var t=E();return{store:t,freeTextSearch:e.computed((function(){return t.state.freeSearchText}))}},storeConfig:{state:W,actions:ie,mutations:ne,getters:le},methods:{onBlur:function(e){e.target.value.length>0&&this.store.dispatch(re.SET_SEARCH_TEXT,e.target.value)},executeSearch:function(){console.log("executing search ...."),this.store.dispatch(re.SEARCH_FREE_TEXT)}}}),Ve={class:"input-group dir-text-search"};De.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",Ve,[e.createElementVNode("input",{type:"text",class:"form-control rounded",placeholder:"searchText","aria-label":"Search","aria-describedby":"search-addon",onBlur:n[0]||(n[0]=function(e){return t.onBlur(e)})},null,32),e.createElementVNode("button",{type:"button",class:"btn btn-outline-primary",onClick:n[1]||(n[1]=function(){return t.executeSearch&&t.executeSearch.apply(t,arguments)})},"search")])};var Oe=e.defineComponent({name:"KeywordPanel",props:n({hexColorList:{type:null,required:!1},runAction:{type:null,required:!1},className:{type:null,required:!1}},c),setup:function(t){var n=E();return e.onMounted((function(){var e=Array.from(document.getElementsByClassName("dir-keyword-button")),n=t.hexColorList?t.hexColorList.length:0,o=0;e.forEach((function(e){if(null!==t.hexColorList){var r=t.hexColorList?t.hexColorList[o]:"";e.setAttribute("style","background-color: "+r),o=++o<=n-1?o:0}else{var a="hsla("+~~(360*Math.random())+",70%,80%,1)";e.setAttribute("style","background-color: "+a)}}))})),{filterByKeyword:function(e,t,o){n.commit(Z.CLEAR_KEYWORD_SELECTIONS),n.commit(Z.SELECT_KEYWORD,{containerIndex:e,fieldIndex:t,valueIndex:o}),n.commit(Z.SET_ACTIVE_PAGE,G.List)},keywordQueryModel:e.computed((function(){return n.state.keywordQueryModel})),addKeyword:function(e,t,o){n.getters.isKeywordSelected(e,t,o)||(n.commit(Z.SELECT_KEYWORD,{containerIndex:e,fieldIndex:t,valueIndex:o}),n.dispatch(re.FRESH_SEARCH))},className:t.className}}}),Le=["onClick"],Pe=["onClick"];function He(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}He("\n.keywordContainer[data-v-92d1c55a] {\r\n        overflow-x: scroll;\r\n        overflow-y: visible;\r\n        white-space: nowrap;\r\n        position: relative;\r\n        display: inline-block;\r\n        height: 150px;\r\n        width: 100%;\r\n        scroll-behavior: smooth;\r\n        align-content: center;\n}\n.dir-keyword[data-v-92d1c55a] {\r\n        display: inline-block;\r\n        margin-top: 15px;\r\n        margin-right: 5px;\n}\n.dir-keyword-button[data-v-92d1c55a] {\r\n        position: relative;\r\n        color: Black;\r\n        font-size: 0.80em;\r\n        text-align: center;\r\n        border-radius: 60px;\r\n        padding-top: 30px;\r\n        padding-bottom: 30px;\r\n        padding-left: 10px;\r\n        padding-right: 10px;\r\n        max-width: 150px;\r\n        white-space: normal;\n}\n.dir-keyword-button[data-v-92d1c55a]:focus {\r\n            background-color: yellow;\n}\n.dir-keyword-button[data-v-92d1c55a]:hover {\r\n            transform: scale(1.2);\r\n            z-index: 100;\r\n            opacity: 90%;\r\n            text-decoration: underline;\n}\r\n\r\n\r\n    /* Works on Chrome, Edge, and Safari */\n.keywordContainer[data-v-92d1c55a]::-webkit-scrollbar, .keywordContainerSmall[data-v-92d1c55a]::-webkit-scrollbar {\r\n        width: 12px;\r\n        height: 5px;\r\n        overflow-x: scroll;\r\n        background-color: transparent;\n}\n.keywordContainer[data-v-92d1c55a]::-webkit-scrollbar-track, .keywordContainerSmall[data-v-92d1c55a]::-webkit-scrollbar-track {\r\n        background-color: transparent;\r\n        -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.05);\n}\n.keywordContainer[data-v-92d1c55a]::-webkit-scrollbar-thumb, .keywordContainerSmall[data-v-92d1c55a]::-webkit-scrollbar-thumb {\r\n        background-color: grey;\r\n        border-radius: 10px;\r\n        /* border: 1px solid Green;*/\n}\n.keywordContainer[data-v-92d1c55a]::-webkit-scrollbar-track-piece:end, .keywordContainerSmall[data-v-92d1c55a]::-webkit-scrollbar-track-piece:end {\r\n        margin-right: 75px;\n}\n.keywordContainer[data-v-92d1c55a]::-webkit-scrollbar-track-piece:start, .keywordContainerSmall[data-v-92d1c55a]::-webkit-scrollbar-track-piece:start {\r\n        margin-left: 175px;\n}\r\n\r\n    /* smaller version*/\n.keywordContainerSmall[data-v-92d1c55a] {\r\n        overflow-x: scroll;\r\n        overflow-y: visible;\r\n        white-space: nowrap;\r\n        position: relative;\r\n        display: inline-block;\r\n        height: 90px;\r\n        width: 100%;\r\n        scroll-behavior: smooth;\r\n        align-content: center;\n}\n.keywordContainerSmall > .dir-keyword[data-v-92d1c55a] {\r\n            display: inline-block;\r\n            margin-top: 15px;\r\n            margin-right: 5px;\r\n            font-size: medium;\n}\n.keywordContainerSmall > .dir-keyword > .dir-keyword-button[data-v-92d1c55a] {\r\n                position: relative;\r\n                color: Black;\r\n                font-size: 0.80em;\r\n                text-align: center;\r\n                border-radius: 60px;\r\n                padding-top: 15px;\r\n                padding-bottom: 15px;\r\n                padding-left: 10px;\r\n                padding-right: 10px;\r\n                max-width: 150px;\r\n                white-space: normal;\n}\r\n"),Oe.render=function(t,n,o,r,a,i){var l;return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.keywordQueryModel)||void 0===l?void 0:l.containers,(function(n,o){return e.openBlock(),e.createElementBlock("div",{key:n},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.fields,(function(n,r){return e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(t.className?"row "+t.className:"row keywordContainer")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.values,(function(n,a){return e.openBlock(),e.createElementBlock("span",{key:n,class:"dir-keyword"},["filterByKeyword"===t.runAction?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:function(e){return t.filterByKeyword(o,r,a)},class:"dir-keyword-button",ref:"dirBtn"},e.toDisplayString(n),9,Le)):(e.openBlock(),e.createElementBlock("button",{key:1,onClick:function(e){return t.addKeyword(o,r,a)},class:"dir-keyword-button",ref:"dirBtn"},e.toDisplayString(n),9,Pe))])})),128))],2)})),128))])})),128)},Oe.__scopeId="data-v-92d1c55a";var Ue=e.defineComponent({name:"HomeView",props:n({colorScheme:{type:null,required:!1}},c),components:{KeywordPanel:Oe,FreeTextSearch:De},setup:function(t){var n=E(),o=t.dataAttributes,r=o["block-title"],a=o["block-description"],i=o["enable-freetext-search"],l=o["hex-color-list"],s=l?l.split(",").map((function(e){return e.trim()})):null;return{filterByKeyword:function(e,t,o){n.commit(Z.CLEAR_KEYWORD_SELECTIONS),n.commit(Z.SELECT_KEYWORD,{containerIndex:e,fieldIndex:t,valueIndex:o}),n.commit(Z.SET_ACTIVE_PAGE,G.List)},keywordQueryModel:e.computed((function(){return n.state.keywordQueryModel})),hexColorList:s,blogTitle:r,blogDescription:a,enableFreeTextSearch:i}}}),qe={class:"dir-title"},Ye={class:"dir-description"},Xe={key:0};Ue.render=function(t,n,o,r,a,i){var l=e.resolveComponent("FreeTextSearch"),s=e.resolveComponent("KeywordPanel");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("h1",qe,e.toDisplayString(t.blogTitle),1),e.createElementVNode("div",Ye,e.toDisplayString(t.blogDescription),1),!0===t.enableFreeTextSearch?(e.openBlock(),e.createElementBlock("div",Xe,[e.createVNode(l)])):e.createCommentVNode("",!0),e.createVNode(s,{hexColorList:t.hexColorList,runAction:"filterByKeyword"},null,8,["hexColorList"])],64)};var je=e.defineComponent({name:"ListView",props:n({colorScheme:{type:null,required:!1}},c),components:{KeywordPanel:Oe,FreeTextSearch:De},setup:function(t){var n=E(),o=t.dataAttributes,r=o["enable-freetext-search"],a=o["hex-color-list"],i=a?a.split(",").map((function(e){return e.trim()})):null;return e.onMounted((function(){n.dispatch(re.FRESH_SEARCH)})),{hexColorList:i,enableFreeTextSearch:r,removeKeyword:function(e){n.commit(Z.CLEAR_KEYWORD,e),n.dispatch(re.FRESH_SEARCH)},viewDetails:function(e){n.commit(K.SET_ID,e),n.commit(Z.SET_ACTIVE_PAGE,G.Details)},keywordQueryModel:e.computed((function(){return n.state.keywordQueryModel})),items:e.computed((function(){var e;return null===(e=n.state.searchResult)||void 0===e?void 0:e.items})),results:e.computed((function(){return n.state.searchResult})),selectedKeywords:e.computed((function(){var e,t=[];return null===(e=n.state.keywordQueryModel)||void 0===e||e.containers.forEach((function(e,o){return e.fields.forEach((function(e,r){return e.values.forEach((function(e,a){n.getters.isKeywordSelected(o,r,a)&&t.push({index:{containerIndex:o,fieldIndex:r,valueIndex:a},value:e})}))}))})),t}))}}}),Ge=function(t){return e.pushScopeId("data-v-766506bb"),t=t(),e.popScopeId(),t},$e={class:"row"},ze={class:"col-md-8 row"},Ke={class:"col-md-3"},We={class:"selectedKeyword"},Qe=["onClick"],Ze={class:"col-md-8 grey-BG contentList"},Je=Ge((function(){return e.createElementVNode("b",null,"Entries",-1)})),et={class:"item row"},tt=Ge((function(){return e.createElementVNode("div",null,[e.createElementVNode("i",{class:"fas fa-image profileImg"})],-1)})),nt={class:"profileInfo"},ot={class:"item-title"},rt=["onClick"],at={class:"content"},it={class:"col-md-4"},lt={key:0};He("\n.searchbar[data-v-766506bb] {\r\n        background-color: #ececec;\r\n        cursor: pointer;\r\n        height: 40px;\r\n        position: relative;\r\n        width: 400px;\r\n        display: inline-block;\r\n        margin-top: 15px;\r\n        padding: 12.5px\n}\n.profileInfo[data-v-766506bb] {\r\n        margin-left: 10px;\r\n        display: inline-block;\r\n        margin-top: 22px;\r\n        max-width:275px;\r\n        font-size:large;\n}\n.profileImg[data-v-766506bb] {\r\n        font-size: 1000%;\r\n        margin-left: 5px;\n}\n.grey-BG[data-v-766506bb] {\r\n        background-color: #ececec;\r\n        border-radius: 30px;\r\n        height: 500px;\r\n        position: relative;\r\n        width: 600px;\r\n        width: 700px;\r\n        margin-left: 20px;\r\n        margin-top: 10px;\r\n        margin-bottom: 20px;\r\n        display: inline-block;\r\n        overflow-y: scroll;\n}\n.fa-times[data-v-766506bb] {\r\n        margin-left: 5px;\r\n        font-size: medium;\n}\n.selectedKeyword[data-v-766506bb] {\r\n        background-color: #ffdc0e;\r\n        border-radius: 50px;\r\n        position: relative;\r\n        margin: 5px;\r\n        padding: 5px;\r\n        overflow-wrap: break-word;\r\n        display: inline-block;\r\n        font-size: medium;\n}\n.contentList[data-v-766506bb]::-webkit-scrollbar {\r\n        width: 7px;\r\n        height: 5px;\r\n        overflow-y: scroll;\r\n        background-color: transparent;\n}\n.contentList[data-v-766506bb]::-webkit-scrollbar-track {\r\n        background-color: transparent;\r\n        -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.02);\n}\n.contentList[data-v-766506bb]::-webkit-scrollbar-thumb {\r\n        background-color: grey;\r\n        border-radius: 10px;\r\n        /* border: 1px solid Green;*/\n}\n.contentList[data-v-766506bb]::-webkit-scrollbar-track-piece:end {\r\n        margin-bottom: 75px;\n}\n.contentList[data-v-766506bb]::-webkit-scrollbar-track-piece:start {\r\n        margin-top: 175px;\n}\r\n"),je.render=function(t,n,o,r,a,i){var l=e.resolveComponent("FreeTextSearch"),s=e.resolveComponent("KeywordPanel");return e.openBlock(),e.createElementBlock("div",$e,[e.createElementVNode("div",ze,[e.createElementVNode("div",Ke,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.selectedKeywords,(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.index.containerIndex+"_"+n.index.valueIndex},[e.createElementVNode("span",We,e.toDisplayString(n.value),1),e.createElementVNode("i",{class:"fa fa-remove",onClick:function(e){return t.removeKeyword(n.index)}},null,8,Qe)])})),128))]),e.createElementVNode("div",Ze,[Je,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.items,(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id},[e.createElementVNode("div",et,[tt,e.createElementVNode("div",nt,[e.createElementVNode("h5",ot,[e.createElementVNode("a",{href:"#",onClick:function(e){return t.viewDetails(n.id)}},e.toDisplayString(n.subtitle),9,rt)]),e.createElementVNode("div",at,e.toDisplayString(n.content),1)])])])})),128))])]),e.createElementVNode("div",it,[!0===t.enableFreeTextSearch?(e.openBlock(),e.createElementBlock("div",lt,[e.createVNode(l)])):e.createCommentVNode("",!0),e.createVNode(s,{hexColorList:t.hexColorList,className:"keywordContainerSmall"},null,8,["hexColorList"])])])},je.__scopeId="data-v-766506bb";var st=e.defineComponent({name:"DetailsView",props:c,components:{FreeTextSearch:De},setup:function(t){var n,o=E(),r=t.queryParameters;r&&(null===(n=r.iid)||void 0===n?void 0:n.length)>0&&o.commit(K.SET_ID,r.iid);var a=e.computed((function(){return o.state.id})),i=e.computed((function(){var e;return null===(e=o.state.searchResult)||void 0===e?void 0:e.items})),l=t.dataAttributes["enable-freetext-search"],s=e.computed((function(){return o.getters.getItem(a)}));return console.log("details view selected Item: "+JSON.stringify(s)),e.onMounted((function(){a&&o.dispatch(te.LOAD_ITEM,a)})),{itemId:a,items:i,item:e.computed((function(){return o.getters.getItem(a)})),enableFreeTextSearch:l,backToSearchResults:function(){o.commit(Z.SET_ACTIVE_PAGE,G.List)}}},methods:{}}),ct=function(t){return e.pushScopeId("data-v-8afc24e0"),t=t(),e.popScopeId(),t},ut=ct((function(){return e.createElementVNode("h2",null,"Details View",-1)})),dt={class:"row"},mt={key:0,class:"row"},ft={class:"col-md-6 grey-BG"},_t={class:"row"},pt=ct((function(){return e.createElementVNode("i",{class:"fas fa-image profileHeadshot"},null,-1)})),ht={class:"profileInfo"},vt={class:"item-title"},bt=["onClick"],gt={class:"content profileDetails"},Et=ct((function(){return e.createElementVNode("button",{class:"contactMeBtn btn btn-link marginTop"},"Contact Me!",-1)})),St={class:"col-md-5"},kt={key:0,class:"marginTop"},yt={class:"explore-related"},Tt=ct((function(){return e.createElementVNode("div",{class:"related-title"},"Explore related researchers",-1)})),Bt={class:"related-scroll"},At=ct((function(){return e.createElementVNode("i",{class:"fas fa-image related-image"},null,-1)})),It={class:"related-results"};He("\n.marginTop[data-v-8afc24e0]{\r\n        margin-top:30px;\n}\n.fa-image[data-v-8afc24e0] {\r\n        font-size: 500%;\n}\n.explore-related[data-v-8afc24e0] {\r\n        display: inline-block;\r\n        position: relative;\r\n        margin: 20px;\r\n        vertical-align: top;\n}\n.related-title[data-v-8afc24e0] {\r\n        background-color: #ececec;\r\n        font-weight: 700;\r\n        text-decoration: underline;\r\n        position: relative;\r\n        width: 230px;\r\n        padding: 15px;\r\n        margin-left: 30px;\r\n        border-radius: 20px 20px 0px 0px;\r\n        font-size: large;\n}\n.related-scroll[data-v-8afc24e0] {\r\n        background-color: #ececec;\r\n        border-radius: 30px;\r\n        padding: 20px;\r\n        width: 450px;\r\n        height: 150px;\r\n        overflow-x: scroll;\r\n        overflow-y: hidden;\r\n        white-space: nowrap;\r\n        display: inline-block;\n}\n.related[data-v-8afc24e0] {\r\n        display: inline-block;\n}\n.related-image[data-v-8afc24e0] {\r\n        position: relative;\r\n        display: inline-block;\r\n        float: left;\r\n        width: 100px;\n}\n.related-results[data-v-8afc24e0] {\r\n        display: inline-block;\r\n        position: relative;\r\n        margin: 20px;\r\n        margin-top: 10px;\n}\n.contactMeBtn[data-v-8afc24e0] {\r\n        float: right;\r\n        background: White;\r\n        border-radius: 50px;\r\n        position: relative;\r\n        display: inline-block;\r\n        padding: 7.5px;\r\n        font-size: large;\n}\n.backToSearchResultsBtn[data-v-8afc24e0] {\r\n        background: #ececec;\r\n        border-radius: 50px;\r\n        position: relative;\r\n        display: inline-block;\r\n        padding: 12.5px\n}\n.grey-BG[data-v-8afc24e0] {\r\n        background-color: #ececec;\r\n        border-radius: 30px;\r\n        height: 500px;\r\n        position: relative;\r\n        width: 600px;\r\n        width: 700px;\r\n        margin-left: 20px;\r\n        margin-top: 10px;\r\n        margin-bottom: 20px;\r\n        display: inline-block;\r\n        overflow-y: hidden;\n}\n.profileInfo[data-v-8afc24e0] {\r\n        margin-left: 10px;\r\n        display: inline-block;\r\n        margin-top: 22px;\r\n        max-width: 275px;\r\n        font-size: large;\n}\n.profileHeadshot[data-v-8afc24e0] {\r\n        font-size: 500%;\r\n        margin: 10px;\n}\r\n\r\n    /* Works on Chrome, Edge, and Safari */\n.related-scroll[data-v-8afc24e0]::-webkit-scrollbar {\r\n        width: 12px;\r\n        height: 5px;\r\n        overflow-x: scroll;\r\n        background-color: transparent;\n}\n.related-scroll[data-v-8afc24e0]::-webkit-scrollbar-track {\r\n        background-color: transparent;\r\n        -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.02);\n}\n.related-scroll[data-v-8afc24e0]::-webkit-scrollbar-thumb {\r\n        background-color: grey;\r\n        border-radius: 10px;\r\n        /* border: 1px solid Green;*/\n}\n.related-scroll[data-v-8afc24e0]::-webkit-scrollbar-track-piece:end {\r\n        margin-right: 75px;\n}\n.keywordContainer[data-v-8afc24e0]::-webkit-scrollbar-track-piece:start {\r\n        margin-left: 175px;\n}\r\n"),st.render=function(t,n,o,r,a,i){var l=e.resolveComponent("FreeTextSearch");return e.openBlock(),e.createElementBlock(e.Fragment,null,[ut,e.createElementVNode("div",dt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.items,(function(o){return e.openBlock(),e.createElementBlock("div",{key:o.id},[o.id===t.itemId?(e.openBlock(),e.createElementBlock("div",mt,[e.createElementVNode("div",ft,[e.createElementVNode("div",_t,[pt,e.createElementVNode("div",ht,[e.createElementVNode("h5",vt,[e.createElementVNode("a",{href:"#",onClick:function(e){return t.viewDetails(o.id)}},e.toDisplayString(o.subtitle),9,bt)])])]),e.createElementVNode("div",gt,e.toDisplayString(o.content),1),Et]),e.createElementVNode("div",St,[e.createElementVNode("button",{class:"backToSearchResultsBtn",onClick:n[0]||(n[0]=function(){return t.backToSearchResults&&t.backToSearchResults.apply(t,arguments)})},"Back to search results"),!0===t.enableFreeTextSearch?(e.openBlock(),e.createElementBlock("div",kt,[e.createVNode(l)])):e.createCommentVNode("",!0),e.createElementVNode("div",yt,[Tt,e.createElementVNode("div",Bt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.items,(function(t){return e.openBlock(),e.createElementBlock("div",{key:t.id,class:"related"},[At,e.createElementVNode("div",It,e.toDisplayString(t.subtitle),1)])})),128))])])])])):e.createCommentVNode("",!0)])})),128))])],64)},st.__scopeId="data-v-8afc24e0";var Rt=e.defineComponent({name:"Popups",components:{},props:{title:{type:null,required:!1,default:"Click me"},popup:{type:null,required:!1}},setup:function(t){var n=e.ref(t.popup);return console.log("inside popup: "+JSON.stringify(t.popup)),{ispopup:n}},methods:{closePopup:function(){this.ispopup=!1}}}),Mt={key:0,class:"popup"},wt={class:"popup-inner"};He("\n.popup[data-v-7d1170c8] {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        z-index: 99;\r\n        background-color: rgba(0, 0, 0, 0.2);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\n}\n.popup-inner[data-v-7d1170c8] {\r\n        background: #FFF;\r\n        padding: 32px;\r\n        width:50%;\n}\r\n"),Rt.render=function(t,n,o,r,a,i){return t.ispopup?(e.openBlock(),e.createElementBlock("div",Mt,[e.createElementVNode("div",wt,[e.createElementVNode("button",{class:"popup-close",onClick:n[0]||(n[0]=function(e){return t.closePopup()})}," Close Popup "),e.renderSlot(t.$slots,"default")])])):e.createCommentVNode("",!0)},Rt.__scopeId="data-v-7d1170c8";var Ct=e.defineComponent({name:"DirectoryView",components:{HomeView:Ue,ListView:je,DetailsView:st,Popups:Rt},props:n({colorScheme:{type:null,required:!1}},c),setup:function(t){var n=E(),o=t.queryParameters;if(null!=o&&o.page){var r=null==o?void 0:o.page;n.commit(Z.SET_ACTIVE_PAGE,r)}var a=e.ref(!1);return{ePage:G,visit:function(e){return n.commit(Z.SET_ACTIVE_PAGE,e)},page:e.computed((function(){return n.state.activePage})),popupTrigger:a,title:"<h1>Title</h1><hr/>"}},methods:{TooglePopup:function(){this.popupTrigger=!this.popupTrigger,console.log(this.popupTrigger)}}}),xt=["innerHTML"],Ft=e.createTextVNode(" Intersections of Gender is committed to using intersectional experience and excellence to build and sustain for the public good and to bring together wide-ranging initiatives to advance knowledge and inspire engaged citizenship around the world. Learn more about IG "),Nt=e.createTextVNode(" | ");He("\n.keywordContainer[data-v-3e829bbb] {\r\n        overflow-x: scroll;\r\n        overflow-y: visible;\r\n        white-space: nowrap;\r\n        position: relative;\r\n        display: inline-block;\r\n        height: 150px;\r\n        width: 100%;\r\n        scroll-behavior: smooth;\r\n        align-content:center;\n}\n.dir-keyword[data-v-3e829bbb] {\r\n        display: inline-block;\r\n        margin-top: 15px;\r\n        margin-right: 5px;\n}\n.dir-keyword-button[data-v-3e829bbb] {\r\n        position: relative;\r\n        color: Black;\r\n        font-size: 0.80em;\r\n        text-align: center;\r\n        border-radius: 60px;\r\n        padding-top: 30px;\r\n        padding-bottom: 30px;\r\n        padding-left: 10px;\r\n        padding-right: 10px;\r\n        max-width: 150px;\r\n        white-space: normal;\n}\n.dir-keyword-button[data-v-3e829bbb]:focus {\r\n        background-color: yellow;\n}\n.dir-keyword-button[data-v-3e829bbb]:hover {\r\n       transform: scale(1.2);\r\n       z-index:100;\r\n       opacity:90%;\r\n       text-decoration:underline;\n}\r\n   \r\n   \r\n        /* Works on Chrome, Edge, and Safari */\n.keywordContainer[data-v-3e829bbb]::-webkit-scrollbar {\r\n        width: 12px;\r\n        height: 5px;\r\n        overflow-x: scroll;\r\n        background-color: transparent;\n}\n.keywordContainer[data-v-3e829bbb]::-webkit-scrollbar-track {\r\n        background-color: transparent;\r\n        -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.05);\n}\n.keywordContainer[data-v-3e829bbb]::-webkit-scrollbar-thumb {\r\n        background-color: grey;\r\n        border-radius: 10px;\r\n        /* border: 1px solid Green;*/\n}\n.keywordContainer[data-v-3e829bbb]::-webkit-scrollbar-track-piece:end {\r\n        margin-right: 75px;\n}\n.keywordContainer[data-v-3e829bbb]::-webkit-scrollbar-track-piece:start {\r\n        margin-left: 175px;\n}\r\n"),Ct.render=function(t,n,o,r,a,i){var l=e.resolveComponent("Popups"),s=e.resolveComponent("HomeView"),c=e.resolveComponent("ListView"),u=e.resolveComponent("DetailsView");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{onClick:n[0]||(n[0]=function(e){return t.TooglePopup()})},"info"),t.popupTrigger?(e.openBlock(),e.createBlock(l,{key:0,popup:t.popupTrigger},{default:e.withCtx((function(){return[e.createElementVNode("div",null,[e.createElementVNode("div",{innerHTML:t.title},null,8,xt),Ft])]})),_:1},8,["popup"])):e.createCommentVNode("",!0),e.createElementVNode("nav",null,[e.createElementVNode("a",{href:"#",onClick:n[1]||(n[1]=function(e){return t.visit(t.ePage.Home)})},"Home"),Nt,e.createElementVNode("a",{href:"#",onClick:n[2]||(n[2]=function(e){return t.visit(t.ePage.List)})},"Explore")]),t.page==t.ePage.Home?(e.openBlock(),e.createBlock(s,{key:1,"data-attributes":t.dataAttributes,"query-parameters":t.queryParameters},null,8,["data-attributes","query-parameters"])):e.createCommentVNode("",!0),t.page==t.ePage.List?(e.openBlock(),e.createBlock(c,{key:2,"data-attributes":t.dataAttributes,"query-parameters":t.queryParameters},null,8,["data-attributes","query-parameters"])):e.createCommentVNode("",!0),t.page==t.ePage.Details?(e.openBlock(),e.createBlock(u,{key:3,"data-attributes":t.dataAttributes,"query-parameters":t.queryParameters},null,8,["data-attributes","query-parameters"])):e.createCommentVNode("",!0)],64)},Ct.__scopeId="data-v-3e829bbb";var Dt=e.defineComponent({name:"Applet",components:{DirectoryView:Ct,ListView:xe,FreeTextSearch:De},props:c,setup:function(t){console.log("Keyword Search setup ...",t);var n=t.dataAttributes,o=n["display-format"],r=n["block-title"],a=n["block-description"],i=n["enable-freetext-search"],l=n["hex-color-list"],s=E();s.commit(Z.SET_SOURCE,{pageId:t.pageId,blockId:t.blockId});var c,u=localStorage.getItem(s.getters.searchParamStorageKey);u&&u.length>0&&(c=JSON.parse(u))&&c.keywords?(s.commit(Z.SET_KEYWORDS,c.keywords),s.commit(Z.SET_OFFSET,c.offset),s.commit(Z.SET_PAGE_SIZE,c.max)):s.dispatch(re.INIT_FILTER),e.onMounted((function(){return s.dispatch(re.FILTER_BY_KEYWORDS)}));var d=e.ref(s.state.keywordQueryModel);return{dataAttributes:n,queryParameters:t.queryParameters,keywordQueryModel:d,displayFormat:o,blogTitle:r,blogDescription:a,enableFreeTextSearch:i,hexColors:l}},storeConfig:{state:W,actions:ie,mutations:ne,getters:le}}),Vt=["colorScheme"];Dt.render=function(t,n,o,r,a,i){var l=e.resolveComponent("DirectoryView"),s=e.resolveComponent("ListView");return e.openBlock(),e.createElementBlock(e.Fragment,null,["Directory"===t.displayFormat?(e.openBlock(),e.createBlock(l,{key:0,"data-attributes":t.dataAttributes,"query-parameters":t.queryParameters},null,8,["data-attributes","query-parameters"])):e.createCommentVNode("",!0),"List"===t.displayFormat?(e.openBlock(),e.createElementBlock("div",{key:1,class:"row",colorScheme:t.hexColors},[e.createVNode(s)],8,Vt)):e.createCommentVNode("",!0)],64)};var Ot,Lt;!function(e){e.SET_ID="SET_ID",e.SET_TEMPLATE="SET_TEMPLATE"}(Lt||(Lt={}));var Pt,Ht,Ut=(i(Ot={},Lt.SET_ID,(function(e,t){e.Id=t})),i(Ot,Lt.SET_TEMPLATE,(function(e,t){e.template=t})),Ot);!function(e){e.LOAD_TEMPLATE="LOAD_TEMPLATE",e.SET_ID="SET_ID"}(Ht||(Ht={}));var qt=(i(Pt={},Ht.LOAD_TEMPLATE,(function(e){var t=window.location.origin+"/applets/api/itemtemplates/".concat(e.state.Id);fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Lt.SET_TEMPLATE,t)}))})),i(Pt,Ht.SET_ID,(function(e,t){e.commit(Lt.SET_ID,t)})),Pt),Yt=e.defineComponent({name:"NotificationEditor",props:{fieldContainer:{required:!1,type:null}},setup:function(){}});Yt.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("h4",null,e.toDisplayString(t.fieldContainer.name.concatenatedContent),1),e.createElementVNode("div",null,e.toDisplayString(t.fieldContainer),1)],64)};var Xt=e.defineComponent({name:"FormEditor",props:["form"],setup:function(){}});Xt.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("h4",null,e.toDisplayString(t.form.name.concatenatedContent),1),e.createElementVNode("div",null,e.toDisplayString(t.form),1)],64)};var jt=e.defineComponent({name:"MetadatasetEditor",props:["metadataset"],setup:function(){}});jt.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("h4",null,e.toDisplayString(t.metadataset.name.concatenatedContent),1),e.createElementVNode("div",null,e.toDisplayString(t.metadataset),1)],64)};var Gt=e.defineComponent({name:"ItemTemplate",components:{NotificationEditor:Yt,FormEditor:Xt,MetadatasetEditor:jt},props:{},setup:function(){var t=E(),n=e.ref(null);return{template:e.computed((function(){return t.state.template})),metadataSets:e.computed((function(){var e;return null===(e=t.state.template)||void 0===e?void 0:e.metadataSets})),dataContainer:e.computed((function(){var e;return null===(e=t.state.template)||void 0===e?void 0:e.dataContainer})),activePanel:n}},methods:{formatDate:function(e){return pe(e).format("MMM DD, YYYY")}}}),$t=function(t){return e.pushScopeId("data-v-2579f0c4"),t=t(),e.popScopeId(),t},zt={class:"container row itemTemplate"},Kt={class:"col-md-4"},Wt=[$t((function(){return e.createElementVNode("div",{class:"sectionLabel"},"Overview",-1)}))],Qt=[$t((function(){return e.createElementVNode("div",{class:"sectionLabel"},"Notifications",-1)}))],Zt=["onClick"],Jt=[$t((function(){return e.createElementVNode("div",{class:"sectionLabel"},"Forms",-1)}))],en=["onClick"],tn=[$t((function(){return e.createElementVNode("div",{class:"sectionLabel"},"Metadata Forms",-1)}))],nn=["onClick"],on={class:"col-md-8"},rn={key:0,class:"col-12 wrapper"},an=[$t((function(){return e.createElementVNode("h4",null,"Overview",-1)}))],ln={key:1,class:"col-12 wrapper"},sn=[$t((function(){return e.createElementVNode("h4",null,"Notifications",-1)}))],cn={key:0},un={key:2,class:"col-12 wrapper"},dn=[$t((function(){return e.createElementVNode("h4",null,"Forms",-1)}))],mn={key:0},fn={key:3,class:"col-12 wrapper"},_n=[$t((function(){return e.createElementVNode("h4",null,"Metadata Forms",-1)}))],pn={key:0};He("\n.menuEntry[data-v-2579f0c4]{\r\n        border: 1px solid Grey;\r\n        margin: 10px;\r\n        padding: 10px 10px;\n}\n.menuEntry.active[data-v-2579f0c4] {\r\n            background-color: #BBBCAA;\n}\n.sectionLabel[data-v-2579f0c4]{\r\n        font-weight: bold;\n}\n.wrapper[data-v-2579f0c4]{\r\n        margin: 0;\r\n        padding: 0;\n}\r\n"),Gt.render=function(t,n,o,r,a,i){var l,s,c,u,d,m=e.resolveComponent("NotificationEditor"),f=e.resolveComponent("FormEditor"),_=e.resolveComponent("MetadatasetEditor");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("h3",null,e.toDisplayString(null===(l=t.template)||void 0===l?void 0:l.templateName),1),e.createElementVNode("div",zt,[e.createElementVNode("div",Kt,[e.createElementVNode("div",{class:e.normalizeClass(["col-12 menuEntry","overview"==t.activePanel||null==t.activePanel?"active":""]),onClick:n[0]||(n[0]=function(e){return t.activePanel="overview"})},Wt,2),e.createElementVNode("div",{class:e.normalizeClass(["col-12 menuEntry","notifications"==t.activePanel?"active":""]),onClick:n[1]||(n[1]=function(e){return t.activePanel="notifications"})},Qt,2),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(s=t.metadataSets)||void 0===s?void 0:s.filter((function(e){return 1==e.isTemplate})),(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:e.normalizeClass(["col-12 menuEntry",t.activePanel==n.id?"active":""]),onClick:function(e){return t.activePanel=n.id}},e.toDisplayString(n.name.concatenatedContent),11,Zt)})),128)),e.createElementVNode("div",{class:"col-12 menuEntry",onClick:n[2]||(n[2]=function(e){return t.activePanel="forms"})},Jt),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.dataContainer,(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:e.normalizeClass(["col-12 menuEntry",t.activePanel==n.id?"active":""]),onClick:function(e){return t.activePanel=n.id}},e.toDisplayString(n.name.concatenatedContent),11,en)})),128)),e.createElementVNode("div",{class:"col-12 menuEntry",onClick:n[3]||(n[3]=function(e){return t.activePanel="metadata-forms"})},tn),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(c=t.metadataSets)||void 0===c?void 0:c.filter((function(e){return 0==e.isTemplate})),(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:e.normalizeClass(["col-12 menuEntry",t.activePanel==n.id?"active":""]),onClick:function(e){return t.activePanel=n.id}},e.toDisplayString(n.name.concatenatedContent),11,nn)})),128))]),e.createElementVNode("div",on,[null==t.activePanel||"overview"==t.activePanel?(e.openBlock(),e.createElementBlock("div",rn,an)):e.createCommentVNode("",!0),"notifications"==t.activePanel?(e.openBlock(),e.createElementBlock("div",ln,sn)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(u=t.metadataSets)||void 0===u?void 0:u.filter((function(e){return 1==e.isTemplate})),(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:"col-12 wrapper"},[t.activePanel==n.id?(e.openBlock(),e.createElementBlock("div",cn,[e.createVNode(m,{fieldContainer:n},null,8,["fieldContainer"])])):e.createCommentVNode("",!0)])})),128)),"forms"==t.activePanel?(e.openBlock(),e.createElementBlock("div",un,dn)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.dataContainer,(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:"col-12 wrapper"},[t.activePanel==n.id?(e.openBlock(),e.createElementBlock("div",mn,[e.createVNode(f,{form:n},null,8,["form"])])):e.createCommentVNode("",!0)])})),128)),"metadata-forms"==t.activePanel?(e.openBlock(),e.createElementBlock("div",fn,_n)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(d=t.metadataSets)||void 0===d?void 0:d.filter((function(e){return 0==e.isTemplate})),(function(n){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:"col-12 wrapper"},[t.activePanel==n.id?(e.openBlock(),e.createElementBlock("div",pn,[e.createVNode(_,{metadataset:n},null,8,["metadataset"])])):e.createCommentVNode("",!0)])})),128))])])],64)},Gt.__scopeId="data-v-2579f0c4";var hn=e.defineComponent({name:"ItemTemplateEditor",components:{ItemTemplate:Gt},props:c,setup:function(e){var t=E();console.log("Item Template Editor setup ..."),console.log("props: ",JSON.stringify(e));var n=e.queryParameters;return t.dispatch("SET_ID",n.id),t.dispatch("LOAD_TEMPLATE"),{queryParams:n}},storeConfig:{state:{Id:null,template:null},actions:qt,mutations:Ut,getters:{}}}),vn=e.createElementVNode("h3",null,"Item Template Editor",-1);hn.render=function(t,n,o,r,a,i){var l=e.resolveComponent("ItemTemplate");return e.openBlock(),e.createElementBlock(e.Fragment,null,[vn,e.createElementVNode("div",null,"Item Template ID: "+e.toDisplayString(t.queryParameters.id),1),e.createVNode(l)],64)};var bn=e.defineComponent({name:"ItemEditor",components:{},props:c,setup:function(e,t){return console.log("Editor setup ..."),console.log("props: ",e),console.log("context: ",t),{queryParameters:e.queryParameters}},mounted:function(){console.log("Editor mounted ...")}}),gn=e.createElementVNode("h2",null,"Item Ediror",-1);bn.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",null,[gn,e.createElementVNode("div",null,"Item ID: "+e.toDisplayString(t.queryParameters.id),1)])};var En,Sn,kn;!function(e){e[e[void 0]=0]="undefined",e[e.data=1]="data",e[e.metadata=2]="metadata"}(En||(En={})),function(e){e[e.AttachmentField=0]="AttachmentField",e[e.CheckboxField=1]="CheckboxField",e[e.CompositeField=2]="CompositeField",e[e.DateField=3]="DateField",e[e.DecimalField=4]="DecimalField",e[e.EmailField=5]="EmailField",e[e.FieldContainerReference=6]="FieldContainerReference",e[e.InfoSection=7]="InfoSection",e[e.IntegerField=8]="IntegerField",e[e.MonolingualTextField=9]="MonolingualTextField",e[e.RadioField=10]="RadioField",e[e.SelectField=11]="SelectField",e[e.TableField=12]="TableField",e[e.TextArea=13]="TextArea",e[e.TextField=14]="TextField",e[e.AudioRecorderField=15]="AudioRecorderField"}(Sn||(Sn={})),function(e){e.VALID="VALID",e.VALUE_REQUIRED="VALUE_REQUIRED",e.INVALID="INVALID"}(kn||(kn={}));var yn=function(){function e(){o(this,e)}return a(e,null,[{key:"getSelectedFieldLabels",value:function(e){return null==e?void 0:e.filter((function(e){return e.selected})).map((function(e){var t;return null===(t=e.optionText)||void 0===t?void 0:t.values.$values.map((function(e){return e.value})).join(" / ")})).join(", ")}}]),e}(),Tn=e.defineComponent({name:"Text",props:{model:{type:null,required:!0}},methods:{isUrl:function(e){return(null==e?void 0:e.startsWith("http://"))||(null==e?void 0:e.startsWith("https://"))}}}),Bn={key:0},An=["href"],In={key:1};Tn.render=function(t,n,o,r,a,i){return t.isUrl(t.model.value)?(e.openBlock(),e.createElementBlock("div",Bn,[e.createElementVNode("a",{href:t.model.value},e.toDisplayString(t.model.value),9,An)])):(e.openBlock(),e.createElementBlock("div",In,e.toDisplayString(t.model.value),1))};var Rn=e.defineComponent({name:"TextCollection",props:{model:{type:null,required:!0}},components:{Text:Tn}});Rn.render=function(t,n,o,r,a,i){var l=e.resolveComponent("Text");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.values.$values,(function(t){return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(l,{model:t},null,8,["model"])])})),256)};var Mn=e.defineComponent({name:"TextField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!0},isMultiline:{type:Boolean,required:!1,default:!0}},components:{TextCollection:Rn}});Mn.render=function(t,n,o,r,a,i){var l=e.resolveComponent("TextCollection");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.values.$values,(function(t){return e.openBlock(),e.createElementBlock("div",{key:t.id},[e.createVNode(l,{model:t},null,8,["model"])])})),128)};var wn=e.defineComponent({name:"EmailField",props:{model:{type:null,required:!0},isMultivalue:{type:Boolean,required:!1,default:!1}}});wn.render=function(t,n,o,r,a,i){return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.values.$values,(function(t){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.value),1)})),256)};var Cn=e.defineComponent({name:"OptionsField",components:{},props:{model:{type:Object,required:!0}},methods:{getSelectedFieldLabels:function(e){return yn.getSelectedFieldLabels(e.options.$values)}}});Cn.render=function(t,n,o,r,a,i){return e.toDisplayString(t.getSelectedFieldLabels(t.model))};var xn=e.defineComponent({name:"DecimalField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!1},numDecimalPlaces:{type:Number,required:!1,default:2}},methods:{formatToDecimal:function(e,t){return Number(e).toFixed(t)}}});xn.render=function(t,n,o,r,a,i){return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.values.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.formatToDecimal(n,t.numDecimalPlaces)),1)})),256)};var Fn=e.defineComponent({name:"IntegerField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!1}}});Fn.render=function(t,n,o,r,a,i){return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.values.$values,(function(t){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.value),1)})),256)};var Nn=e.defineComponent({name:"DateField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!1}},methods:{formatDate:function(e){return pe(e).format("MMM DD, YYYY")}}});Nn.render=function(t,n,o,r,a,i){return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.values.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.formatDate(n.value)),1)})),256)};var Dn=e.defineComponent({name:"ChildFieldContainer",props:{model:null},components:{TextField:Mn,EmailField:wn,OptionsField:Cn,DecimalField:xn,IntegerField:Fn,DateField:Nn},methods:{getFieldType:function(e){var t,n=null==e?void 0:e.$type.substring(0,e.$type.indexOf(","));return n=null===(t=n)||void 0===t?void 0:t.substring(n.lastIndexOf(".")+1),Sn[n]},isAttachmentField:function(e){return this.getFieldType(e)===Sn.AttachmentField},isOptionsField:function(e){return this.getFieldType(e)===Sn.CheckboxField||this.getFieldType(e)===Sn.RadioField||this.getFieldType(e)===Sn.SelectField},isCompositeField:function(e){return this.getFieldType(e)===Sn.CompositeField},isDateField:function(e){return this.getFieldType(e)===Sn.DateField},isDecimalField:function(e){return this.getFieldType(e)===Sn.DecimalField},isEmailField:function(e){return this.getFieldType(e)===Sn.EmailField},isFieldContainerReference:function(e){return this.getFieldType(e)===Sn.FieldContainerReference},isInfoSection:function(e){return this.getFieldType(e)===Sn.InfoSection},isIntegerField:function(e){return this.getFieldType(e)===Sn.IntegerField},isMonolingualTextField:function(e){return this.getFieldType(e)===Sn.MonolingualTextField},isTableField:function(e){return this.getFieldType(e)===Sn.TableField},isTextArea:function(e){return this.getFieldType(e)===Sn.TextArea},isTextField:function(e){return this.getFieldType(e)===Sn.TextField},cssClass:function(e){return(e.cssClass?e.cssClass:"")+" "+(e.fieldCssClass?e.fieldCssClass:"")}}}),Vn={class:"field-name col-md-3"},On={class:"field-value col-md-9"},Ln={key:7},Pn={key:8},Hn={key:9},Un={key:11};Dn.render=function(t,n,o,r,a,i){var l=this,s=e.resolveComponent("TextField"),c=e.resolveComponent("EmailField"),u=e.resolveComponent("OptionsField"),d=e.resolveComponent("DecimalField"),m=e.resolveComponent("IntegerField"),f=e.resolveComponent("DateField");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.fields.$values,(function(n){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["row",t.cssClass(n)])},[e.createElementVNode("div",Vn,e.toDisplayString(n.name.concatenatedContent),1),e.createElementVNode("div",On,[l.isTextField(n)?(e.openBlock(),e.createBlock(s,{key:0,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isTextArea(n)?(e.openBlock(),e.createBlock(s,{key:1,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isEmailField(n)?(e.openBlock(),e.createBlock(c,{key:2,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isOptionsField(n)?(e.openBlock(),e.createBlock(u,{key:3,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isDecimalField(n)?(e.openBlock(),e.createBlock(d,{key:4,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isIntegerField(n)?(e.openBlock(),e.createBlock(m,{key:5,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isDateField(n)?(e.openBlock(),e.createBlock(f,{key:6,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isAttachmentField(t.model)?(e.openBlock(),e.createElementBlock("div",Ln," AttachmentField ")):e.createCommentVNode("",!0),l.isCompositeField(t.model)?(e.openBlock(),e.createElementBlock("div",Pn," CompositeField ")):e.createCommentVNode("",!0),l.isInfoSection(t.model)?(e.openBlock(),e.createElementBlock("div",Hn," InfoSection ")):e.createCommentVNode("",!0),l.isMonolingualTextField(t.model)?(e.openBlock(),e.createBlock(s,{key:10,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isTableField(t.model)?(e.openBlock(),e.createElementBlock("div",Un," TableField ")):e.createCommentVNode("",!0)])],2)})),256)};var qn=e.defineComponent({name:"FieldContainerReference",components:{ChildFieldContainer:Dn},props:{model:{type:null,required:!0}},setup:function(t){var n=E(),o=e.ref(t.model.refId);return console.log("refId: "+JSON.stringify(o)),{refId:o,source:e.computed((function(){return n.getters.metadataSet(o.value)}))}}});qn.render=function(t,n,o,r,a,i){var l=e.resolveComponent("ChildFieldContainer");return e.openBlock(),e.createBlock(l,{model:t.source},null,8,["model"])};var Yn=e.defineComponent({name:"AttachmentField",components:{},props:{model:{type:null,required:!0}},setup:function(t){var n=E(),o=e.ref(n.state.item.id),r=e.ref(n.getters.dataItemId);return{itemId:o,fileUrl:"/api/items/"+o.value+"/"+r.value+"/"+t.model.id+"/"}}}),Xn=["href"],jn=["src"];He("\n.img-thumbnail[data-v-307ae89a]{\r\n        width:35px;\r\n        height: auto;\r\n        margin-right: 10px;\n}\r\n"),Yn.render=function(t,n,o,r,a,i){return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.files.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("a",{href:t.fileUrl+n.fileName},[e.createElementVNode("img",{src:n.thumbnail,class:"img-thumbnail"},null,8,jn)],8,Xn),e.createTextVNode(e.toDisplayString(n.originalFileName),1)])})),256)},Yn.__scopeId="data-v-307ae89a";var Gn=e.defineComponent({name:"InfoField",props:{model:{type:null,required:!0}}}),$n=["innerHTML"];Gn.render=function(t,n,o,r,a,i){return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.content.values.$values,(function(t){return e.openBlock(),e.createElementBlock("div",{key:t.id},[e.createElementVNode("div",{innerHTML:t.value},null,8,$n)])})),128)};var zn=e.defineComponent({name:"FieldContainer",props:{model:null,hideFieldNames:Boolean},components:{TextField:Mn,EmailField:wn,OptionsField:Cn,DecimalField:xn,IntegerField:Fn,DateField:Nn,ReferenceField:qn,AttachmentField:Yn,InfoField:Gn},methods:{getFieldType:function(e){var t,n=null==e?void 0:e.$type.substring(0,e.$type.indexOf(","));return n=null===(t=n)||void 0===t?void 0:t.substring(n.lastIndexOf(".")+1),Sn[n]},isAttachmentField:function(e){return this.getFieldType(e)===Sn.AttachmentField},isOptionsField:function(e){return this.getFieldType(e)===Sn.CheckboxField||this.getFieldType(e)===Sn.RadioField||this.getFieldType(e)===Sn.SelectField},isCompositeField:function(e){return this.getFieldType(e)===Sn.CompositeField},isDateField:function(e){return this.getFieldType(e)===Sn.DateField},isDecimalField:function(e){return this.getFieldType(e)===Sn.DecimalField},isEmailField:function(e){return this.getFieldType(e)===Sn.EmailField},isFieldContainerReference:function(e){return this.getFieldType(e)===Sn.FieldContainerReference},isInfoSection:function(e){return this.getFieldType(e)===Sn.InfoSection},isIntegerField:function(e){return this.getFieldType(e)===Sn.IntegerField},isMonolingualTextField:function(e){return this.getFieldType(e)===Sn.MonolingualTextField},isTableField:function(e){return this.getFieldType(e)===Sn.TableField},isTextArea:function(e){return this.getFieldType(e)===Sn.TextArea},isTextField:function(e){return this.getFieldType(e)===Sn.TextField},cssClass:function(e){return e.cssClass+" "+e.fieldCssClass},formatDate:function(e){return pe(e).format("MMM DD, YYYY")}}}),Kn={class:"timeStamp"},Wn={key:0,class:"field-name col-md-3"},Qn={class:"field-value col-md-9"},Zn={key:10},Jn={key:11};zn.render=function(t,n,o,r,a,i){var l=this,s=e.resolveComponent("ReferenceField"),c=e.resolveComponent("TextField"),u=e.resolveComponent("EmailField"),d=e.resolveComponent("OptionsField"),m=e.resolveComponent("DecimalField"),f=e.resolveComponent("IntegerField"),_=e.resolveComponent("DateField"),p=e.resolveComponent("AttachmentField"),h=e.resolveComponent("InfoField");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kn,e.toDisplayString(t.formatDate(t.model.created)),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.fields.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[l.isFieldContainerReference(n)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(t.cssClass(n))},[e.createVNode(s,{model:n},null,8,["model"])],2)):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["row",t.cssClass(n)])},[t.hideFieldNames?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Wn,e.toDisplayString(n.name.concatenatedContent),1)),e.createElementVNode("div",Qn,[l.isTextField(n)?(e.openBlock(),e.createBlock(c,{key:0,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isTextArea(n)?(e.openBlock(),e.createBlock(c,{key:1,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isEmailField(n)?(e.openBlock(),e.createBlock(u,{key:2,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isOptionsField(n)?(e.openBlock(),e.createBlock(d,{key:3,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isDecimalField(n)?(e.openBlock(),e.createBlock(m,{key:4,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isIntegerField(n)?(e.openBlock(),e.createBlock(f,{key:5,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isDateField(n)?(e.openBlock(),e.createBlock(_,{key:6,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isMonolingualTextField(t.model)?(e.openBlock(),e.createBlock(c,{key:7,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isAttachmentField(n)?(e.openBlock(),e.createBlock(p,{key:8,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isInfoSection(n)?(e.openBlock(),e.createBlock(h,{key:9,model:n},null,8,["model"])):e.createCommentVNode("",!0),l.isCompositeField(n)?(e.openBlock(),e.createElementBlock("div",Zn," CompositeField ")):e.createCommentVNode("",!0),l.isTableField(n)?(e.openBlock(),e.createElementBlock("div",Jn," TableField ")):e.createCommentVNode("",!0)])],2))])})),256))],64)};var eo=e.defineComponent({name:"ItemViewer",components:{FieldContainer:zn},props:c,setup:function(t){var n=E(),o=t.dataAttributes;console.log("Item Viewer setup ..."),console.log("props: ",JSON.stringify(t));var r=o["is-admin"];console.log("isAdmin: ",r);var a=t.queryParameters;return n.commit(K.SET_ID,a.iid),n.dispatch(te.LOAD_ITEM),{store:n,queryParams:a,dataItem:e.computed((function(){return n.getters.rootDataItem})),isAdmin:r}},storeConfig:{state:$,actions:ae,mutations:J,getters:{rootDataItem:function(e){var t,n,o;return null===(t=e.item)||void 0===t||null===(n=t.dataContainer)||void 0===n||null===(o=n.$values)||void 0===o?void 0:o.filter((function(e){return e.isRoot}))[0]},metadataSet:function(e){return function(t){var n,o,r;return null===(n=e.item)||void 0===n||null===(o=n.metadataSets)||void 0===o||null===(r=o.$values)||void 0===r?void 0:r.find((function(e){return e.templateId===t}))}},dataItemId:function(e){var t,n,o,r;return null===(t=e.item)||void 0===t||null===(n=t.dataContainer)||void 0===n||null===(o=n.$values)||void 0===o||null===(r=o.filter((function(e){return e.isRoot}))[0])||void 0===r?void 0:r.id}}},methods:{changeItemState:function(e){confirm("Do you really want to delete this item?")&&(console.log("id: "+e),this.store.dispatch(te.CHANGE_STATE,e))}}}),to={key:0,class:"text-right"},no={class:"item"};var oo;He("\n.field-name[data-v-f3c870c6] {\r\n        font-weight: bold !important;\n}\n.fa-remove[data-v-f3c870c6] {\r\n        color: red;\r\n        margin-left: 30px;\n}\r\n"),eo.render=function(t,n,o,r,a,i){var l=e.resolveComponent("FieldContainer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[t.isAdmin?(e.openBlock(),e.createElementBlock("div",to,[e.createElementVNode("span",{class:"fas fa-remove",onClick:n[0]||(n[0]=function(e){t.changeItemState(t.queryParams.iid)})})])):e.createCommentVNode("",!0),e.createElementVNode("div",no,[t.dataItem?(e.openBlock(),e.createBlock(l,{key:0,model:t.dataItem},null,8,["model"])):e.createCommentVNode("",!0)])],64)},eo.__scopeId="data-v-f3c870c6",function(e){e[e.InProgress=1]="InProgress",e[e.Ready=2]="Ready"}(oo||(oo={}));var ro,ao,io={indexingStatus:{pageIndexingStatus:oo.Ready,dataIndexingStatus:oo.Ready}};!function(e){e.SET_REINDEX_PAGE_STATUS="SET_REINDEX_PAGE_STATUS",e.SET_REINDEX_DATA_STATUS="SET_REINDEX_DATA_STATUS",e.SET_REINDEX_STATUS="SET_REINDEX_STATUS"}(ao||(ao={}));var lo,so,co=(i(ro={},ao.SET_REINDEX_PAGE_STATUS,(function(e,t){console.log("SET_REINDEX_PAGE_STATUS: ",t),e.indexingStatus.pageIndexingStatus=t})),i(ro,ao.SET_REINDEX_DATA_STATUS,(function(e,t){console.log("SET_REINDEX_DATA_STATUS: ",t),e.indexingStatus.dataIndexingStatus=t})),i(ro,ao.SET_REINDEX_STATUS,(function(e,t){console.log("SET_REINDEX_STATUS: ",t),e.indexingStatus=t})),ro);!function(e){e.REINDEX_DATA="REINDEX_DATA",e.REINDEX_PAGES="REINDEX_PAGES",e.FETCH_REINDEX_STATUS="FETCH_REINDEX_STATUS"}(so||(so={}));var uo=(i(lo={},so.REINDEX_DATA,(function(e){var t=window.location.origin+"/applets/api/reindex/data";e.commit(ao.SET_REINDEX_DATA_STATUS,oo.InProgress),fetch(t,{method:"POST"}).then((function(e){return e.json()})).then((function(t){e.commit(ao.SET_REINDEX_DATA_STATUS,t)})).catch((function(e){console.error("Data reindexing error:",e)}))})),i(lo,so.REINDEX_PAGES,(function(e){var t=window.location.origin+"/applets/api/reindex/pages";e.commit(ao.SET_REINDEX_PAGE_STATUS,oo.InProgress),fetch(t,{method:"POST"}).then((function(e){return e.json()})).then((function(t){e.commit(ao.SET_REINDEX_PAGE_STATUS,t)})).catch((function(e){console.error("Page reindexing error:",e)}))})),i(lo,so.FETCH_REINDEX_STATUS,(function(e){var t=window.location.origin+"/applets/api/reindex/status";fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(ao.SET_REINDEX_STATUS,t)})).catch((function(e){console.error("Fetch reindexing status error:",e)}))})),lo),mo=e.defineComponent({name:"IndexingPanel",props:{},setup:function(){var t=E();return{reindexData:function(){return t.dispatch(so.REINDEX_DATA)},reindexPages:function(){return t.dispatch(so.REINDEX_PAGES)},isPageIndexingReady:e.computed((function(){return t.state.indexingStatus.pageIndexingStatus==oo.Ready})),isDataIndexingReady:e.computed((function(){return t.state.indexingStatus.dataIndexingStatus==oo.Ready}))}}}),fo=e.createElementVNode("h5",{class:"card-title"},"Data Indexing",-1),_o=e.createElementVNode("p",{class:"card-text"},"With supporting text below as a natural lead-in to additional content.",-1),po={key:1,class:"btn btn-danger",disabled:""},ho=e.createElementVNode("br",null,null,-1),vo=e.createElementVNode("br",null,null,-1),bo=e.createElementVNode("h5",{class:"card-title"},"Page Indexing",-1),go=e.createElementVNode("p",{class:"card-text"},"With supporting text below as a natural lead-in to additional content.",-1),Eo={key:3,class:"btn btn-danger",disabled:""};mo.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[fo,_o,t.isDataIndexingReady?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-primary",onClick:n[0]||(n[0]=function(){return t.reindexData&&t.reindexData.apply(t,arguments)})},"Reindex")):(e.openBlock(),e.createElementBlock("button",po,"Indexing In-progress")),ho,vo,bo,go,t.isPageIndexingReady?(e.openBlock(),e.createElementBlock("button",{key:2,class:"btn btn-primary",onClick:n[1]||(n[1]=function(){return t.reindexPages&&t.reindexPages.apply(t,arguments)})},"Reindex")):(e.openBlock(),e.createElementBlock("button",Eo,"Indexing In-progress"))],64)};var So,ko,yo=e.defineComponent({name:"Applet",components:{IndexingPanel:mo},props:c,setup:function(t){console.log("Process Manager setup ...",t);var n=E();e.onMounted((function(){return n.dispatch(so.FETCH_REINDEX_STATUS)}))},storeConfig:{state:io,actions:uo,mutations:co,getters:{}}}),To={class:"card"},Bo=e.createElementVNode("div",{class:"card-header"}," Indexing Processes ",-1),Ao={class:"card-body"};yo.render=function(t,n,o,r,a,i){var l=e.resolveComponent("IndexingPanel");return e.openBlock(),e.createElementBlock("div",To,[Bo,e.createElementVNode("div",Ao,[e.createVNode(l)])])},function(e){e.SET_SOURCE="SET_SOURCE",e.SET_MODEL="SET_MODEL"}(ko||(ko={}));var Io,Ro,Mo=(i(So={},ko.SET_SOURCE,(function(e,t){e.pageId=t.pageId,e.blockId=t.blockId})),i(So,ko.SET_MODEL,(function(e,t){e.model=t})),So);!function(e){e.LOAD_BLOCK="LOAD_BLOCK",e.LOAD_PAGE="LOAD_PAGE"}(Ro||(Ro={}));var wo=(i(Io={},Ro.LOAD_BLOCK,(function(e){e.state.pageId||console.error("Page ID is null. It must be a valid GUID"),e.state.blockId||console.error("Block ID is null. It must be a valid GUID");var t=window.location.origin+"/applets/api/content/page/".concat(e.state.pageId,"/block/").concat(e.state.blockId);console.log("LOAD_BLOCK API: ",t),fetch(t,{method:"GET"}).then((function(e){return e.json()})).then((function(t){e.commit(ko.SET_MODEL,t)})).catch((function(e){console.error("LOAD_BLOCK error:",e)}))})),i(Io,Ro.LOAD_PAGE,(function(e){if(!e.state.pageId)throw new Error("Page ID is null. It must be a valid GUID");var t=window.location.origin+"/applets/api/content/page/".concat(e.state.pageId);console.log("LOAD_PAGE API: ",t),fetch(t,{method:"GET"}).then((function(e){return e.json()})).then((function(t){e.commit(ko.SET_MODEL,t)})).catch((function(e){console.error("LOAD_PAGE error:",e)}))})),Io),Co=e.defineComponent({name:"ImgDiv",props:{image:{type:Object,required:!0},debounceMs:{type:Number,required:!1,default:200}},methods:{resizeHandler:function(){this.setViewHeight(!1)},setViewHeight:function(e){var t=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout);var n=e?0:this.debounceMs;this.resizeTimeout=setTimeout((function(){if(t.root){var e=Math.round(t.root.clientWidth/t.aspectRatio);t.root.style.height="".concat(e,"px")}}),n)}},created:function(){window.addEventListener("resize",this.resizeHandler)},destroyed:function(){window.removeEventListener("resize",this.resizeHandler)},mounted:function(){this.setViewHeight(!0)},setup:function(t){var n=e.toRefs(t).image,o=e.ref(),r=e.ref();return{root:o,imageUrl:e.computed((function(){var e,t;return null===(e=n.value)||void 0===e||null===(t=e.publicUrl)||void 0===t?void 0:t.replace(/^~+/g,"")})),aspectRatio:e.computed((function(){return n.value?n.value.width/n.value.height:1})),resizeTimeout:r}}}),xo=["id"];Co.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",{ref:"root",style:e.normalizeStyle([{backgroundImage:"url(".concat(t.imageUrl,")")},{"background-size":"cover"}]),id:t.image.id,class:"cf-img-div"},null,12,xo)};var Fo=e.defineComponent({name:"CardTemplate",components:{ImgDiv:Co},props:{model:{type:Object,required:!0}},setup:function(t){var n=e.toRefs(t).model;return{model:n,cardImage:e.computed((function(){var e;return null===(e=n.value)||void 0===e?void 0:e.cardImage.media})),popupImageUrl:e.computed((function(){var e,t,o;return null===(e=n.value)||void 0===e||null===(t=e.modalImage)||void 0===t||null===(o=t.media)||void 0===o?void 0:o.publicUrl})),title:e.computed((function(){var e;return null===(e=n.value)||void 0===e?void 0:e.cardTitle.value})),subTitle:e.computed((function(){var e;return null===(e=n.value)||void 0===e?void 0:e.cardSubTitle.value})),hasModel:e.computed((function(){return n.value.hasAModal})),modelImage:e.computed((function(){var e;return null===(e=n.value)||void 0===e?void 0:e.modalImage})),modalTitle:e.computed((function(){var e;return null===(e=n.value)||void 0===e?void 0:e.modalTitle.value})),modalSubTitle:e.computed((function(){var e;return null===(e=n.value)||void 0===e?void 0:e.modalSubTitle.value}))}}}),No={class:"col-md-4 cf-card"};He("\n.cf-card{\r\n        text-align:center;\n}\r\n"),Fo.render=function(t,n,o,r,a,i){var l=e.resolveComponent("img-div");return e.openBlock(),e.createElementBlock("div",No,[e.createVNode(l,{image:t.cardImage,"debounce-ms":250,class:"img-div"},null,8,["image"]),e.createElementVNode("h2",null,e.toDisplayString(t.title),1),e.createElementVNode("h4",null,e.toDisplayString(t.subTitle),1)])};var Do=e.defineComponent({name:"Applet",components:{CardTemplate:Fo},props:c,setup:function(t){console.log("Grid setup ...");var n=E();return n.commit(ko.SET_SOURCE,{pageId:t.pageId,blockId:t.blockId}),e.onMounted((function(){return n.dispatch(Ro.LOAD_BLOCK)})),{model:e.computed((function(){return n.state.model}))}},storeConfig:{actions:wo,mutations:Mo,getters:{searchParamStorageKey:function(e){var t;return(null===(t=e.blockId)||void 0===t?void 0:t.toString())+"SearchParams"}}}}),Vo=e.createElementVNode("h2",null,"Grid",-1),Oo={class:"row"};Do.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("CardTemplate");return e.openBlock(),e.createElementBlock("div",null,[Vo,e.createElementVNode("div",Oo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l?void 0:l.items,(function(t){return e.openBlock(),e.createBlock(s,{model:t},null,8,["model"])})),256))])])};var Lo,Po=fe((function(e,t){t.__esModule=!0;var n=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var n=t.toString();return t&&(t instanceof e||e.validator.test(n))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",n=0;n<e;n++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();t.Guid=n}));!function(e){e.None="None",e.InProgress="InProgress",e.Success="Success",e.Fail="Fail"}(Lo||(Lo={}));var Ho=function(){function e(){o(this,e)}return a(e,null,[{key:"cssClass",value:function(e){return e.cssClass+" "+e.fieldCssClass}},{key:"getFieldType",value:function(e){var t,n=null==e?void 0:e.$type.substring(0,e.$type.indexOf(","));return n=null===(t=n)||void 0===t?void 0:t.substring(n.lastIndexOf(".")+1),Sn[n]}},{key:"isAttachmentField",value:function(e){return this.getFieldType(e)===Sn.AttachmentField}},{key:"isOptionsField",value:function(e){var t=this.getFieldType(e);return t===Sn.CheckboxField||t===Sn.RadioField||t===Sn.SelectField}},{key:"isCompositeField",value:function(e){return this.getFieldType(e)===Sn.CompositeField}},{key:"isDateField",value:function(e){return this.getFieldType(e)===Sn.DateField}},{key:"isDecimalField",value:function(e){return this.getFieldType(e)===Sn.DecimalField}},{key:"isEmailField",value:function(e){return this.getFieldType(e)===Sn.EmailField}},{key:"isFieldContainerReference",value:function(e){return this.getFieldType(e)===Sn.FieldContainerReference}},{key:"isInfoSection",value:function(e){return this.getFieldType(e)===Sn.InfoSection}},{key:"isIntegerField",value:function(e){return this.getFieldType(e)===Sn.IntegerField}},{key:"isMonolingualTextField",value:function(e){return this.getFieldType(e)===Sn.MonolingualTextField}},{key:"isTableField",value:function(e){return this.getFieldType(e)===Sn.TableField}},{key:"isTextArea",value:function(e){return this.getFieldType(e)===Sn.TextArea}},{key:"isTextField",value:function(e){return this.getFieldType(e)===Sn.TextField}},{key:"isAudioRecorderField",value:function(e){return this.getFieldType(e)===Sn.AudioRecorderField}}]),e}();function Uo(e,t){var n,o;null==e||null===(n=e.fields)||void 0===n||null===(o=n.$values)||void 0===o||o.forEach((function(e){var n,o,r,a=null===(n=e.$type)||void 0===n?void 0:n.substring(0,e.$type.indexOf(",")),i=a.substring(a.lastIndexOf(".")+1),l=Sn[i],s=l===Sn.DateField||l===Sn.DecimalField||l===Sn.EmailField||l===Sn.IntegerField||l===Sn.MonolingualTextField,c=l===Sn.TextArea||l===Sn.TextField,u=l===Sn.CheckboxField||l===Sn.RadioField||l===Sn.SelectField;if(s)null===(o=e.values)||void 0===o||null===(r=o.$values)||void 0===r||r.forEach((function(e){t.flattenedTextModels[e.id.toString()]=e}));else if(c){var d,m;null===(d=e.values)||void 0===d||null===(m=d.$values)||void 0===m||m.forEach((function(e){var n,o;null===(n=e.values)||void 0===n||null===(o=n.$values)||void 0===o||o.forEach((function(e){t.flattenedTextModels[e.id.toString()]=e}))}))}else if(u){var f,_;null===(f=e.options)||void 0===f||null===(_=f.$values)||void 0===_||_.forEach((function(e){t.flattenedOptionModels[e.id.toString()]=e}))}}))}function qo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{id:Po.Guid.create().toString(),$type:"Catfish.Core.Models.Contents.Text, Catfish.Core",language:e,created:new Date,value:t}}var Yo,Xo,jo={modified:!1,flattenedTextModels:{},flattenedOptionModels:{},flattenedFileModels:{}},Go=n(n({},jo),{},{itemTemplateId:null,formId:null,collectionId:null,groupId:null,form:null,submissionStatus:Lo.None,formLoadAPI:null,formSubmissionAPI:null}),$o=n({itemInstanceId:null,childResponseFormId:null,childResponseForm:null,formInstances:null},Go);!function(e){e.SET_TEXT_VALUE="SET_TEXT_VALUE",e.SET_OPTION_VALUE="SET_OPTION_VALUE",e.ADD_FILE="ADD_FILE",e.REMOVE_FILE="REMOVE_FILE",e.CLEAR_FIELD_DATA="CLEAR_FIELD_DATA",e.REMOVE_FIELD_CONTAINERS="REMOVE_FIELD_CONTAINERS",e.APPEND_FIELD_DATA="APPEND_FIELD_DATA",e.APPEND_MONOLINGUAL_VALUE="APPEND_MONOLINGUAL_VALUE",e.APPEND_MULTILINGUAL_VALUE="APPEND_MULTILINGUAL_VALUE"}(Xo||(Xo={}));var zo,Ko,Wo=(i(Yo={},Xo.SET_TEXT_VALUE,(function(e,t){e.flattenedTextModels[t.id.toString()].value=t.val,e.modified=!0})),i(Yo,Xo.SET_OPTION_VALUE,(function(e,t){e.flattenedOptionModels[t.id.toString()].selected=t.isSelected,e.modified=!0})),i(Yo,Xo.ADD_FILE,(function(e,t){e.flattenedFileModels[t.id.toString()]||(e.flattenedFileModels[t.id.toString()]=[]),e.flattenedFileModels[t.id.toString()].push(t.val),e.modified=!0})),i(Yo,Xo.REMOVE_FILE,(function(e,t){var n;null===(n=e.flattenedFileModels[t.id.toString()])||void 0===n||n.splice(t.index,1),e.modified=!0})),i(Yo,Xo.CLEAR_FIELD_DATA,(function(e){Object.keys(e.flattenedTextModels).forEach((function(t){e.flattenedTextModels[t].value=""})),Object.keys(e.flattenedOptionModels).forEach((function(t){e.flattenedOptionModels[t].selected=!1})),Object.keys(e.flattenedFileModels).forEach((function(t){e.flattenedFileModels[t]=[]})),e.modified=!1})),i(Yo,Xo.REMOVE_FIELD_CONTAINERS,(function(e){e.flattenedTextModels={},e.flattenedOptionModels={},e.flattenedFileModels={},e.modified=!1})),i(Yo,Xo.APPEND_FIELD_DATA,(function(e,t){Uo(t,e)})),i(Yo,Xo.APPEND_MONOLINGUAL_VALUE,(function(e,t){var n,o=qo();null===(n=t.values)||void 0===n||n.$values.push(o),e.flattenedTextModels[o.id.toString()]=o})),i(Yo,Xo.APPEND_MULTILINGUAL_VALUE,(function(e,t){var n,o,r,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["en"];return{id:Po.Guid.create().toString(),$type:"Catfish.Core.Models.Contents.MultilingualValue, Catfish.Core",values:{$type:"Catfish.Core.Models.Contents.XmlModelList`1[[Catfish.Core.Models.Contents.Text, Catfish.Core]], Catfish.Core",$values:e.map((function(e){return qo(e)}))}}}(null!==(n=t.values)&&void 0!==n&&n.$values[0]?(null===(o=t.values)||void 0===o?void 0:o.$values[0]).values.$values.map((function(e){return e.language})):["en"]);a.values.$values.forEach((function(t){return e.flattenedTextModels[t.id.toString()]=t})),null===(r=t.values)||void 0===r||r.$values.push(a)})),Yo);!function(e){e.SET_ITEM_TEMPLATE_ID="SET_ITEM_TEMPLATE_ID",e.SET_FORM_ID="SET_FORM_ID",e.SET_SUBMISSION_STATUS="SET_SUBMISSION_STATUS",e.SET_COLLECTION_ID="SET_COLLECTION_ID",e.SET_GROUP_ID="SET_GROUP_ID",e.SET_FORM="SET_FORM"}(Ko||(Ko={}));var Qo,Zo,Jo=n(n({},Wo),{},(i(zo={},Ko.SET_ITEM_TEMPLATE_ID,(function(e,t){e.itemTemplateId=t})),i(zo,Ko.SET_FORM_ID,(function(e,t){e.formId=t})),i(zo,Ko.SET_COLLECTION_ID,(function(e,t){e.collectionId=t})),i(zo,Ko.SET_GROUP_ID,(function(e,t){e.groupId=t})),i(zo,Ko.SET_SUBMISSION_STATUS,(function(e,t){e.submissionStatus=Lo[t]})),i(zo,Ko.SET_FORM,(function(e,t){e.form=t})),zo));!function(e){e.SET_SUBMISSIONS="SET_SUBMISSIONS",e.SET_PARENT_ITEM_ID="SET_PARENT_ITEM_ID",e.APPEND_CHILD_INSTANCE="APPEND_CHILD_INSTANCE",e.SET_RESPONSE_FORM_ID="SET_RESPONSE_FORM_ID",e.SET_RESPONSE_FORM="SET_RESPONSE_FORM",e.APPEND_CHILD_RESPONSE_INSTANCE="APPEND_CHILD_RESPONSE_INSTANCE",e.DELETE_CHILD_RESPONSE_INSTANCE="DELETE_CHILD_RESPONSE_INSTANCE",e.DELETE_CHILD_INSTANCE="DELETE_CHILD_INSTANCE"}(Zo||(Zo={}));var er,tr,nr=n((i(Qo={},Zo.SET_SUBMISSIONS,(function(e,t){e.formInstances=t})),i(Qo,Zo.SET_PARENT_ITEM_ID,(function(e,t){e.itemInstanceId=t})),i(Qo,Zo.APPEND_CHILD_INSTANCE,(function(e,t){var n;null===(n=e.formInstances)||void 0===n||n.$values.unshift(t)})),i(Qo,Zo.SET_RESPONSE_FORM_ID,(function(e,t){e.childResponseFormId=t})),i(Qo,Zo.SET_RESPONSE_FORM,(function(e,t){e.childResponseForm=t,Uo(e.childResponseForm,e)})),i(Qo,Zo.APPEND_CHILD_RESPONSE_INSTANCE,(function(e,t){var n,o,r=null===(n=e.formInstances)||void 0===n?void 0:n.$values.find((function(e){return e.id===(null==t?void 0:t.parentId)}));r&&(null===(o=r.childFieldContainers)||void 0===o||o.$values.push(t))})),i(Qo,Zo.DELETE_CHILD_RESPONSE_INSTANCE,(function(e,t){var n,o=null===(n=e.formInstances)||void 0===n?void 0:n.$values.find((function(e){return e.id===(null==t?void 0:t.parentId)}));if(o){var r,a,i=null==o||null===(r=o.childFieldContainers)||void 0===r?void 0:r.$values.indexOf(t);i>=0&&(null===(a=o.childFieldContainers)||void 0===a||a.$values.splice(i,1))}})),i(Qo,Zo.DELETE_CHILD_INSTANCE,(function(e,t){var n,o,r,a=null===(n=e.formInstances)||void 0===n||null===(o=n.$values)||void 0===o?void 0:o.indexOf(t);void 0!==a&&a>=0&&(null===(r=e.formInstances)||void 0===r||r.$values.splice(a,1))})),Qo),Jo),or=function e(){o(this,e)};function rr(e){if(!e.required)return kn.VALID;for(var t=!1,n=0;!t&&null!=e&&e.values&&n<(null===(o=e.values)||void 0===o||null===(r=o.$values)||void 0===r?void 0:r.length);++n)for(var o,r,a,i=null==e||null===(a=e.values)||void 0===a?void 0:a.$values[n],l=0;!t&&i.values&&l<(null===(s=i.values)||void 0===s?void 0:s.$values.length);++l){var s,c,u,d;t=(null===(c=i.values)||void 0===c||null===(u=c.$values[l])||void 0===u||null===(d=u.value)||void 0===d?void 0:d.trim().length)>0}return t?kn.VALID:kn.VALUE_REQUIRED}function ar(e,t){for(var n=!1,o=kn.VALID,r=0;null!=e&&e.values&&r<(null===(a=e.values)||void 0===a?void 0:a.$values.length);++r){var a,i,l,s=null===(i=e.values.$values[r])||void 0===i||null===(l=i.value)||void 0===l?void 0:l.trim();(null==s?void 0:s.length)>0&&(n=!0,t&&!t.test(s)&&(o=kn.INVALID))}return e.required&&!n&&(o=kn.VALUE_REQUIRED),o}function ir(e){for(var t=!1,n=kn.VALID,o=0;null!=e&&e.values&&o<(null===(r=e.values)||void 0===r?void 0:r.$values.length);++o){var r,a;"number"==typeof(null===(a=e.values.$values[o])||void 0===a?void 0:a.value)&&(t=!0)}return e.required&&!t&&(n=kn.VALUE_REQUIRED),n}function lr(e){if(!e.required)return kn.VALID;for(var t=!1,n=0;!t&&null!==(o=e.options)&&void 0!==o&&o.$values&&n<(null===(r=e.options)||void 0===r||null===(a=r.$values)||void 0===a?void 0:a.length);++n){var o,r,a,i;t=null===(i=e.options)||void 0===i?void 0:i.$values[n].selected}return t?kn.VALID:kn.VALUE_REQUIRED}function sr(e){var t,n,o=!0;return null===(t=e.fields)||void 0===t||null===(n=t.$values)||void 0===n||n.forEach((function(e){switch(Ho.getFieldType(e)){case Sn.AttachmentField:break;case Sn.CheckboxField:case Sn.RadioField:case Sn.SelectField:e.validationStatus=lr(e);break;case Sn.CompositeField:break;case Sn.DateField:e.validationStatus=ar(e,null);break;case Sn.DecimalField:case Sn.IntegerField:e.validationStatus=ir(e);break;case Sn.EmailField:e.validationStatus=ar(e,or.Email);break;case Sn.FieldContainerReference:break;case Sn.MonolingualTextField:e.validationStatus=ar(e,null);break;case Sn.TableField:break;case Sn.TextArea:case Sn.TextField:e.validationStatus=rr(e);break;case Sn.AudioRecorderField:e.validationStatus=kn.VALID}o=o&&e.validationStatus===kn.VALID})),e.validationStatus=o?null:kn.INVALID,o}i(or,"Email",/^[^\s@]+@[^\s@]+\.[^\s@]+$/),i(or,"Number",/^\d+$/),i(or,"Decimal",/^[+-]?(\d+\.?\d*|\.\d+)$/),function(e){e.LOAD_FORM="LOAD_FORM",e.LOAD_SUBMISSIONS="LOAD_SUBMISSIONS",e.LOAD_RESPONSE_FORM="LOAD_RESPONSE_FORM",e.SUBMIT_CHILD_FORM="SUBMIT_CHILD_FORM",e.SUBMIT_CHILD_RESPONSE_FORM="SUBMIT_CHILD_RESPONSE_FORM",e.DELETE_CHILD_RESPONSE_INSTANCE="DELETE_CHILD_RESPONSE_INSTANCE",e.DELETE_CHILD_INSTANCE="DELETE_CHILD_INSTANCE"}(tr||(tr={}));var cr=(i(er={},tr.LOAD_FORM,(function(e){var t=window.location.origin+"/applets/api/items/getchildform/".concat(e.state.itemInstanceId,"/").concat(e.state.formId);fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Ko.SET_FORM,t),e.commit(Xo.APPEND_FIELD_DATA,t)})).catch((function(e){console.error("Actions.LOAD_FORM Error: ",e)}))})),i(er,tr.LOAD_RESPONSE_FORM,(function(e){var t=window.location.origin+"/applets/api/items/getchildform/".concat(e.state.itemInstanceId,"/").concat(e.state.childResponseFormId);fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Zo.SET_RESPONSE_FORM,t)})).catch((function(e){console.error("Actions.LOAD_RESPONSE_FORM Error: ",e)}))})),i(er,tr.LOAD_SUBMISSIONS,(function(e){var t=window.location.origin+"/applets/api/items/getchildformsubmissions/".concat(e.state.itemInstanceId,"/").concat(e.state.formId);console.log("Child Submissions Load API: ",t),fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Zo.SET_SUBMISSIONS,t)})).catch((function(e){console.error("Submission loading error:",e)}))})),i(er,tr.SUBMIT_CHILD_FORM,(function(e){var t=e.state.form;if(t&&sr(t)){e.commit(Ko.SET_SUBMISSION_STATUS,"InProgress");var n=window.location.origin+"/applets/api/items/appendchildforminstance/".concat(e.state.itemInstanceId),o=new FormData;o.append("datamodel",JSON.stringify(t)),fetch(n,{body:o,method:"post"}).then((function(e){return e.json()})).then((function(t){e.commit(Xo.CLEAR_FIELD_DATA),e.commit(Zo.APPEND_CHILD_INSTANCE,t),e.commit(Ko.SET_SUBMISSION_STATUS,"Success")})).catch((function(t){e.commit(Ko.SET_SUBMISSION_STATUS,"Fail"),console.log(t)}))}})),i(er,tr.SUBMIT_CHILD_RESPONSE_FORM,(function(e,t){if(e.state.childResponseForm&&sr(e.state.childResponseForm)){var n=window.location.origin+"/applets/api/items/appendchildforminstance/".concat(e.state.itemInstanceId),o=new FormData;o.append("datamodel",JSON.stringify(e.state.childResponseForm)),t&&o.append("parentId",t.toString()),fetch(n,{body:o,method:"post"}).then((function(e){return e.json()})).then((function(t){e.commit(Zo.APPEND_CHILD_RESPONSE_INSTANCE,t),e.commit(Xo.CLEAR_FIELD_DATA)})).catch((function(t){e.commit(Ko.SET_SUBMISSION_STATUS,"Fail"),console.log(t)}))}})),i(er,tr.DELETE_CHILD_RESPONSE_INSTANCE,(function(e,t){var n=window.location.origin+"/applets/api/items/deleteChildForm/".concat(e.state.itemInstanceId,"/").concat(t.id,"?parentId=").concat(t.parentId);fetch(n,{method:"post"}).then((function(e){return e.json()})).then((function(n){n.id&&(console.log("deleteChildForm response received"),e.commit(Zo.DELETE_CHILD_RESPONSE_INSTANCE,t))})).catch((function(t){e.commit(Ko.SET_SUBMISSION_STATUS,"Fail"),console.log(t)}))})),i(er,tr.DELETE_CHILD_INSTANCE,(function(e,t){var n=window.location.origin+"/applets/api/items/deleteChildForm/".concat(e.state.itemInstanceId,"/").concat(t.id);fetch(n,{method:"post"}).then((function(e){return e.json()})).then((function(n){n.id&&(console.log("deleteChildForm response received"),e.commit(Zo.DELETE_CHILD_INSTANCE,t))})).catch((function(t){e.commit(Ko.SET_SUBMISSION_STATUS,"Fail"),console.log(t)}))})),er),ur=e.defineComponent({name:"DropZone",props:{id:{required:!0,type:String}},setup:function(){var t=e.ref(!1);return{active:t,toggleActive:function(){t.value=!t.value}}}}),dr=function(t){return e.pushScopeId("data-v-eae6523c"),t=t(),e.popScopeId(),t},mr=dr((function(){return e.createElementVNode("span",null,"Drag and Drop File(s)",-1)})),fr=dr((function(){return e.createElementVNode("span",null,"OR",-1)})),_r=["for"],pr=["id"];He("\n.dropzone[data-v-eae6523c] {\r\n        width: 400px;\r\n        height: 200px;\r\n        margin-top:20px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: center;\r\n        align-items: center;\r\n        row-gap: 16px;\r\n        border: 2px dashed #41b883;\r\n        background-color: #fff;\r\n        transition: 0.3s ease all;\n}\n.dropzone label[data-v-eae6523c] {\r\n            padding: 8px 12px;\r\n            color: #fff;\r\n            background-color: #41b883;\r\n            transition: 0.3s ease all;\n}\n.dropzone input[data-v-eae6523c] {\r\n            display: none;\n}\n.active-dropzone[data-v-eae6523c] {\r\n        color: #fff;\r\n        border-color: #fff;\r\n        background-color: #41b883;\n}\n.active-dropzone label[data-v-eae6523c] {\r\n            background-color: #fff;\r\n            color: #41b883;\n}\r\n"),ur.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",{onDragenter:n[0]||(n[0]=e.withModifiers((function(){return t.toggleActive&&t.toggleActive.apply(t,arguments)}),["prevent"])),onDragleave:n[1]||(n[1]=e.withModifiers((function(){return t.toggleActive&&t.toggleActive.apply(t,arguments)}),["prevent"])),onDragover:n[2]||(n[2]=e.withModifiers((function(){}),["prevent"])),onDrop:n[3]||(n[3]=e.withModifiers((function(){return t.toggleActive&&t.toggleActive.apply(t,arguments)}),["prevent"])),class:e.normalizeClass([{"active-dropzone":t.active},"dropzone"])},[mr,fr,e.createElementVNode("label",{for:t.id},"Select File(s)",8,_r),e.createElementVNode("input",{type:"file",id:t.id,class:"dropzoneFile",multiple:""},null,8,pr)],34)},ur.__scopeId="data-v-eae6523c";var hr=e.defineComponent({name:"AttachmentField",components:{DropZone:ur},props:{model:{type:null,required:!0}},setup:function(t){var n=E(),o=e.computed((function(){return n.state.flattenedFileModels[t.model.id.toString()]})),r=e.computed((function(){var e;return null==o||null===(e=o.value)||void 0===e?void 0:e.map((function(e){return e.name}))}));return{drop:function(e){Array.from(e.dataTransfer.files).forEach((function(e){n.commit(Xo.ADD_FILE,{id:t.model.id,val:e})}))},selectFiles:function(){var e=document.getElementById(t.model.id.toString());Array.from(null==e?void 0:e.files).forEach((function(e){n.commit(Xo.ADD_FILE,{id:t.model.id,val:e})}))},selectedFiles:o,selectedFileNames:r}}});hr.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("DropZone");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",null,e.toDisplayString(null===(l=t.selectedFileNames)||void 0===l?void 0:l.join(" | ")),1),e.createVNode(s,{id:t.model.id,onDrop:e.withModifiers(t.drop,["prevent"]),onChange:t.selectFiles},null,8,["id","onDrop","onChange"])],64)};var vr=e.defineComponent({name:"CheckboxField",components:{},props:{model:{type:Object,required:!0}},setup:function(t){var n=E(),o=e.computed({get:function(){return t.model.options.$values.filter((function(e){return!0===e.selected})).map((function(e){return e.id}))},set:function(){}});return{store:n,selectoption:function(e){n.commit(Xo.SET_OPTION_VALUE,{id:e.target.value,isSelected:e.target.checked})},selectedoptions:o,getConcatenatedOptionLabels:function(e){var t,n,o=null===(t=e.optionText)||void 0===t||null===(n=t.values)||void 0===n?void 0:n.$values.map((function(e){return e.value})).join(" / ");return o||""}}}}),br=["id","value"],gr=["for"];vr.render=function(t,n,o,r,a,i){var l=this;return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.options.$values,(function(o){return e.openBlock(),e.createElementBlock("div",null,[e.withDirectives(e.createElementVNode("input",{type:"checkbox",id:o.id,value:o.id,"onUpdate:modelValue":n[0]||(n[0]=function(e){return t.selectedoptions=e}),onChange:n[1]||(n[1]=function(e){return t.selectoption(e)})},null,40,br),[[e.vModelCheckbox,t.selectedoptions]]),e.createElementVNode("label",{for:o.id},e.toDisplayString(l.getConcatenatedOptionLabels(o)),9,gr)])})),256)};var Er=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Sr=function(e){return-1!==Er.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},kr=function(t,n,o,r,a,i){r.setContent(i()),o.attrs["onUpdate:modelValue"]&&function(t,n,o,r){var a=t.modelEvents?t.modelEvents:null,i=Array.isArray(a)?a.join(" "):a;e.watch(r,(function(e,n){o&&"string"==typeof e&&e!==n&&e!==o.getContent({format:t.outputFormat})&&o.setContent(e)})),o.on(i||"change input undo redo",(function(){n.emit("update:modelValue",o.getContent({format:t.outputFormat}))}))}(n,o,r,a),function(e,t,n){Object.keys(t).filter(Sr).forEach((function(o){var r=t[o];"function"==typeof r&&("onInit"===o?r(e,n):n.on(o.substring(2),(function(e){return r(e,n)})))}))}(t,o.attrs,r)},yr=0,Tr=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++yr+String(t)},Br=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},Ar=function(){return{listeners:[],scriptId:Tr("tiny-script"),scriptLoaded:!1}},Ir=function(){var e=Ar();return{load:function(t,n,o){e.scriptLoaded?o():(e.listeners.push(o),t.getElementById(e.scriptId)||function(e,t,n,o){var r=t.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=e,r.src=n;var a=function(){r.removeEventListener("load",a),o()};r.addEventListener("load",a),t.head&&t.head.appendChild(r)}(e.scriptId,t,n,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))},reinitialize:function(){e=Ar()}}}(),Rr=function(){return"undefined"!=typeof window?window:global},Mr=function(){var e=Rr();return e&&e.tinymce?e.tinymce:null},wr={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},Cr=window&&window.__assign||function(){return Cr=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Cr.apply(this,arguments)},xr=e.defineComponent({props:wr,setup:function(t,n){var o=e.toRefs(t),r=o.disabled,a=o.modelValue,i=e.ref(null),l=null,s=t.id||Tr("tiny-vue"),c=t.init&&t.init.inline||t.inline,u=!!n.attrs["onUpdate:modelValue"],d=!0,m=t.initialValue?t.initialValue:"",f="",_=function(){var e,o,r,_=(e=d,u?function(){return(null==a?void 0:a.value)?a.value:""}:function(){return e?m:f}),p=Cr(Cr({},t.init),{readonly:t.disabled,selector:"#"+s,plugins:(o=t.init&&t.init.plugins,r=t.plugins,Br(o).concat(Br(r))),toolbar:t.toolbar||t.init&&t.init.toolbar,inline:c,setup:function(e){l=e,e.on("init",(function(o){return kr(o,t,n,e,a,_)})),t.init&&"function"==typeof t.init.setup&&t.init.setup(e)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(i.value)&&(i.value.style.visibility=""),Mr().init(p),d=!1};return e.watch(r,(function(e){null!==l&&l.setMode(e?"readonly":"design")})),e.onMounted((function(){if(null!==Mr())_();else if(i.value&&i.value.ownerDocument){var e=t.cloudChannel?t.cloudChannel:"5",n=t.apiKey?t.apiKey:"no-api-key",o=null==t.tinymceScriptSrc?"https://cdn.tiny.cloud/1/"+n+"/tinymce/"+e+"/tinymce.min.js":t.tinymceScriptSrc;Ir.load(i.value.ownerDocument,o,_)}})),e.onBeforeUnmount((function(){null!==Mr()&&Mr().remove(l)})),c||(e.onActivated((function(){d||_()})),e.onDeactivated((function(){var e;u||(f=l.getContent()),null===(e=Mr())||void 0===e||e.remove(l)}))),function(){return c?(n=e.h,o=s,r=i,a=t.tagName,n(a||"div",{id:o,ref:r})):function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})}(e.h,s,i);var n,o,r,a}}}),Fr=xr,Nr=e.defineComponent({name:"Text",props:{model:{type:null,required:!0},isMultiline:{type:Boolean,required:!0},isRichText:{type:Boolean,required:!0},validationStatus:{type:null,required:!0},field:{type:String,required:!1,default:"text"}},components:{Editor:Fr},computed:{content:{get:function(){return this.model.value},set:function(e){this.store.commit(Xo.SET_TEXT_VALUE,{id:this.model.id,val:e})}}},setup:function(e){return{store:E(),field:e.field}}}),Dr={key:2},Vr=["type"];Nr.render=function(t,n,o,r,a,i){var l=e.resolveComponent("Editor");return t.isRichText?(e.openBlock(),e.createBlock(l,{key:0,apiKey:"0ohehg73era56wydy5kyws6ouf25550ogy2sifi1j41hk65l",modelValue:t.content,"onUpdate:modelValue":n[0]||(n[0]=function(e){return t.content=e}),placeholder:"add multiple lines"},null,8,["modelValue"])):t.isMultiline?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",{key:1,"onUpdate:modelValue":n[1]||(n[1]=function(e){return t.content=e})},null,512)),[[e.vModelText,t.content]]):(e.openBlock(),e.createElementBlock("div",Dr,["text"===t.field?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,type:"text","onUpdate:modelValue":n[2]||(n[2]=function(e){return t.content=e})},null,512)),[[e.vModelText,t.content]]):"decimal"===t.field?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,type:"number","onUpdate:modelValue":n[3]||(n[3]=function(e){return t.content=e}),step:"0.01",placeholder:"0.00"},null,512)),[[e.vModelText,t.content]]):e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:2,type:t.field,"onUpdate:modelValue":n[4]||(n[4]=function(e){return t.content=e})},null,8,Vr)),[[e.vModelDynamic,t.content]])]))};var Or=e.defineComponent({name:"DateField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!1}},components:{Text:Nr},setup:function(t){return{validationStatus:e.computed((function(){return ar(t.model,null)})),type:t.model.modelType}}});Or.render=function(t,n,o,r,a,i){var l,s,c=e.resolveComponent("Text");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l||null===(s=l.values)||void 0===s?void 0:s.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(c,{model:n,"is-multiline":!1,"is-rich-text":!1,"validation-status":t.validationStatus,field:"date"},null,8,["model","validation-status"])])})),256)};var Lr=e.defineComponent({name:"DecimalField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!1},numDecimalPlaces:{type:Number,required:!1,default:2}},components:{Text:Nr},setup:function(t){return{validationStatus:e.computed((function(){return ir(t.model)})),type:t.model.modelType}}});Lr.render=function(t,n,o,r,a,i){var l,s,c=e.resolveComponent("Text");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l||null===(s=l.values)||void 0===s?void 0:s.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(c,{model:n,"is-multiline":!1,"is-rich-text":!1,"validation-status":t.validationStatus,field:"decimal"},null,8,["model","validation-status"])])})),256)};var Pr=e.defineComponent({name:"EmailField",props:{model:{type:null,required:!0},isMultivalue:{type:Boolean,required:!1,default:!1}},components:{Text:Nr},setup:function(t){return{validationStatus:e.computed((function(){return ar(t.model,or.Email)})),type:t.model.modelType}}});Pr.render=function(t,n,o,r,a,i){var l,s,c=e.resolveComponent("Text");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l||null===(s=l.values)||void 0===s?void 0:s.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(c,{model:n,"is-multiline":!1,"is-rich-text":!1,"validation-status":t.validationStatus,field:"email"},null,8,["model","validation-status"])])})),256)};var Hr=e.defineComponent({name:"InfoField",props:{model:{type:null,required:!0}}}),Ur=["innerHTML"];Hr.render=function(t,n,o,r,a,i){var l,s;return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l||null===(s=l.content)||void 0===s?void 0:s.values,(function(t){return e.openBlock(),e.createElementBlock("div",{key:t.id},[e.createElementVNode("div",{innerHTML:t.value},null,8,Ur)])})),128)};var qr=e.defineComponent({name:"IntegerField",props:{model:{type:null,required:!0},isMultivalued:{type:Boolean,required:!1,default:!1}},components:{Text:Nr},setup:function(t){return{validationStatus:e.computed((function(){return ir(t.model)})),type:t.model.modelType}}});qr.render=function(t,n,o,r,a,i){var l,s,c=e.resolveComponent("Text");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l||null===(s=l.values)||void 0===s?void 0:s.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(c,{model:n,"is-multiline":!1,"is-rich-text":!1,"validation-status":t.validationStatus,field:"number"},null,8,["model","validation-status"])])})),256)};var Yr=e.defineComponent({name:"RadioField",props:{model:{type:Object,required:!0}},methods:{getSelectedFieldLabels:function(e){return yn.getSelectedFieldLabels(e.options.$values)},getConcatenatedOptionLabels:function(e){var t,n,o=null===(t=e.optionText)||void 0===t||null===(n=t.values)||void 0===n?void 0:n.$values.map((function(e){return e.value})).join(" / ");return o||""}},computed:{selected:{get:function(){var e;return null===(e=this.model.options.$values.find((function(e){return e.selected})))||void 0===e?void 0:e.id},set:function(e){var t=this;this.model.options.$values.forEach((function(n){t.store.commit(Xo.SET_OPTION_VALUE,{id:n.id,isSelected:n.id===e})}))}}},setup:function(t){var n=e.computed((function(){return lr(t.model)})),o="radio_"+t.model.id;return{store:E(),validationStatus:n,name:o}}}),Xr=["name","id","value"],jr=e.createTextVNode(),Gr=["for"];Yr.render=function(t,n,o,r,a,i){var l=this;return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.options.$values,(function(o){return e.openBlock(),e.createElementBlock("div",null,[e.withDirectives(e.createElementVNode("input",{type:"radio",name:t.name,id:o.id,value:o.id,"onUpdate:modelValue":n[0]||(n[0]=function(e){return t.selected=e})},null,8,Xr),[[e.vModelRadio,t.selected]]),jr,e.createElementVNode("label",{for:o.id},e.toDisplayString(l.getConcatenatedOptionLabels(o)),9,Gr)])})),256)};var $r=e.defineComponent({name:"SelectField",components:{},props:{model:{type:Object,required:!0}},methods:{getConcatenatedOptionLabels:function(e){var t,n,o=null===(t=e.optionText)||void 0===t||null===(n=t.values)||void 0===n?void 0:n.$values.map((function(e){return e.value})).join(" / ");return o||""}},computed:{selected:{get:function(){var e;return null===(e=this.model.options.$values.find((function(e){return e.selected})))||void 0===e?void 0:e.id},set:function(e){var t=this;this.model.options.$values.forEach((function(n){t.store.commit(Xo.SET_OPTION_VALUE,{id:n.id,isSelected:n.id===e})}))}}},setup:function(t){var n=e.computed((function(){return lr(t.model)}));return{store:E(),validationStatus:n}}}),zr=e.createElementVNode("option",{disabled:"",value:""},"Please select one",-1),Kr=["id","value"];$r.render=function(t,n,o,r,a,i){var l=this;return e.openBlock(),e.createElementBlock("div",null,[e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":n[0]||(n[0]=function(e){return t.selected=e}),class:"form-control col-md-6"},[zr,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.options.$values,(function(t){return e.openBlock(),e.createElementBlock("option",{id:t.id,value:t.id},e.toDisplayString(l.getConcatenatedOptionLabels(t)),9,Kr)})),256))],512),[[e.vModelSelect,t.selected]])])};var Wr=e.defineComponent({name:"TextCollection",props:{model:{type:null,required:!0},isMultiline:{type:Boolean,required:!0},isRichText:{type:Boolean,required:!0},validationStatus:{type:null,required:!0}},components:{Text:Nr}}),Qr={key:0};Wr.render=function(t,n,o,r,a,i){var l,s,c=e.resolveComponent("Text");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model)||void 0===l||null===(s=l.values)||void 0===s?void 0:s.$values,(function(n){var o,r,a;return e.openBlock(),e.createElementBlock("div",null,[(null===(o=t.model)||void 0===o||null===(r=o.values)||void 0===r||null===(a=r.$values)||void 0===a?void 0:a.length)>1?(e.openBlock(),e.createElementBlock("span",Qr,e.toDisplayString(n.language)+": ",1)):e.createCommentVNode("",!0),e.createVNode(c,{model:n,"is-multiline":t.isMultiline,"is-rich-text":t.isRichText,"validation-status":t.validationStatus},null,8,["model","is-multiline","is-rich-text","validation-status"])])})),256)};var Zr=e.defineComponent({name:"MultilingualTextField",props:{model:{type:null,required:!0},isMultiline:{type:Boolean,required:!0}},components:{TextCollection:Wr},setup:function(t){var n=E(),o=t.model.modelType,r=e.computed((function(){return rr(t.model)}));return{store:n,type:o,isRichText:e.computed((function(){return!(null==(e=t.model)||!e.richText)&&e.richText;var e})),validationStatus:r,isRequiredField:e.computed((function(){return!(null==(e=t.model)||!e.required)&&e.required;var e}))}},methods:{addText:function(e,t){e.commit(Xo.APPEND_MULTILINGUAL_VALUE,t)}}});function Jr(){function e(e){return new Int8Array(e)}function t(e){return new Int32Array(e)}function n(e){return new Float32Array(e)}function o(e){if(1==e.length)return n(e[0]);var t=e[0];e=e.slice(1);for(var r=[],a=0;a<t;a++)r.push(o(e));return r}function r(e){if(1==e.length)return t(e[0]);var n=e[0];e=e.slice(1);for(var o=[],a=0;a<n;a++)o.push(r(e));return o}function a(e){if(1==e.length)return function(e){return new Int16Array(e)}(e[0]);var t=e[0];e=e.slice(1);for(var n=[],o=0;o<t;o++)n.push(a(e));return n}function i(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],o=0;o<t;o++)n.push(i(e));return n}var l={fill:function(e,t,n,o){if(2==arguments.length)for(var r=0;r<e.length;r++)e[r]=arguments[1];else for(r=t;r<n;r++)e[r]=o}},s={arraycopy:function(e,t,n,o,r){for(var a=t+r;t<a;)n[o++]=e[t++]}},c={};function u(e){this.ordinal=e}c.SQRT2=1.4142135623730951,c.FAST_LOG10=function(e){return Math.log10(e)},c.FAST_LOG10_X=function(e,t){return Math.log10(e)*t},u.short_block_allowed=new u(0),u.short_block_coupled=new u(1),u.short_block_dispensed=new u(2),u.short_block_forced=new u(3);var d={};function m(e){this.ordinal=e}function f(e){var t=e;this.ordinal=function(){return t}}function _(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}function p(){var e=p.RMS_WINDOW_TIME_NUMERATOR,t=p.RMS_WINDOW_TIME_DENOMINATOR,n=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],o=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function r(e,t,n,o,r,a){for(;0!=r--;)n[o]=1e-10+e[t+0]*a[0]-n[o-1]*a[1]+e[t-1]*a[2]-n[o-2]*a[3]+e[t-2]*a[4]-n[o-3]*a[5]+e[t-3]*a[6]-n[o-4]*a[7]+e[t-4]*a[8]-n[o-5]*a[9]+e[t-5]*a[10]-n[o-6]*a[11]+e[t-6]*a[12]-n[o-7]*a[13]+e[t-7]*a[14]-n[o-8]*a[15]+e[t-8]*a[16]-n[o-9]*a[17]+e[t-9]*a[18]-n[o-10]*a[19]+e[t-10]*a[20],++o,++t}function a(e,t,n,o,r,a){for(;0!=r--;)n[o]=e[t+0]*a[0]-n[o-1]*a[1]+e[t-1]*a[2]-n[o-2]*a[3]+e[t-2]*a[4],++o,++t}function i(e){return e*e}this.InitGainAnalysis=function(n,o){return function(n,o){for(var r=0;r<MAX_ORDER;r++)n.linprebuf[r]=n.lstepbuf[r]=n.loutbuf[r]=n.rinprebuf[r]=n.rstepbuf[r]=n.routbuf[r]=0;switch(0|o){case 48e3:n.reqindex=0;break;case 44100:n.reqindex=1;break;case 32e3:n.reqindex=2;break;case 24e3:n.reqindex=3;break;case 22050:n.reqindex=4;break;case 16e3:n.reqindex=5;break;case 12e3:n.reqindex=6;break;case 11025:n.reqindex=7;break;case 8e3:n.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return n.sampleWindow=0|(o*e+t-1)/t,n.lsum=0,n.rsum=0,n.totsamp=0,l.ill(n.A,0),INIT_GAIN_ANALYSIS_OK}(n,o)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(n.linpre=MAX_ORDER,n.rinpre=MAX_ORDER,n.lstep=MAX_ORDER,n.rstep=MAX_ORDER,n.lout=MAX_ORDER,n.rout=MAX_ORDER,l.fill(n.B,0),INIT_GAIN_ANALYSIS_OK)},this.AnalyzeSamples=function(e,t,l,c,u,d,m){var f,_,h,v,b,g,E;if(0==d)return GAIN_ANALYSIS_OK;switch(E=0,b=d,m){case 1:c=t,u=l;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(d<MAX_ORDER?(s.arraycopy(t,l,e.linprebuf,MAX_ORDER,d),s.arraycopy(c,u,e.rinprebuf,MAX_ORDER,d)):(s.arraycopy(t,l,e.linprebuf,MAX_ORDER,MAX_ORDER),s.arraycopy(c,u,e.rinprebuf,MAX_ORDER,MAX_ORDER));b>0;){g=b>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:b,E<MAX_ORDER?(f=e.linpre+E,_=e.linprebuf,h=e.rinpre+E,v=e.rinprebuf,g>MAX_ORDER-E&&(g=MAX_ORDER-E)):(f=l+E,_=t,h=u+E,v=c),r(_,f,e.lstepbuf,e.lstep+e.totsamp,g,n[e.reqindex]),r(v,h,e.rstepbuf,e.rstep+e.totsamp,g,n[e.reqindex]),a(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,g,o[e.reqindex]),a(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,g,o[e.reqindex]),f=e.lout+e.totsamp,_=e.loutbuf,h=e.rout+e.totsamp,v=e.routbuf;for(var S=g%8;0!=S--;)e.lsum+=i(_[f++]),e.rsum+=i(v[h++]);for(S=g/8;0!=S--;)e.lsum+=i(_[f+0])+i(_[f+1])+i(_[f+2])+i(_[f+3])+i(_[f+4])+i(_[f+5])+i(_[f+6])+i(_[f+7]),f+=8,e.rsum+=i(v[h+0])+i(v[h+1])+i(v[h+2])+i(v[h+3])+i(v[h+4])+i(v[h+5])+i(v[h+6])+i(v[h+7]),h+=8;if(b-=g,E+=g,e.totsamp+=g,e.totsamp==e.sampleWindow){var k=10*p.STEPS_per_dB*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),y=k<=0?0:0|k;y>=e.A.length&&(y=e.A.length-1),e.A[y]++,e.lsum=e.rsum=0,s.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),s.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),s.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),s.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return d<MAX_ORDER?(s.arraycopy(e.linprebuf,d,e.linprebuf,0,MAX_ORDER-d),s.arraycopy(e.rinprebuf,d,e.rinprebuf,0,MAX_ORDER-d),s.arraycopy(t,l,e.linprebuf,MAX_ORDER-d,d),s.arraycopy(c,u,e.rinprebuf,MAX_ORDER-d,d)):(s.arraycopy(t,l+d-MAX_ORDER,e.linprebuf,0,MAX_ORDER),s.arraycopy(c,u+d-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK},this.GetTitleGain=function(e){for(var t=function(e,t){var n,o=0;for(n=0;n<t;n++)o+=e[n];if(0==o)return GAIN_NOT_ENOUGH_SAMPLES;var r=0|Math.ceil(o*(1-.95));for(n=t;n-- >0&&!((r-=e[n])<=0););return 64.82-n/p.STEPS_per_dB}(e.A,e.A.length),n=0;n<e.A.length;n++)e.B[n]+=e.A[n],e.A[n]=0;for(n=0;n<MAX_ORDER;n++)e.linprebuf[n]=e.lstepbuf[n]=e.loutbuf[n]=e.rinprebuf[n]=e.rstepbuf[n]=e.routbuf[n]=0;return e.totsamp=0,e.lsum=e.rsum=0,t}}function h(){function e(e,t,n,o,r,a,i,l,s,c,u,d,m,f,_){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=n,this.expY=o,this.st_lrm=r,this.st_s=a,this.masking_adj=i,this.masking_adj_short=l,this.ath_lower=s,this.ath_curve=c,this.ath_sensitivity=u,this.interch=d,this.safejoint=m,this.sfb21mod=f,this.msfix=_}function t(e,t,n,o,r,a,i,l,s,c,u,d,m,f){this.quant_comp=t,this.quant_comp_s=n,this.safejoint=o,this.nsmsfix=r,this.st_lrm=a,this.st_s=i,this.nsbass=l,this.scale=s,this.masking_adj=c,this.ath_lower=u,this.ath_curve=d,this.interch=m,this.sfscale=f}var n;this.setModules=function(e){n=e};var o=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],r=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function a(e,t,n){var a=e.VBR==m.vbr_rh?o:r,i=e.VBR_q_frac,l=a[t],s=a[t+1],c=l;l.st_lrm=l.st_lrm+i*(s.st_lrm-l.st_lrm),l.st_s=l.st_s+i*(s.st_s-l.st_s),l.masking_adj=l.masking_adj+i*(s.masking_adj-l.masking_adj),l.masking_adj_short=l.masking_adj_short+i*(s.masking_adj_short-l.masking_adj_short),l.ath_lower=l.ath_lower+i*(s.ath_lower-l.ath_lower),l.ath_curve=l.ath_curve+i*(s.ath_curve-l.ath_curve),l.ath_sensitivity=l.ath_sensitivity+i*(s.ath_sensitivity-l.ath_sensitivity),l.interch=l.interch+i*(s.interch-l.interch),l.msfix=l.msfix+i*(s.msfix-l.msfix),function(e,t){0>t&&(t=0),9<t&&(t=9),e.VBR_q=t,e.VBR_q_frac=0}(e,c.vbr_q),0!=n?e.quant_comp=c.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=c.quant_comp),0!=n?e.quant_comp_short=c.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=c.quant_comp_s),0!=c.expY&&(e.experimentalY=0!=c.expY),0!=n?e.internal_flags.nsPsy.attackthre=c.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=c.st_lrm),0!=n?e.internal_flags.nsPsy.attackthre_s=c.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=c.st_s),0!=n?e.maskingadjust=c.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=c.masking_adj),0!=n?e.maskingadjust_short=c.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=c.masking_adj_short),0!=n?e.ATHlower=-c.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-c.ath_lower/10),0!=n?e.ATHcurve=c.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=c.ath_curve),0!=n?e.athaa_sensitivity=c.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=c.ath_sensitivity),c.interch>0&&(0!=n?e.interChRatio=c.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=c.interch)),c.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|c.safejoint),c.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|c.sfb21mod<<20),0!=n?e.msfix=c.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=c.msfix),0==n&&(e.VBR_q=t,e.VBR_q_frac=i)}var i=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(e,t,o){var r=t,a=n.nearestBitrateFullIndex(t);if(e.VBR=m.vbr_abr,e.VBR_mean_bitrate_kbps=r,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),i[a].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),i[a].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(i[a].nsbass)>0){var l=int(4*i[a].nsbass);l<0&&(l+=64),e.exp_nspsytune=e.exp_nspsytune|l<<2}return 0!=o?e.quant_comp=i[a].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=i[a].quant_comp),0!=o?e.quant_comp_short=i[a].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=i[a].quant_comp_s),0!=o?e.msfix=i[a].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=i[a].nsmsfix),0!=o?e.internal_flags.nsPsy.attackthre=i[a].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=i[a].st_lrm),0!=o?e.internal_flags.nsPsy.attackthre_s=i[a].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=i[a].st_s),0!=o?e.scale=i[a].scale:Math.abs(e.scale- -1)>0||(e.scale=i[a].scale),0!=o?e.maskingadjust=i[a].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=i[a].masking_adj),i[a].masking_adj>0?0!=o?e.maskingadjust_short=.9*i[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*i[a].masking_adj):0!=o?e.maskingadjust_short=1.1*i[a].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*i[a].masking_adj),0!=o?e.ATHlower=-i[a].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-i[a].ath_lower/10),0!=o?e.ATHcurve=i[a].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=i[a].ath_curve),0!=o?e.interChRatio=i[a].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=i[a].interch),t}this.apply_preset=function(e,t,n){switch(t){case G.R3MIX:t=G.V3,e.VBR=m.vbr_mtrh;break;case G.MEDIUM:t=G.V4,e.VBR=m.vbr_rh;break;case G.MEDIUM_FAST:t=G.V4,e.VBR=m.vbr_mtrh;break;case G.STANDARD:t=G.V2,e.VBR=m.vbr_rh;break;case G.STANDARD_FAST:t=G.V2,e.VBR=m.vbr_mtrh;break;case G.EXTREME:t=G.V0,e.VBR=m.vbr_rh;break;case G.EXTREME_FAST:t=G.V0,e.VBR=m.vbr_mtrh;break;case G.INSANE:return t=320,e.preset=t,l(e,t,n),e.VBR=m.vbr_off,t}switch(e.preset=t,t){case G.V9:return a(e,9,n),t;case G.V8:return a(e,8,n),t;case G.V7:return a(e,7,n),t;case G.V6:return a(e,6,n),t;case G.V5:return a(e,5,n),t;case G.V4:return a(e,4,n),t;case G.V3:return a(e,3,n),t;case G.V2:return a(e,2,n),t;case G.V1:return a(e,1,n),t;case G.V0:return a(e,0,n),t}return 8<=t&&t<=320?l(e,t,n):(e.preset=0,t)}}function v(){var e=null;function n(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var o=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function r(e,t,n,o,r,a){var i=.5946/t;for(e>>=1;0!=e--;)r[a++]=i>n[o++]?0:1,r[a++]=i>n[o++]?0:1}function a(t,n,o,r,a,i){var l=(t>>=1)%2;for(t>>=1;0!=t--;){var s,c,u,d,m,f,_,p;s=o[r++]*n,c=o[r++]*n,m=0|s,u=o[r++]*n,f=0|c,d=o[r++]*n,_=0|u,s+=e.adj43[m],p=0|d,c+=e.adj43[f],a[i++]=0|s,u+=e.adj43[_],a[i++]=0|c,d+=e.adj43[p],a[i++]=0|u,a[i++]=0|d}0!=l&&(m=0|(s=o[r++]*n),f=0|(c=o[r++]*n),s+=e.adj43[m],c+=e.adj43[f],a[i++]=0|s,a[i++]=0|c)}var i=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function c(e,t,n,o){var r=function(e,t,n){var o=0,r=0;do{var a=e[t++],i=e[t++];o<a&&(o=a),r<i&&(r=i)}while(t<n);return o<r&&(o=r),o}(e,t,n);switch(r){case 0:return r;case 1:return function(e,t,n,o){var r=0,a=k.ht[1].hlen;do{var i=2*e[t+0]+e[t+1];t+=2,r+=a[i]}while(t<n);return o.bits+=r,1}(e,t,n,o);case 2:case 3:return function(e,t,n,o,r){var a,i,l=0,s=k.ht[o].xlen;i=2==o?k.table23:k.table56;do{var c=e[t+0]*s+e[t+1];t+=2,l+=i[c]}while(t<n);return a=65535&l,(l>>=16)>a&&(l=a,o++),r.bits+=l,o}(e,t,n,i[r-1],o);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(e,t,n,o,r){var a=0,i=0,l=0,s=k.ht[o].xlen,c=k.ht[o].hlen,u=k.ht[o+1].hlen,d=k.ht[o+2].hlen;do{var m=e[t+0]*s+e[t+1];t+=2,a+=c[m],i+=u[m],l+=d[m]}while(t<n);var f=o;return a>i&&(a=i,f++),a>l&&(a=l,f=o+2),r.bits+=a,f}(e,t,n,i[r-1],o);default:if(r>C.IXMAX_VAL)return o.bits=C.LARGE_BITS,-1;var a,l;for(r-=15,a=24;a<32&&!(k.ht[a].linmax>=r);a++);for(l=a-8;l<24&&!(k.ht[l].linmax>=r);l++);return function(e,t,n,o,r,a){var i,l=65536*k.ht[o].xlen+k.ht[r].xlen,s=0;do{var c=e[t++],u=e[t++];0!=c&&(c>14&&(c=15,s+=l),c*=16),0!=u&&(u>14&&(u=15,s+=l),c+=u),s+=k.largetbl[c]}while(t<n);return i=65535&s,(s>>=16)>i&&(s=i,o=r),a.bits+=s,o}(e,t,n,l,a,o)}}function u(e,t,o,r,a,i,l,s){for(var u=t.big_values,d=2;d<L.SBMAX_l+1;d++){var m=e.scalefac_band.l[d];if(m>=u)break;var f=a[d-2]+t.count1bits;if(o.part2_3_length<=f)break;var _=new n(f),p=c(r,m,u,_);f=_.bits,o.part2_3_length<=f||(o.assign(t),o.part2_3_length=f,o.region0_count=i[d-2],o.region1_count=d-2-i[d-2],o.table_select[0]=l[d-2],o.table_select[1]=s[d-2],o.table_select[2]=p)}}this.noquant_count_bits=function(e,t,o){var r=t.l3_enc,a=Math.min(576,t.max_nonzero_coeff+2>>1<<1);for(null!=o&&(o.sfb_count1=0);a>1&&0==(r[a-1]|r[a-2]);a-=2);t.count1=a;for(var i=0,l=0;a>3;a-=4){var s;if((2147483647&(r[a-1]|r[a-2]|r[a-3]|r[a-4]))>1)break;s=2*(2*(2*r[a-4]+r[a-3])+r[a-2])+r[a-1],i+=k.t32l[s],l+=k.t33l[s]}var u=i;if(t.count1table_select=0,i>l&&(u=l,t.count1table_select=1),t.count1bits=u,t.big_values=a,0==a)return u;if(t.block_type==L.SHORT_TYPE)(i=3*e.scalefac_band.s[3])>t.big_values&&(i=t.big_values),l=t.big_values;else if(t.block_type==L.NORM_TYPE){if(i=t.region0_count=e.bv_scf[a-2],l=t.region1_count=e.bv_scf[a-1],l=e.scalefac_band.l[i+l+2],i=e.scalefac_band.l[i+1],l<a){var d=new n(u);t.table_select[2]=c(r,l,a,d),u=d.bits}}else t.region0_count=7,t.region1_count=L.SBMAX_l-1-7-1,(i=e.scalefac_band.l[8])>(l=a)&&(i=l);if(i=Math.min(i,a),l=Math.min(l,a),0<i&&(d=new n(u),t.table_select[0]=c(r,0,i,d),u=d.bits),i<l&&(d=new n(u),t.table_select[1]=c(r,i,l,d),u=d.bits),2==e.use_best_huffman&&(t.part2_3_length=u,best_huffman_divide(e,t),u=t.part2_3_length),null!=o&&t.block_type==L.NORM_TYPE){for(var m=0;e.scalefac_band.l[m]<t.big_values;)m++;o.sfb_count1=m}return u},this.count_bits=function(t,n,o,i){var s=o.l3_enc,c=C.IXMAX_VAL/e.IPOW20(o.global_gain);if(o.xrpow_max>c)return C.LARGE_BITS;if(function(t,n,o,i,s){var c,u,d,m=0,f=0,_=0,p=0,h=n,v=0,b=h,g=0,E=t,S=0;for(d=null!=s&&i.global_gain==s.global_gain,u=i.block_type==L.SHORT_TYPE?38:21,c=0;c<=u;c++){var k=-1;if((d||i.block_type==L.NORM_TYPE)&&(k=i.global_gain-(i.scalefac[c]+(0!=i.preflag?e.pretab[c]:0)<<i.scalefac_scale+1)-8*i.subblock_gain[i.window[c]]),d&&s.step[c]==k)0!=f&&(a(f,o,E,S,b,g),f=0),0!=_&&(r(_,o,E,S,b,g),_=0);else{var y,T=i.width[c];if(m+i.width[c]>i.max_nonzero_coeff&&(y=i.max_nonzero_coeff-m+1,l.fill(n,i.max_nonzero_coeff,576,0),(T=y)<0&&(T=0),c=u+1),0==f&&0==_&&(b=h,g=v,E=t,S=p),null!=s&&s.sfb_count1>0&&c>=s.sfb_count1&&s.step[c]>0&&k>=s.step[c]?(0!=f&&(a(f,o,E,S,b,g),f=0,b=h,g=v,E=t,S=p),_+=T):(0!=_&&(r(_,o,E,S,b,g),_=0,b=h,g=v,E=t,S=p),f+=T),T<=0){0!=_&&(r(_,o,E,S,b,g),_=0),0!=f&&(a(f,o,E,S,b,g),f=0);break}}c<=u&&(v+=i.width[c],p+=i.width[c],m+=i.width[c])}0!=f&&(a(f,o,E,S,b,g),f=0),0!=_&&(r(_,o,E,S,b,g),_=0)}(n,s,e.IPOW20(o.global_gain),o,i),0!=(2&t.substep_shaping))for(var u=0,d=o.global_gain+o.scalefac_scale,m=.634521682242439/e.IPOW20(d),f=0;f<o.sfbmax;f++){var _,p=o.width[f];if(0==t.pseudohalf[f])u+=p;else for(_=u,u+=p;_<u;++_)s[_]=n[_]>=m?s[_]:0}return this.noquant_count_bits(t,o,i)},this.best_huffman_divide=function(e,o){var r=new F,a=o.l3_enc,i=t(23),l=t(23),s=t(23),d=t(23);if(o.block_type!=L.SHORT_TYPE||1!=e.mode_gr){r.assign(o),o.block_type==L.NORM_TYPE&&(function(e,t,o,r,a,i,l){for(var s=t.big_values,u=0;u<=22;u++)r[u]=C.LARGE_BITS;for(u=0;u<16;u++){var d=e.scalefac_band.l[u+1];if(d>=s)break;var m=0,f=new n(m),_=c(o,0,d,f);m=f.bits;for(var p=0;p<8;p++){var h=e.scalefac_band.l[u+p+2];if(h>=s)break;var v=m,b=c(o,d,h,f=new n(v));v=f.bits,r[u+p]>v&&(r[u+p]=v,a[u+p]=u,i[u+p]=_,l[u+p]=b)}}}(e,o,a,i,l,s,d),u(e,r,o,a,i,l,s,d));var m=r.big_values;if(!(0==m||(a[m-2]|a[m-1])>1||(m=o.count1+2)>576)){r.assign(o),r.count1=m;for(var f=0,_=0;m>r.big_values;m-=4){var p=2*(2*(2*a[m-4]+a[m-3])+a[m-2])+a[m-1];f+=k.t32l[p],_+=k.t33l[p]}if(r.big_values=m,r.count1table_select=0,f>_&&(f=_,r.count1table_select=1),r.count1bits=f,r.block_type==L.NORM_TYPE)u(e,r,o,a,i,l,s,d);else{if(r.part2_3_length=f,(f=e.scalefac_band.l[8])>m&&(f=m),f>0){var h=new n(r.part2_3_length);r.table_select[0]=c(a,0,f,h),r.part2_3_length=h.bits}m>f&&(h=new n(r.part2_3_length),r.table_select[1]=c(a,f,m,h),r.part2_3_length=h.bits),o.part2_3_length>r.part2_3_length&&o.assign(r)}}}};var d=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],m=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],f=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],_=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];v.slen1_tab=f,v.slen2_tab=_,this.best_scalefac_store=function(t,n,o,r){var a,i,l,s,c=r.tt[n][o],u=0;for(l=0,a=0;a<c.sfbmax;a++){var p=c.width[a];for(l+=p,s=-p;s<0&&0==c.l3_enc[s+l];s++);0==s&&(c.scalefac[a]=u=-2)}if(0==c.scalefac_scale&&0==c.preflag){var h=0;for(a=0;a<c.sfbmax;a++)c.scalefac[a]>0&&(h|=c.scalefac[a]);if(0==(1&h)&&0!=h){for(a=0;a<c.sfbmax;a++)c.scalefac[a]>0&&(c.scalefac[a]>>=1);c.scalefac_scale=u=1}}if(0==c.preflag&&c.block_type!=L.SHORT_TYPE&&2==t.mode_gr){for(a=11;a<L.SBPSY_l&&!(c.scalefac[a]<e.pretab[a]&&-2!=c.scalefac[a]);a++);if(a==L.SBPSY_l){for(a=11;a<L.SBPSY_l;a++)c.scalefac[a]>0&&(c.scalefac[a]-=e.pretab[a]);c.preflag=u=1}}for(i=0;i<4;i++)r.scfsi[o][i]=0;for(2==t.mode_gr&&1==n&&r.tt[0][o].block_type!=L.SHORT_TYPE&&r.tt[1][o].block_type!=L.SHORT_TYPE&&(function(e,t){for(var n,o=t.tt[1][e],r=t.tt[0][e],a=0;a<k.scfsi_band.length-1;a++){for(n=k.scfsi_band[a];n<k.scfsi_band[a+1]&&!(r.scalefac[n]!=o.scalefac[n]&&o.scalefac[n]>=0);n++);if(n==k.scfsi_band[a+1]){for(n=k.scfsi_band[a];n<k.scfsi_band[a+1];n++)o.scalefac[n]=-1;t.scfsi[e][a]=1}}var i=0,l=0;for(n=0;n<11;n++)-1!=o.scalefac[n]&&(l++,i<o.scalefac[n]&&(i=o.scalefac[n]));for(var s=0,c=0;n<L.SBPSY_l;n++)-1!=o.scalefac[n]&&(c++,s<o.scalefac[n]&&(s=o.scalefac[n]));for(a=0;a<16;a++)if(i<d[a]&&s<m[a]){var u=f[a]*l+_[a]*c;o.part2_length>u&&(o.part2_length=u,o.scalefac_compress=a)}}(o,r),u=0),a=0;a<c.sfbmax;a++)-2==c.scalefac[a]&&(c.scalefac[a]=0);0!=u&&(2==t.mode_gr?this.scale_bitcount(c):this.scale_bitcount_lsf(t,c))};var p=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],h=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],b=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var n,o,r,a=0,i=0,l=t.scalefac;if(t.block_type==L.SHORT_TYPE)r=p,0!=t.mixed_block_flag&&(r=h);else if(r=b,0==t.preflag){for(o=11;o<L.SBPSY_l&&!(l[o]<e.pretab[o]);o++);if(o==L.SBPSY_l)for(t.preflag=1,o=11;o<L.SBPSY_l;o++)l[o]-=e.pretab[o]}for(o=0;o<t.sfbdivide;o++)a<l[o]&&(a=l[o]);for(;o<t.sfbmax;o++)i<l[o]&&(i=l[o]);for(t.part2_length=C.LARGE_BITS,n=0;n<16;n++)a<d[n]&&i<m[n]&&t.part2_length>r[n]&&(t.part2_length=r[n],t.scalefac_compress=n);return t.part2_length==C.LARGE_BITS};var g=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(n,o){var r,a,i,l,c,u,d,m,f=t(4),_=o.scalefac;for(r=0!=o.preflag?2:0,d=0;d<4;d++)f[d]=0;if(o.block_type==L.SHORT_TYPE){a=1;var p=e.nr_of_sfb_block[r][a];for(m=0,i=0;i<4;i++)for(l=p[i]/3,d=0;d<l;d++,m++)for(c=0;c<3;c++)_[3*m+c]>f[i]&&(f[i]=_[3*m+c])}else for(a=0,p=e.nr_of_sfb_block[r][a],m=0,i=0;i<4;i++)for(l=p[i],d=0;d<l;d++,m++)_[m]>f[i]&&(f[i]=_[m]);for(u=!1,i=0;i<4;i++)f[i]>g[r][i]&&(u=!0);if(!u){var h,v,b,S;for(o.sfb_partition_table=e.nr_of_sfb_block[r][a],i=0;i<4;i++)o.slen[i]=E[f[i]];switch(h=o.slen[0],v=o.slen[1],b=o.slen[2],S=o.slen[3],r){case 0:o.scalefac_compress=(5*h+v<<4)+(b<<2)+S;break;case 1:o.scalefac_compress=400+(5*h+v<<2)+b;break;case 2:o.scalefac_compress=500+3*h+v;break;default:s.err.printf("intensity stereo not implemented yet\n")}}if(!u)for(o.part2_length=0,i=0;i<4;i++)o.part2_length+=o.slen[i]*o.sfb_partition_table[i];return u};var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){for(var n,r=0;e.scalefac_band.l[++r]<t;);for(n=o[r][0];e.scalefac_band.l[n+1]>t;)n--;for(n<0&&(n=o[r][0]),e.bv_scf[t-2]=n,n=o[r][1];e.scalefac_band.l[n+e.bv_scf[t-2]+2]>t;)n--;n<0&&(n=o[r][1]),e.bv_scf[t-1]=n}}}function b(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var o,r=t.internal_flags,a=r.l3_side,i=e.getframebits(t);n.bits=(i-8*r.sideinfo_len)/r.mode_gr;var l=2048*r.mode_gr-8;t.brate>320?o=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(o=11520,t.strict_ISO&&(o=8*int(32e4/(t.out_samplerate/1152)/8+.5))),r.ResvMax=o-i,r.ResvMax>l&&(r.ResvMax=l),(r.ResvMax<0||t.disable_reservoir)&&(r.ResvMax=0);var s=n.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return s>o&&(s=o),a.resvDrain_pre=0,null!=r.pinfo&&(r.pinfo.mean_bits=n.bits/2,r.pinfo.resvsize=r.ResvSize),s},this.ResvMaxBits=function(e,t,n,o){var r,a=e.internal_flags,i=a.ResvSize,l=a.ResvMax;0!=o&&(i+=t),0!=(1&a.substep_shaping)&&(l*=.9),n.bits=t,10*i>9*l?(r=i-9*l/10,n.bits+=r,a.substep_shaping|=128):(r=0,a.substep_shaping&=127,e.disable_reservoir||0!=(1&a.substep_shaping)||(n.bits-=.1*t));var s=i<6*a.ResvMax/10?i:6*a.ResvMax/10;return(s-=r)<0&&(s=0),s},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var n,o=e.l3_side;e.ResvSize+=t*e.mode_gr;var r=0;o.resvDrain_post=0,o.resvDrain_pre=0,0!=(n=e.ResvSize%8)&&(r+=n),(n=e.ResvSize-r-e.ResvMax)>0&&(r+=n);var a=Math.min(8*o.main_data_begin,r)/8;o.resvDrain_pre+=8*a,r-=8*a,e.ResvSize-=8*a,o.main_data_begin-=a,o.resvDrain_post+=r,e.ResvSize-=r}}function g(){var n=this,r=null,a=null,i=null,c=null;this.setModules=function(e,t,n,o){r=e,a=t,i=n,c=o};var u=null,d=0,m=0,f=0;function _(e){s.arraycopy(e.header[e.w_ptr].buf,0,u,m,e.sideinfo_len),m+=e.sideinfo_len,d+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&Y.MAX_HEADER_BUF-1}function h(e,t,n){for(;n>0;){var o;0==f&&(f=8,m++,e.header[e.w_ptr].write_timing==d&&_(e),u[m]=0),n-=o=Math.min(n,f),f-=o,u[m]|=t>>n<<f,d+=o}}function b(e,t,n){for(;n>0;){var o;0==f&&(f=8,u[++m]=0),n-=o=Math.min(n,f),f-=o,u[m]|=t>>n<<f,d+=o}}function g(e,t){var n,o=e.internal_flags;if(t>=8&&(h(o,76,8),t-=8),t>=8&&(h(o,65,8),t-=8),t>=8&&(h(o,77,8),t-=8),t>=8&&(h(o,69,8),t-=8),t>=32){var r=i.getLameShortVersion();if(t>=32)for(n=0;n<r.length&&t>=8;++n)t-=8,h(o,r.charAt(n),8)}for(;t>=1;t-=1)h(o,o.ancillary_flag,1),o.ancillary_flag^=e.disable_reservoir?0:1}function E(e,t,n){for(var o=e.header[e.h_ptr].ptr;n>0;){var r=Math.min(n,8-(7&o));n-=r,e.header[e.h_ptr].buf[o>>3]|=t>>n<<8-(7&o)-r,o+=r}e.header[e.h_ptr].ptr=o}function S(e,t){e<<=8;for(var n=0;n<8;n++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=32773);return t}function y(e,t){var n,o=k.ht[t.count1table_select+32],r=0,a=t.big_values,i=t.big_values;for(n=(t.count1-t.big_values)/4;n>0;--n){var l=0,s=0;0!=t.l3_enc[a+0]&&(s+=8,t.xr[i+0]<0&&l++),0!=t.l3_enc[a+1]&&(s+=4,l*=2,t.xr[i+1]<0&&l++),0!=t.l3_enc[a+2]&&(s+=2,l*=2,t.xr[i+2]<0&&l++),0!=t.l3_enc[a+3]&&(s++,l*=2,t.xr[i+3]<0&&l++),a+=4,i+=4,h(e,l+o.table[s],o.hlen[s]),r+=o.hlen[s]}return r}function T(e,t,n,o,r){var a=k.ht[t],i=0;if(0==t)return i;for(var l=n;l<o;l+=2){var s=0,c=0,u=a.xlen,d=a.xlen,m=0,f=r.l3_enc[l],_=r.l3_enc[l+1];0!=f&&(r.xr[l]<0&&m++,s--),t>15&&(f>14&&(m|=f-15<<1,c=u,f=15),_>14&&(m<<=u,m|=_-15,c+=u,_=15),d=16),0!=_&&(m<<=1,r.xr[l+1]<0&&m++,s--),f=f*d+_,c-=s,s+=a.hlen[f],h(e,a.table[f],s),h(e,m,c),i+=s+c}return i}function B(e,t){var n=3*e.scalefac_band.s[3];return n>t.big_values&&(n=t.big_values),T(e,t.table_select[0],0,n,t)+T(e,t.table_select[1],n,t.big_values,t)}function A(e,t){var n,o,r,a;n=t.big_values;var i=t.region0_count+1;return r=e.scalefac_band.l[i],i+=t.region1_count+1,r>n&&(r=n),(a=e.scalefac_band.l[i])>n&&(a=n),o=T(e,t.table_select[0],0,r,t),(o+=T(e,t.table_select[1],r,a,t))+T(e,t.table_select[2],a,n,t)}function I(){this.total=0}function R(e,t){var o,r,a,i,l,c=e.internal_flags;return l=c.w_ptr,-1==(i=c.h_ptr-1)&&(i=Y.MAX_HEADER_BUF-1),o=c.header[i].write_timing-d,t.total=o,o>=0&&(r=1+i-l,i<l&&(r=1+i-l+Y.MAX_HEADER_BUF),o-=8*r*c.sideinfo_len),o+=a=n.getframebits(e),t.total+=a,t.total%8!=0?t.total=1+t.total/8:t.total=t.total/8,t.total+=m+1,o<0&&s.err.println("strange error flushing buffer ... \n"),o}this.getframebits=function(e){var t,n=e.internal_flags;return t=0!=n.bitrate_index?k.bitrate_table[e.version][n.bitrate_index]:e.brate,8*(0|72e3*(e.version+1)*t/e.out_samplerate+n.padding)},this.CRC_writeheader=function(e,t){var n=65535;n=S(255&t[2],n),n=S(255&t[3],n);for(var o=6;o<e.sideinfo_len;o++)n=S(255&t[o],n);t[4]=byte(n>>8),t[5]=byte(255&n)},this.flush_bitstream=function(e){var t,n,o=e.internal_flags;if(o.h_ptr,t=o.l3_side,!((n=R(e,new I))<0)){if(g(e,n),o.ResvSize=0,t.main_data_begin=0,o.findReplayGain){var a=r.GetTitleGain(o.rgdata);o.RadioGain=0|Math.floor(10*a+.5)}o.findPeakSample&&(o.noclipGainChange=0|Math.ceil(20*Math.log10(o.PeakSample/32767)*10),o.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?o.noclipScale=Math.floor(32767/o.PeakSample*100)/100:o.noclipScale=-1)}},this.add_dummy_byte=function(e,t,n){for(var o,r=e.internal_flags;n-- >0;)for(b(0,t,8),o=0;o<Y.MAX_HEADER_BUF;++o)r.header[o].write_timing+=8},this.format_bitstream=function(e){var t,n=e.internal_flags;t=n.l3_side;var o=this.getframebits(e);g(e,t.resvDrain_pre),function(e,t){var n,o,r,a=e.internal_flags;if(n=a.l3_side,a.header[a.h_ptr].ptr=0,l.fill(a.header[a.h_ptr].buf,0,a.sideinfo_len,0),e.out_samplerate<16e3?E(a,4094,12):E(a,4095,12),E(a,e.version,1),E(a,1,2),E(a,e.error_protection?0:1,1),E(a,a.bitrate_index,4),E(a,a.samplerate_index,2),E(a,a.padding,1),E(a,e.extension,1),E(a,e.mode.ordinal(),2),E(a,a.mode_ext,2),E(a,e.copyright,1),E(a,e.original,1),E(a,e.emphasis,2),e.error_protection&&E(a,0,16),1==e.version){for(E(a,n.main_data_begin,9),2==a.channels_out?E(a,n.private_bits,3):E(a,n.private_bits,5),r=0;r<a.channels_out;r++){var i;for(i=0;i<4;i++)E(a,n.scfsi[r][i],1)}for(o=0;o<2;o++)for(r=0;r<a.channels_out;r++)E(a,(c=n.tt[o][r]).part2_3_length+c.part2_length,12),E(a,c.big_values/2,9),E(a,c.global_gain,8),E(a,c.scalefac_compress,4),c.block_type!=L.NORM_TYPE?(E(a,1,1),E(a,c.block_type,2),E(a,c.mixed_block_flag,1),14==c.table_select[0]&&(c.table_select[0]=16),E(a,c.table_select[0],5),14==c.table_select[1]&&(c.table_select[1]=16),E(a,c.table_select[1],5),E(a,c.subblock_gain[0],3),E(a,c.subblock_gain[1],3),E(a,c.subblock_gain[2],3)):(E(a,0,1),14==c.table_select[0]&&(c.table_select[0]=16),E(a,c.table_select[0],5),14==c.table_select[1]&&(c.table_select[1]=16),E(a,c.table_select[1],5),14==c.table_select[2]&&(c.table_select[2]=16),E(a,c.table_select[2],5),E(a,c.region0_count,4),E(a,c.region1_count,3)),E(a,c.preflag,1),E(a,c.scalefac_scale,1),E(a,c.count1table_select,1)}else for(E(a,n.main_data_begin,8),E(a,n.private_bits,a.channels_out),o=0,r=0;r<a.channels_out;r++){var c;E(a,(c=n.tt[o][r]).part2_3_length+c.part2_length,12),E(a,c.big_values/2,9),E(a,c.global_gain,8),E(a,c.scalefac_compress,9),c.block_type!=L.NORM_TYPE?(E(a,1,1),E(a,c.block_type,2),E(a,c.mixed_block_flag,1),14==c.table_select[0]&&(c.table_select[0]=16),E(a,c.table_select[0],5),14==c.table_select[1]&&(c.table_select[1]=16),E(a,c.table_select[1],5),E(a,c.subblock_gain[0],3),E(a,c.subblock_gain[1],3),E(a,c.subblock_gain[2],3)):(E(a,0,1),14==c.table_select[0]&&(c.table_select[0]=16),E(a,c.table_select[0],5),14==c.table_select[1]&&(c.table_select[1]=16),E(a,c.table_select[1],5),14==c.table_select[2]&&(c.table_select[2]=16),E(a,c.table_select[2],5),E(a,c.region0_count,4),E(a,c.region1_count,3)),E(a,c.scalefac_scale,1),E(a,c.count1table_select,1)}e.error_protection&&CRC_writeheader(a,a.header[a.h_ptr].buf);var u=a.h_ptr;a.h_ptr=u+1&Y.MAX_HEADER_BUF-1,a.header[a.h_ptr].write_timing=a.header[u].write_timing+t,a.h_ptr==a.w_ptr&&s.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(e,o);var r=8*n.sideinfo_len;if(r+=function(e){var t,n,o,r,a=0,i=e.internal_flags,l=i.l3_side;if(1==e.version)for(t=0;t<2;t++)for(n=0;n<i.channels_out;n++){var s=l.tt[t][n],c=v.slen1_tab[s.scalefac_compress],u=v.slen2_tab[s.scalefac_compress];for(r=0,o=0;o<s.sfbdivide;o++)-1!=s.scalefac[o]&&(h(i,s.scalefac[o],c),r+=c);for(;o<s.sfbmax;o++)-1!=s.scalefac[o]&&(h(i,s.scalefac[o],u),r+=u);s.block_type==L.SHORT_TYPE?r+=B(i,s):r+=A(i,s),a+=r+=y(i,s)}else for(t=0,n=0;n<i.channels_out;n++){var d,m,f=0;if(r=0,o=0,m=0,(s=l.tt[t][n]).block_type==L.SHORT_TYPE){for(;m<4;m++){var _=s.sfb_partition_table[m]/3,p=s.slen[m];for(d=0;d<_;d++,o++)h(i,Math.max(s.scalefac[3*o+0],0),p),h(i,Math.max(s.scalefac[3*o+1],0),p),h(i,Math.max(s.scalefac[3*o+2],0),p),f+=3*p}r+=B(i,s)}else{for(;m<4;m++)for(_=s.sfb_partition_table[m],p=s.slen[m],d=0;d<_;d++,o++)h(i,Math.max(s.scalefac[o],0),p),f+=p;r+=A(i,s)}a+=f+(r+=y(i,s))}return a}(e),g(e,t.resvDrain_post),r+=t.resvDrain_post,t.main_data_begin+=(o-r)/8,R(e,new I)!=n.ResvSize&&s.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=n.ResvSize&&(s.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,n.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*n.sideinfo_len,r-t.resvDrain_post-8*n.sideinfo_len,r,r%8,o),s.err.println("This is a fatal error.  It has several possible causes:"),s.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),s.err.println(" 9%%  Your system is overclocked"),s.err.println(" 1%%  bug in LAME encoding library"),n.ResvSize=8*t.main_data_begin),d>1e9){var a;for(a=0;a<Y.MAX_HEADER_BUF;++a)n.header[a].write_timing-=d;d=0}return 0},this.copy_buffer=function(e,n,i,l,d){var _=m+1;if(_<=0)return 0;if(0!=l&&_>l)return-1;if(s.arraycopy(u,0,n,i,_),m=-1,f=0,0!=d){var h=t(1);if(h[0]=e.nMusicCRC,c.updateMusicCRC(h,n,i,_),e.nMusicCRC=h[0],_>0&&(e.VBR_seek_table.nBytesWritten+=_),e.decode_on_the_fly)for(var v,b=o([2,1152]),g=_,E=-1;0!=E;)if(E=a.hip_decode1_unclipped(e.hip,n,i,g,b[0],b[1]),g=0,-1==E&&(E=0),E>0){if(e.findPeakSample){for(v=0;v<E;v++)b[0][v]>e.PeakSample?e.PeakSample=b[0][v]:-b[0][v]>e.PeakSample&&(e.PeakSample=-b[0][v]);if(e.channels_out>1)for(v=0;v<E;v++)b[1][v]>e.PeakSample?e.PeakSample=b[1][v]:-b[1][v]>e.PeakSample&&(e.PeakSample=-b[1][v])}if(e.findReplayGain&&r.AnalyzeSamples(e.rgdata,b[0],0,b[1],0,E,e.channels_out)==p.GAIN_ANALYSIS_ERROR)return-6}}return _},this.init_bit_stream_w=function(t){u=e(G.LAME_MAXMP3BUFFER),t.h_ptr=t.w_ptr=0,t.header[t.h_ptr].write_timing=0,m=-1,f=0,d=0}}function E(){var t,n,o;this.setModules=function(e,r,a){t=e,n=r,o=a};var r=E.NUMTOCENTRIES,a=E.MAXFRAMESIZE,i=r+4+4+4+4+4+9+1+1+8+1+1+3+1+1+2+4+2+2,c="Xing",d="Info",f=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function _(e,t){var n=255&e[t+0];return n<<=8,n|=255&e[t+1],n<<=8,n|=255&e[t+2],(n<<=8)|255&e[t+3]}function p(e,t,n){e[t+0]=255&n>>24,e[t+1]=255&n>>16,e[t+2]=255&n>>8,e[t+3]=255&n}function h(e,t,n){e[t+0]=255&n>>8,e[t+1]=255&n}function v(e,t,n){return 255&(e<<t|n&~(-1<<t))}function b(e,n){var o=e.internal_flags;n[0]=v(n[0],8,255),n[1]=v(n[1],3,7),n[1]=v(n[1],1,e.out_samplerate<16e3?0:1),n[1]=v(n[1],1,e.version),n[1]=v(n[1],2,1),n[1]=v(n[1],1,e.error_protection?0:1),n[2]=v(n[2],4,o.bitrate_index),n[2]=v(n[2],2,o.samplerate_index),n[2]=v(n[2],1,0),n[2]=v(n[2],1,e.extension),n[3]=v(n[3],2,e.mode.ordinal()),n[3]=v(n[3],2,o.mode_ext),n[3]=v(n[3],1,e.copyright),n[3]=v(n[3],1,e.original),n[3]=v(n[3],2,e.emphasis),n[0]=255;var r,a,i=241&n[1];r=1==e.version?128:e.out_samplerate<16e3?32:64,e.VBR==m.vbr_off&&(r=e.brate),a=e.free_format?0:255&16*t.BitrateIndex(r,e.version,e.out_samplerate),1==e.version?(n[1]=255&(10|i),i=13&n[2],n[2]=255&(a|i)):(n[1]=255&(2|i),i=13&n[2],n[2]=255&(a|i))}function g(e,t){return t>>8^f[255&(t^e)]}this.addVbrFrame=function(e){var t=e.internal_flags,n=k.bitrate_table[e.version][t.bitrate_index];!function(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var n=1;n<e.size;n+=2)e.bag[n/2]=e.bag[n];e.want*=2,e.pos/=2}}(t.VBR_seek_table,n)},this.getVbrTag=function(e){var t=new VBRTagData,n=0;t.flags=0;var o=e[n+1]>>3&1,a=e[n+2]>>2&3,i=e[n+3]>>6&3,l=e[n+2]>>4&15;if(l=k.bitrate_table[o][l],e[n+1]>>4==14?t.samprate=k.samplerate_table[2][a]:t.samprate=k.samplerate_table[o][a],!function(e,t){return new String(e,t,c.length(),null).equals(c)||new String(e,t,d.length(),null).equals(d)}(e,n+=0!=o?3!=i?36:21:3!=i?21:13))return null;n+=4,t.hId=o;var s=t.flags=_(e,n);if(n+=4,0!=(1&s)&&(t.frames=_(e,n),n+=4),0!=(2&s)&&(t.bytes=_(e,n),n+=4),0!=(4&s)){if(null!=t.toc)for(var u=0;u<r;u++)t.toc[u]=e[n+u];n+=r}t.vbrScale=-1,0!=(8&s)&&(t.vbrScale=_(e,n),n+=4),t.headersize=72e3*(o+1)*l/t.samprate;var m=e[(n+=21)+0]<<4;m+=e[n+1]>>4;var f=(15&e[n+1])<<8;return(m<0||m>3e3)&&(m=-1),((f+=255&e[n+2])<0||f>3e3)&&(f=-1),t.encDelay=m,t.encPadding=f,t},this.InitVbrTag=function(t){var o,r=t.internal_flags;o=1==t.version?128:t.out_samplerate<16e3?32:64,t.VBR==m.vbr_off&&(o=t.brate);var l=72e3*(t.version+1)*o/t.out_samplerate,s=r.sideinfo_len+i;if(r.VBR_seek_table.TotalFrameSize=l,l<s||l>a)t.bWriteVbrTag=!1;else{r.VBR_seek_table.nVbrNumFrames=0,r.VBR_seek_table.nBytesWritten=0,r.VBR_seek_table.sum=0,r.VBR_seek_table.seen=0,r.VBR_seek_table.want=1,r.VBR_seek_table.pos=0,null==r.VBR_seek_table.bag&&(r.VBR_seek_table.bag=new int[400],r.VBR_seek_table.size=400);var c=e(a);b(t,c);for(var u=r.VBR_seek_table.TotalFrameSize,d=0;d<u;++d)n.add_dummy_byte(t,255&c[d],1)}},this.updateMusicCRC=function(e,t,n,o){for(var r=0;r<o;++r)e[0]=g(t[n+r],e[0])},this.getLameTagFrame=function(t,a){var i=t.internal_flags;if(!t.bWriteVbrTag)return 0;if(i.Class_ID!=G.LAME_ID)return 0;if(i.VBR_seek_table.pos<=0)return 0;if(a.length<i.VBR_seek_table.TotalFrameSize)return i.VBR_seek_table.TotalFrameSize;l.fill(a,0,i.VBR_seek_table.TotalFrameSize,0),b(t,a);var f=e(r);if(t.free_format)for(var _=1;_<r;++_)f[_]=255&255*_/100;else!function(e,t){if(!(e.pos<=0))for(var n=1;n<r;++n){var o=n/r,a=0|Math.floor(o*e.pos);a>e.pos-1&&(a=e.pos-1);var i=0|256*e.bag[a]/e.sum;i>255&&(i=255),t[n]=255&i}}(i.VBR_seek_table,f);var v=i.sideinfo_len;t.error_protection&&(v-=2),t.VBR==m.vbr_off?(a[v++]=255&d.charAt(0),a[v++]=255&d.charAt(1),a[v++]=255&d.charAt(2),a[v++]=255&d.charAt(3)):(a[v++]=255&c.charAt(0),a[v++]=255&c.charAt(1),a[v++]=255&c.charAt(2),a[v++]=255&c.charAt(3)),p(a,v,15),p(a,v+=4,i.VBR_seek_table.nVbrNumFrames),v+=4;var E=i.VBR_seek_table.nBytesWritten+i.VBR_seek_table.TotalFrameSize;p(a,v,0|E),v+=4,s.arraycopy(f,0,a,v,f.length),v+=f.length,t.error_protection&&n.CRC_writeheader(i,a);var S=0;for(_=0;_<v;_++)S=g(a[_],S);return v+=function(e,t,n,r,a){var i,l,s,c,d,m,f=e.internal_flags,_=0,v=e.encoder_delay,b=e.encoder_padding,E=100-10*e.VBR_q-e.quality,S=o.getLameVeryShortVersion(),k=[1,5,3,2,4,0,3],y=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),T=0,B=0,A=e.internal_flags.noise_shaping,I=0,R=0,M=0!=(1&e.exp_nspsytune),w=0!=(2&e.exp_nspsytune),C=!1,x=!1,F=e.internal_flags.nogap_total,N=e.internal_flags.nogap_current,D=e.ATHtype;switch(e.VBR){case vbr_abr:d=e.VBR_mean_bitrate_kbps;break;case vbr_off:d=e.brate;break;default:d=e.VBR_min_bitrate_kbps}switch(i=0+(e.VBR.ordinal()<k.length?k[e.VBR.ordinal()]:0),f.findReplayGain&&(f.RadioGain>510&&(f.RadioGain=510),f.RadioGain<-510&&(f.RadioGain=-510),B=8192,B|=3072,f.RadioGain>=0?B|=f.RadioGain:(B|=512,B|=-f.RadioGain)),f.findPeakSample&&(T=Math.abs(0|f.PeakSample/32767*Math.pow(2,23)+.5)),-1!=F&&(N>0&&(x=!0),N<F-1&&(C=!0)),c=D+((M?1:0)<<4)+((w?1:0)<<5)+((C?1:0)<<6)+((x?1:0)<<7),E<0&&(E=0),e.mode){case MONO:I=0;break;case STEREO:I=1;break;case DUAL_CHANNEL:I=2;break;case JOINT_STEREO:I=e.force_ms?4:3;break;case NOT_SET:default:I=7}m=e.in_samplerate<=32e3?0:48e3==e.in_samplerate?2:e.in_samplerate>48e3?3:1,(e.short_blocks==u.short_block_forced||e.short_blocks==u.short_block_dispensed||-1==e.lowpassfreq&&-1==e.highpassfreq||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||0==D||e.in_samplerate<=32e3)&&(R=1),l=A+(I<<2)+(R<<5)+(m<<6),s=f.nMusicCRC,p(n,r+_,E),_+=4;for(var V=0;V<9;V++)n[r+_+V]=255&S.charAt(V);n[r+(_+=9)]=255&i,n[r+ ++_]=255&y,p(n,r+ ++_,T),h(n,r+(_+=4),B),h(n,r+(_+=2),0),n[r+(_+=2)]=255&c,n[r+ ++_]=d>=255?255:255&d,n[r+ ++_]=255&v>>4,n[r+_+1]=255&(v<<4)+(b>>8),n[r+_+2]=255&b,n[r+(_+=3)]=255&l,_++,n[r+_++]=0,h(n,r+_,e.preset),p(n,r+(_+=2),t),h(n,r+(_+=4),s),_+=2;for(var O=0;O<_;O++)a=g(n[r+O],a);return h(n,r+_,a),_+2}(t,E,a,v,S),i.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(t,n){if(t.internal_flags.VBR_seek_table.pos<=0)return-1;if(n.seek(n.length()),0==n.length())return-1;var o=function(t){t.seek(0);var n=e(10);return t.readFully(n),new String(n,"ISO-8859-1").startsWith("ID3")?0:((127&n[6])<<21|(127&n[7])<<14|(127&n[8])<<7|127&n[9])+n.length}(n);n.seek(o);var r=e(a),i=getLameTagFrame(t,r);return i>r.length?-1:(i<1||n.write(r,0,i),0)}}function S(e,t,n,o){this.xlen=e,this.linmax=t,this.table=n,this.hlen=o}d.MAX_VALUE=34028235e31,m.vbr_off=new m(0),m.vbr_mt=new m(1),m.vbr_rh=new m(2),m.vbr_abr=new m(3),m.vbr_mtrh=new m(4),m.vbr_default=m.vbr_mtrh,f.STEREO=new f(0),f.JOINT_STEREO=new f(1),f.DUAL_CHANNEL=new f(2),f.MONO=new f(3),f.NOT_SET=new f(4),p.STEPS_per_dB=100,p.MAX_dB=120,p.GAIN_NOT_ENOUGH_SAMPLES=-24601,p.GAIN_ANALYSIS_ERROR=0,p.GAIN_ANALYSIS_OK=1,p.INIT_GAIN_ANALYSIS_ERROR=0,p.INIT_GAIN_ANALYSIS_OK=1,p.YULE_ORDER=10,p.MAX_ORDER=p.YULE_ORDER,p.MAX_SAMP_FREQ=48e3,p.RMS_WINDOW_TIME_NUMERATOR=1,p.RMS_WINDOW_TIME_DENOMINATOR=20,p.MAX_SAMPLES_PER_WINDOW=p.MAX_SAMP_FREQ*p.RMS_WINDOW_TIME_NUMERATOR/p.RMS_WINDOW_TIME_DENOMINATOR+1,g.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},g.NEQ=function(e,t){return!g.EQ(e,t)},E.NUMTOCENTRIES=100,E.MAXFRAMESIZE=2880;var k={};function y(e){this.bits=e}function T(){this.setModules=function(e,t){}}function B(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function A(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=f.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function I(){this.linprebuf=n(2*p.MAX_ORDER),this.linpre=0,this.lstepbuf=n(p.MAX_SAMPLES_PER_WINDOW+p.MAX_ORDER),this.lstep=0,this.loutbuf=n(p.MAX_SAMPLES_PER_WINDOW+p.MAX_ORDER),this.lout=0,this.rinprebuf=n(2*p.MAX_ORDER),this.rinpre=0,this.rstepbuf=n(p.MAX_SAMPLES_PER_WINDOW+p.MAX_ORDER),this.rstep=0,this.routbuf=n(p.MAX_SAMPLES_PER_WINDOW+p.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=t(0|p.STEPS_per_dB*p.MAX_dB),this.B=t(0|p.STEPS_per_dB*p.MAX_dB)}function R(e){var o=e;this.quantize=o,this.iteration_loop=function(e,o,r,a){var i,l=e.internal_flags,s=n(N.SFBMAX),c=n(576),u=t(2),d=0,m=l.l3_side,f=new y(d);this.quantize.rv.ResvFrameBegin(e,f),d=f.bits;for(var _=0;_<l.mode_gr;_++){i=this.quantize.qupvt.on_pe(e,o,u,d,_,_),l.mode_ext==L.MPG_MD_MS_LR&&(this.quantize.ms_convert(l.l3_side,_),this.quantize.qupvt.reduce_side(u,r[_],d,i));for(var p=0;p<l.channels_out;p++){var h,v,b=m.tt[_][p];b.block_type!=L.SHORT_TYPE?(h=0,v=l.PSY.mask_adjust-h):(h=0,v=l.PSY.mask_adjust_short-h),l.masking_lower=Math.pow(10,.1*v),this.quantize.init_outer_loop(l,b),this.quantize.init_xrpow(l,b,c)&&(this.quantize.qupvt.calc_xmin(e,a[_][p],b,s),this.quantize.outer_loop(e,b,s,c,p,u[p])),this.quantize.iteration_finish_one(l,_,p)}}this.quantize.rv.ResvFrameEnd(l,d)}}function M(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=n(L.SBMAX_l),this.s=n(L.SBMAX_s),this.psfb21=n(L.PSFB21),this.psfb12=n(L.PSFB12),this.cb_l=n(L.CBANDS),this.cb_s=n(L.CBANDS),this.eql_w=n(L.BLKSIZE/2)}function w(e,n,o,r){this.l=t(1+L.SBMAX_l),this.s=t(1+L.SBMAX_s),this.psfb21=t(1+L.PSFB21),this.psfb12=t(1+L.PSFB12);var a=this.l,i=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],s.arraycopy(this.arrL,0,a,0,Math.min(this.arrL.length,this.l.length)),s.arraycopy(this.arrS,0,i,0,Math.min(this.arrS.length,this.s.length)),s.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),s.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function C(){var e=null,o=null,r=null;this.setModules=function(t,n,a){e=t,o=n,r=a},this.IPOW20=function(e){return f[e]};var a=C.IXMAX_VAL+2,i=C.Q_MAX,l=C.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var s=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=s,this.sfBandIndex=[new w([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new w([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=n(i+l+1),f=n(i),_=n(a),p=n(a);function h(e,t){var n=r.ATHformula(t,e);return n-=100,Math.pow(10,n/10+e.ATHlower)}function v(e){this.s=e}this.adj43=p,this.iteration_init=function(t){var n,o=t.internal_flags,r=o.l3_side;if(0==o.iteration_init_init){for(o.iteration_init_init=1,r.main_data_begin=0,function(e){for(var t=e.internal_flags.ATH.l,n=e.internal_flags.ATH.psfb21,o=e.internal_flags.ATH.s,r=e.internal_flags.ATH.psfb12,a=e.internal_flags,i=e.out_samplerate,l=0;l<L.SBMAX_l;l++){var s=a.scalefac_band.l[l],c=a.scalefac_band.l[l+1];t[l]=d.MAX_VALUE;for(var u=s;u<c;u++){var m=h(e,u*i/1152);t[l]=Math.min(t[l],m)}}for(l=0;l<L.PSFB21;l++)for(s=a.scalefac_band.psfb21[l],c=a.scalefac_band.psfb21[l+1],n[l]=d.MAX_VALUE,u=s;u<c;u++)m=h(e,u*i/1152),n[l]=Math.min(n[l],m);for(l=0;l<L.SBMAX_s;l++){for(s=a.scalefac_band.s[l],c=a.scalefac_band.s[l+1],o[l]=d.MAX_VALUE,u=s;u<c;u++)m=h(e,u*i/384),o[l]=Math.min(o[l],m);o[l]*=a.scalefac_band.s[l+1]-a.scalefac_band.s[l]}for(l=0;l<L.PSFB12;l++){for(s=a.scalefac_band.psfb12[l],c=a.scalefac_band.psfb12[l+1],r[l]=d.MAX_VALUE,u=s;u<c;u++)m=h(e,u*i/384),r[l]=Math.min(r[l],m);r[l]*=a.scalefac_band.s[13]-a.scalefac_band.s[12]}if(e.noATH){for(l=0;l<L.SBMAX_l;l++)t[l]=1e-20;for(l=0;l<L.PSFB21;l++)n[l]=1e-20;for(l=0;l<L.SBMAX_s;l++)o[l]=1e-20;for(l=0;l<L.PSFB12;l++)r[l]=1e-20}a.ATH.floor=10*Math.log10(h(e,-1))}(t),_[0]=0,n=1;n<a;n++)_[n]=Math.pow(n,4/3);for(n=0;n<a-1;n++)p[n]=n+1-Math.pow(.5*(_[n]+_[n+1]),.75);for(p[n]=.5,n=0;n<i;n++)f[n]=Math.pow(2,-.1875*(n-210));for(n=0;n<=i+l;n++)u[n]=Math.pow(2,.25*(n-210-l));var s,c,m,v;for(e.huffman_init(o),(n=t.exp_nspsytune>>2&63)>=32&&(n-=64),s=Math.pow(10,n/4/10),(n=t.exp_nspsytune>>8&63)>=32&&(n-=64),c=Math.pow(10,n/4/10),(n=t.exp_nspsytune>>14&63)>=32&&(n-=64),m=Math.pow(10,n/4/10),(n=t.exp_nspsytune>>20&63)>=32&&(n-=64),v=m*Math.pow(10,n/4/10),n=0;n<L.SBMAX_l;n++)b=n<=6?s:n<=13?c:n<=20?m:v,o.nsPsy.longfact[n]=b;for(n=0;n<L.SBMAX_s;n++){var b;b=n<=5?s:n<=10?c:n<=11?m:v,o.nsPsy.shortfact[n]=b}}},this.on_pe=function(e,n,r,a,i,l){var s,c,u=e.internal_flags,d=0,m=t(2),f=new y(d),_=o.ResvMaxBits(e,a,f,l),p=(d=f.bits)+_;for(p>Y.MAX_BITS_PER_GRANULE&&(p=Y.MAX_BITS_PER_GRANULE),s=0,c=0;c<u.channels_out;++c)r[c]=Math.min(Y.MAX_BITS_PER_CHANNEL,d/u.channels_out),m[c]=0|r[c]*n[i][c]/700-r[c],m[c]>3*a/4&&(m[c]=3*a/4),m[c]<0&&(m[c]=0),m[c]+r[c]>Y.MAX_BITS_PER_CHANNEL&&(m[c]=Math.max(0,Y.MAX_BITS_PER_CHANNEL-r[c])),s+=m[c];if(s>_)for(c=0;c<u.channels_out;++c)m[c]=_*m[c]/s;for(c=0;c<u.channels_out;++c)r[c]+=m[c],_-=m[c];for(s=0,c=0;c<u.channels_out;++c)s+=r[c];if(s>Y.MAX_BITS_PER_GRANULE)for(c=0;c<u.channels_out;++c)r[c]*=Y.MAX_BITS_PER_GRANULE,r[c]/=s,r[c];return p},this.reduce_side=function(e,t,n,o){var r=.33*(.5-t)/.5;r<0&&(r=0),r>.5&&(r=.5);var a=0|.5*r*(e[0]+e[1]);a>Y.MAX_BITS_PER_CHANNEL-e[0]&&(a=Y.MAX_BITS_PER_CHANNEL-e[0]),a<0&&(a=0),e[1]>=125&&(e[1]-a>125?(e[0]<n&&(e[0]+=a),e[1]-=a):(e[0]+=e[1]-125,e[1]=125)),(a=e[0]+e[1])>o&&(e[0]=o*e[0]/a,e[1]=o*e[1]/a)},this.athAdjust=function(e,t,n){var o=90.30873362,r=c.FAST_LOG10_X(t,10),a=e*e,i=0;return r-=n,a>1e-20&&(i=1+c.FAST_LOG10_X(a,10/o)),i<0&&(i=0),r*=i,r+=n+o-94.82444863,Math.pow(10,.1*r)},this.calc_xmin=function(e,t,n,o){var r,a=0,i=e.internal_flags,l=0,s=0,c=i.ATH,u=n.xr,d=e.VBR==m.vbr_mtrh?1:0,f=i.masking_lower;for(e.VBR!=m.vbr_mtrh&&e.VBR!=m.vbr_mt||(f=1),r=0;r<n.psy_lmax;r++){k=(S=e.VBR==m.vbr_rh||e.VBR==m.vbr_mtrh?athAdjust(c.adjust,c.l[r],c.floor):c.adjust*c.l[r])/(v=n.width[r]),y=2220446049250313e-31,I=v>>1,A=0;do{A+=R=u[l]*u[l],y+=R<k?R:k,A+=M=u[++l]*u[l],y+=M<k?M:k,l++}while(--I>0);A>S&&s++,r==L.SBPSY_l&&y<(B=S*i.nsPsy.longfact[r])&&(y=B),0!=d&&(S=y),e.ATHonly||(T=t.en.l[r])>0&&(B=A*t.thm.l[r]*f/T,0!=d&&(B*=i.nsPsy.longfact[r]),S<B&&(S=B)),o[a++]=0!=d?S:S*i.nsPsy.longfact[r]}var _=575;if(n.block_type!=L.SHORT_TYPE)for(var p=576;0!=p--&&g.EQ(u[p],0);)_=p;n.max_nonzero_coeff=_;for(var h=n.sfb_smin;r<n.psymax;h++,r+=3){var v,b,E;for(E=e.VBR==m.vbr_rh||e.VBR==m.vbr_mtrh?athAdjust(c.adjust,c.s[h],c.floor):c.adjust*c.s[h],v=n.width[r],b=0;b<3;b++){var S,k,y,T,B,A=0,I=v>>1;k=E/v,y=2220446049250313e-31;do{var R,M;A+=R=u[l]*u[l],y+=R<k?R:k,A+=M=u[++l]*u[l],y+=M<k?M:k,l++}while(--I>0);A>E&&s++,h==L.SBPSY_s&&y<(B=E*i.nsPsy.shortfact[h])&&(y=B),S=0!=d?y:E,e.ATHonly||e.ATHshort||(T=t.en.s[h][b])>0&&(B=A*t.thm.s[h][b]*f/T,0!=d&&(B*=i.nsPsy.shortfact[h]),S<B&&(S=B)),o[a++]=0!=d?S:S*i.nsPsy.shortfact[h]}e.useTemporal&&(o[a-3]>o[a-3+1]&&(o[a-3+1]+=(o[a-3]-o[a-3+1])*i.decay),o[a-3+1]>o[a-3+2]&&(o[a-3+2]+=(o[a-3+1]-o[a-3+2])*i.decay))}return s},this.calc_noise_core=function(e,t,o,r){var a=0,i=t.s,l=e.l3_enc;if(i>e.count1)for(;0!=o--;)c=e.xr[i],i++,a+=c*c,c=e.xr[i],i++,a+=c*c;else if(i>e.big_values){var s=n(2);for(s[0]=0,s[1]=r;0!=o--;)c=Math.abs(e.xr[i])-s[l[i]],i++,a+=c*c,c=Math.abs(e.xr[i])-s[l[i]],i++,a+=c*c}else for(;0!=o--;){var c;c=Math.abs(e.xr[i])-_[l[i]]*r,i++,a+=c*c,c=Math.abs(e.xr[i])-_[l[i]]*r,i++,a+=c*c}return t.s=i,a},this.calc_noise=function(e,t,n,o,r){var a,i,l=0,d=0,m=0,f=0,_=0,p=-20,h=0,b=e.scalefac,g=0;for(o.over_SSD=0,a=0;a<e.psymax;a++){var E,S=e.global_gain-(b[g++]+(0!=e.preflag?s[a]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[a]],k=0;if(null!=r&&r.step[a]==S)k=r.noise[a],h+=e.width[a],n[l++]=k/t[d++],k=r.noise_log[a];else{var y,T=u[S+C.Q_MAX2];i=e.width[a]>>1,h+e.width[a]>e.max_nonzero_coeff&&(i=(y=e.max_nonzero_coeff-h+1)>0?y>>1:0);var B=new v(h);k=this.calc_noise_core(e,B,i,T),h=B.s,null!=r&&(r.step[a]=S,r.noise[a]=k),k=n[l++]=k/t[d++],k=c.FAST_LOG10(Math.max(k,1e-20)),null!=r&&(r.noise_log[a]=k)}null!=r&&(r.global_gain=e.global_gain),_+=k,k>0&&(E=Math.max(0|10*k+.5,1),o.over_SSD+=E*E,m++,f+=k),p=Math.max(p,k)}return o.over_count=m,o.tot_noise=_,o.over_noise=f,o.max_noise=p,m},this.set_pinfo=function(e,t,o,r,a){var i,l,c,u,d,m=e.internal_flags,f=0==t.scalefac_scale?.5:1,_=t.scalefac,p=n(N.SFBMAX),h=n(N.SFBMAX),v=new B;calc_xmin(e,o,t,p),calc_noise(t,p,h,v,null);var b=0;for(l=t.sfb_lmax,t.block_type!=L.SHORT_TYPE&&0==t.mixed_block_flag&&(l=22),i=0;i<l;i++){var g=m.scalefac_band.l[i],E=(S=m.scalefac_band.l[i+1])-g;for(u=0;b<S;b++)u+=t.xr[b]*t.xr[b];u/=E,d=1e15,m.pinfo.en[r][a][i]=d*u,m.pinfo.xfsf[r][a][i]=d*p[i]*h[i]/E,o.en.l[i]>0&&!e.ATHonly?u/=o.en.l[i]:u=0,m.pinfo.thr[r][a][i]=d*Math.max(u*o.thm.l[i],m.ATH.l[i]),m.pinfo.LAMEsfb[r][a][i]=0,0!=t.preflag&&i>=11&&(m.pinfo.LAMEsfb[r][a][i]=-f*s[i]),i<L.SBPSY_l&&(m.pinfo.LAMEsfb[r][a][i]-=f*_[i])}if(t.block_type==L.SHORT_TYPE)for(l=i,i=t.sfb_smin;i<L.SBMAX_s;i++){g=m.scalefac_band.s[i],E=(S=m.scalefac_band.s[i+1])-g;for(var S,k=0;k<3;k++){for(u=0,c=g;c<S;c++)u+=t.xr[b]*t.xr[b],b++;u=Math.max(u/E,1e-20),d=1e15,m.pinfo.en_s[r][a][3*i+k]=d*u,m.pinfo.xfsf_s[r][a][3*i+k]=d*p[l]*h[l]/E,o.en.s[i][k]>0?u/=o.en.s[i][k]:u=0,(e.ATHonly||e.ATHshort)&&(u=0),m.pinfo.thr_s[r][a][3*i+k]=d*Math.max(u*o.thm.s[i][k],m.ATH.s[i]),m.pinfo.LAMEsfb_s[r][a][3*i+k]=-2*t.subblock_gain[k],i<L.SBPSY_s&&(m.pinfo.LAMEsfb_s[r][a][3*i+k]-=f*_[l]),l++}}m.pinfo.LAMEqss[r][a]=t.global_gain,m.pinfo.LAMEmainbits[r][a]=t.part2_3_length+t.part2_length,m.pinfo.LAMEsfbits[r][a]=t.part2_length,m.pinfo.over[r][a]=v.over_count,m.pinfo.max_noise[r][a]=10*v.max_noise,m.pinfo.over_noise[r][a]=10*v.over_noise,m.pinfo.tot_noise[r][a]=10*v.tot_noise,m.pinfo.over_SSD[r][a]=v.over_SSD}}function x(){this.global_gain=0,this.sfb_count1=0,this.step=t(39),this.noise=n(39),this.noise_log=n(39)}function F(){this.xr=n(576),this.l3_enc=t(576),this.scalefac=t(N.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=t(3),this.subblock_gain=t(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=t(N.SFBMAX),this.window=t(N.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=t(4),this.max_nonzero_coeff=0;var e=this;function o(e){return new Int32Array(e)}this.assign=function(t){var n;e.xr=(n=t.xr,new Float32Array(n)),e.l3_enc=o(t.l3_enc),e.scalefac=o(t.scalefac),e.xrpow_max=t.xrpow_max,e.part2_3_length=t.part2_3_length,e.big_values=t.big_values,e.count1=t.count1,e.global_gain=t.global_gain,e.scalefac_compress=t.scalefac_compress,e.block_type=t.block_type,e.mixed_block_flag=t.mixed_block_flag,e.table_select=o(t.table_select),e.subblock_gain=o(t.subblock_gain),e.region0_count=t.region0_count,e.region1_count=t.region1_count,e.preflag=t.preflag,e.scalefac_scale=t.scalefac_scale,e.count1table_select=t.count1table_select,e.part2_length=t.part2_length,e.sfb_lmax=t.sfb_lmax,e.sfb_smin=t.sfb_smin,e.psy_lmax=t.psy_lmax,e.sfbmax=t.sfbmax,e.psymax=t.psymax,e.sfbdivide=t.sfbdivide,e.width=o(t.width),e.window=o(t.window),e.count1bits=t.count1bits,e.sfb_partition_table=t.sfb_partition_table.slice(0),e.slen=o(t.slen),e.max_nonzero_coeff=t.max_nonzero_coeff}}k.t1HB=[1,1,1,0],k.t2HB=[1,2,1,3,1,1,3,2,0],k.t3HB=[3,2,1,1,1,1,3,2,0],k.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],k.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],k.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],k.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],k.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],k.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],k.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],k.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],k.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],k.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],k.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],k.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],k.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],k.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],k.t1l=[1,4,3,5],k.t2l=[1,4,7,4,5,7,6,7,8],k.t3l=[2,3,7,4,4,7,6,7,8],k.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],k.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],k.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],k.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],k.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],k.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],k.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],k.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],k.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],k.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],k.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],k.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],k.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],k.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],k.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],k.ht=[new S(0,0,null,null),new S(2,0,k.t1HB,k.t1l),new S(3,0,k.t2HB,k.t2l),new S(3,0,k.t3HB,k.t3l),new S(0,0,null,null),new S(4,0,k.t5HB,k.t5l),new S(4,0,k.t6HB,k.t6l),new S(6,0,k.t7HB,k.t7l),new S(6,0,k.t8HB,k.t8l),new S(6,0,k.t9HB,k.t9l),new S(8,0,k.t10HB,k.t10l),new S(8,0,k.t11HB,k.t11l),new S(8,0,k.t12HB,k.t12l),new S(16,0,k.t13HB,k.t13l),new S(0,0,null,k.t16_5l),new S(16,0,k.t15HB,k.t15l),new S(1,1,k.t16HB,k.t16l),new S(2,3,k.t16HB,k.t16l),new S(3,7,k.t16HB,k.t16l),new S(4,15,k.t16HB,k.t16l),new S(6,63,k.t16HB,k.t16l),new S(8,255,k.t16HB,k.t16l),new S(10,1023,k.t16HB,k.t16l),new S(13,8191,k.t16HB,k.t16l),new S(4,15,k.t24HB,k.t24l),new S(5,31,k.t24HB,k.t24l),new S(6,63,k.t24HB,k.t24l),new S(7,127,k.t24HB,k.t24l),new S(8,255,k.t24HB,k.t24l),new S(9,511,k.t24HB,k.t24l),new S(11,2047,k.t24HB,k.t24l),new S(13,8191,k.t24HB,k.t24l),new S(0,0,k.t32HB,k.t32l),new S(0,0,k.t33HB,k.t33l)],k.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],k.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],k.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],k.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],k.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],k.scfsi_band=[0,6,11,16,21],C.Q_MAX=257,C.Q_MAX2=116,C.LARGE_BITS=1e5,C.IXMAX_VAL=8206;var N={};function D(){var e,t,o;this.rv=null,this.qupvt=null;var r,a=new T;function i(e){this.ordinal=e}function u(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function d(e,t,n,o,r){var a;switch(e){default:t.over_count>0?(a=n.over_SSD<=t.over_SSD,n.over_SSD==t.over_SSD&&(a=n.bits<t.bits)):a=n.max_noise<0&&10*n.max_noise+n.bits<=10*t.max_noise+t.bits;break;case 0:a=n.over_count<t.over_count||n.over_count==t.over_count&&n.over_noise<t.over_noise||n.over_count==t.over_count&&g.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 8:n.max_noise=function(e,t){for(var n,o=1e-37,r=0;r<t.psymax;r++)o+=(n=e[r],c.FAST_LOG10(.368+.632*n*n*n));return Math.max(1e-20,o)}(r,o);case 1:a=n.max_noise<t.max_noise;break;case 2:a=n.tot_noise<t.tot_noise;break;case 3:a=n.tot_noise<t.tot_noise&&n.max_noise<t.max_noise;break;case 4:a=n.max_noise<=0&&t.max_noise>.2||n.max_noise<=0&&t.max_noise<0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise||n.max_noise<=0&&t.max_noise>0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.05&&t.max_noise>n.max_noise-.1&&n.tot_noise+n.over_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.1&&t.max_noise>n.max_noise-.15&&n.tot_noise+n.over_noise+n.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:a=n.over_noise<t.over_noise||g.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 6:a=n.over_noise<t.over_noise||g.EQ(n.over_noise,t.over_noise)&&(n.max_noise<t.max_noise||g.EQ(n.max_noise,t.max_noise)&&n.tot_noise<=t.tot_noise);break;case 7:a=n.over_count<t.over_count||n.over_noise<t.over_noise}return 0==t.over_count&&(a=a&&n.bits<t.bits),a}function f(e,t,n,a,i){var s=e.internal_flags;!function(e,t,n,o,r){var a,i=e.internal_flags;a=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var l=0,s=0;s<t.sfbmax;s++)l<n[s]&&(l=n[s]);var c=i.noise_shaping_amp;switch(3==c&&(c=r?2:1),c){case 2:break;case 1:l>1?l=Math.pow(l,.5):l*=.95;break;default:l>1?l=1:l*=.95}var u=0;for(s=0;s<t.sfbmax;s++){var d,m=t.width[s];if(u+=m,!(n[s]<l)){if(0!=(2&i.substep_shaping)&&(i.pseudohalf[s]=0==i.pseudohalf[s]?1:0,0==i.pseudohalf[s]&&2==i.noise_shaping_amp))return;for(t.scalefac[s]++,d=-m;d<0;d++)o[u+d]*=a,o[u+d]>t.xrpow_max&&(t.xrpow_max=o[u+d]);if(2==i.noise_shaping_amp)return}}}(e,t,n,a,i);var c=u(t);return!(c||(c=2==s.mode_gr?r.scale_bitcount(t):r.scale_bitcount_lsf(s,t))&&(s.noise_shaping>1&&(l.fill(s.pseudohalf,0),0==t.scalefac_scale?(function(e,t){for(var n=0,r=0;r<e.sfbmax;r++){var a=e.width[r],i=e.scalefac[r];if(0!=e.preflag&&(i+=o.pretab[r]),n+=a,0!=(1&i)){i++;for(var l=-a;l<0;l++)t[n+l]*=1.2968395546510096,t[n+l]>e.xrpow_max&&(e.xrpow_max=t[n+l])}e.scalefac[r]=i>>1}e.preflag=0,e.scalefac_scale=1}(t,a),c=!1):t.block_type==L.SHORT_TYPE&&s.subblock_gain>0&&(c=function(e,t,n){var r,a=t.scalefac;for(r=0;r<t.sfb_lmax;r++)if(a[r]>=16)return!0;for(var i=0;i<3;i++){var l=0,s=0;for(r=t.sfb_lmax+i;r<t.sfbdivide;r+=3)l<a[r]&&(l=a[r]);for(;r<t.sfbmax;r+=3)s<a[r]&&(s=a[r]);if(!(l<16&&s<8)){if(t.subblock_gain[i]>=7)return!0;t.subblock_gain[i]++;var c=e.scalefac_band.l[t.sfb_lmax];for(r=t.sfb_lmax+i;r<t.sfbmax;r+=3){var u=t.width[r],d=a[r];if((d-=4>>t.scalefac_scale)>=0)a[r]=d,c+=3*u;else{a[r]=0;var m=210+(d<<t.scalefac_scale+1);_=o.IPOW20(m),c+=u*(i+1);for(var f=-u;f<0;f++)n[c+f]*=_,n[c+f]>t.xrpow_max&&(t.xrpow_max=n[c+f]);c+=u*(3-i-1)}}var _=o.IPOW20(202);for(c+=t.width[r]*(i+1),f=-t.width[r];f<0;f++)n[c+f]*=_,n[c+f]>t.xrpow_max&&(t.xrpow_max=n[c+f])}}return!1}(s,t,a)||u(t))),c||(c=2==s.mode_gr?r.scale_bitcount(t):r.scale_bitcount_lsf(s,t)),c))}this.setModules=function(n,i,l,s){e=n,t=i,this.rv=i,o=l,this.qupvt=l,r=s,a.setModules(o,r)},this.ms_convert=function(e,t){for(var n=0;n<576;++n){var o=e.tt[t][0].xr[n],r=e.tt[t][1].xr[n];e.tt[t][0].xr[n]=(o+r)*(.5*c.SQRT2),e.tt[t][1].xr[n]=(o-r)*(.5*c.SQRT2)}},this.init_xrpow=function(e,t,n){var o=0,r=0|t.max_nonzero_coeff;if(t.xrpow_max=0,l.fill(n,r,576,0),(o=function(e,t,n,o){o=0;for(var r=0;r<=n;++r){var a=Math.abs(e.xr[r]);o+=a,t[r]=Math.sqrt(a*Math.sqrt(a)),t[r]>e.xrpow_max&&(e.xrpow_max=t[r])}return o}(t,n,r,o))>1e-20){var a=0;0!=(2&e.substep_shaping)&&(a=1);for(var i=0;i<t.psymax;i++)e.pseudohalf[i]=a;return!0}return l.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=L.SBPSY_l,t.sfb_smin=L.SBPSY_s,t.psy_lmax=e.sfb21_extra?L.SBMAX_l:L.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var r=0;r<L.SBMAX_l;r++)t.width[r]=e.scalefac_band.l[r+1]-e.scalefac_band.l[r],t.window[r]=3;if(t.block_type==L.SHORT_TYPE){var a=n(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?L.SBMAX_s:L.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(L.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var i=e.scalefac_band.l[t.sfb_lmax];for(s.arraycopy(t.xr,0,a,0,576),r=t.sfb_smin;r<L.SBMAX_s;r++)for(var c=e.scalefac_band.s[r],u=e.scalefac_band.s[r+1],d=0;d<3;d++)for(var m=c;m<u;m++)t.xr[i++]=a[3*m+d];var f=t.sfb_lmax;for(r=t.sfb_smin;r<L.SBMAX_s;r++)t.width[f]=t.width[f+1]=t.width[f+2]=e.scalefac_band.s[r+1]-e.scalefac_band.s[r],t.window[f]=0,t.window[f+1]=1,t.window[f+2]=2,f+=3}t.count1bits=0,t.sfb_partition_table=o.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,l.fill(t.scalefac,0),function(e,t){var n=e.ATH,r=t.xr;if(t.block_type!=L.SHORT_TYPE)for(var a=!1,i=L.PSFB21-1;i>=0&&!a;i--){var l=e.scalefac_band.psfb21[i],s=e.scalefac_band.psfb21[i+1],c=o.athAdjust(n.adjust,n.psfb21[i],n.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var u=s-1;u>=l;u--){if(!(Math.abs(r[u])<c)){a=!0;break}r[u]=0}}else for(var d=0;d<3;d++)for(a=!1,i=L.PSFB12-1;i>=0&&!a;i--){s=(l=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*d+(e.scalefac_band.psfb12[i]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[i+1]-e.scalefac_band.psfb12[i]);var m=o.athAdjust(n.adjust,n.psfb12[i],n.floor);for(e.nsPsy.shortfact[12]>1e-12&&(m*=e.nsPsy.shortfact[12]),u=s-1;u>=l;u--){if(!(Math.abs(r[u])<m)){a=!0;break}r[u]=0}}}(e,t)},i.BINSEARCH_NONE=new i(0),i.BINSEARCH_UP=new i(1),i.BINSEARCH_DOWN=new i(2),this.trancate_smallspectrums=function(e,t,a,i){var s=n(N.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=L.SHORT_TYPE)&&0==(128&e.substep_shaping)){o.calc_noise(t,a,s,new B,null);for(var c=0;c<576;c++){var u=0;0!=t.l3_enc[c]&&(u=Math.abs(t.xr[c])),i[c]=u}c=0;var d=8;t.block_type==L.SHORT_TYPE&&(d=6);do{var m,f,_,p,h=t.width[d];if(c+=h,!(s[d]>=1||(l.sort(i,c-h,h),g.EQ(i[c-1],0)))){m=(1-s[d])*a[d],f=0,p=0;do{var v;for(_=1;p+_<h&&!g.NEQ(i[p+c-h],i[p+c+_-h]);_++);if(m<(v=i[p+c-h]*i[p+c-h]*_)){0!=p&&(f=i[p+c-h-1]);break}m-=v,p+=_}while(p<h);if(!g.EQ(f,0))do{Math.abs(t.xr[c-h])<=f&&(t.l3_enc[c-h]=0)}while(--h>0)}}while(++d<t.psymax);t.part2_3_length=r.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,a,l,c,u){var _=e.internal_flags,p=new F,h=n(576),v=n(N.SFBMAX),b=new B,g=new x,E=9999999,S=!1,k=!1,y=0;if(function(e,t,n,o,a){var l,s=e.CurrentStep[o],c=!1,u=e.OldValue[o],d=i.BINSEARCH_NONE;for(t.global_gain=u,n-=t.part2_length;;){var m;if(l=r.count_bits(e,a,t,null),1==s||l==n)break;l>n?(d==i.BINSEARCH_DOWN&&(c=!0),c&&(s/=2),d=i.BINSEARCH_UP,m=s):(d==i.BINSEARCH_UP&&(c=!0),c&&(s/=2),d=i.BINSEARCH_DOWN,m=-s),t.global_gain+=m,t.global_gain<0&&(t.global_gain=0,c=!0),t.global_gain>255&&(t.global_gain=255,c=!0)}for(;l>n&&t.global_gain<255;)t.global_gain++,l=r.count_bits(e,a,t,null);e.CurrentStep[o]=u-t.global_gain>=4?4:2,e.OldValue[o]=t.global_gain,t.part2_3_length=l}(_,t,u,c,l),0==_.noise_shaping)return 100;o.calc_noise(t,a,v,b,g),b.bits=t.part2_3_length,p.assign(t);var T=0;for(s.arraycopy(l,0,h,0,576);!S;){do{var A,I=new B,R=255;if(A=0!=(2&_.substep_shaping)?20:3,_.sfb21_extra){if(v[p.sfbmax]>1)break;if(p.block_type==L.SHORT_TYPE&&(v[p.sfbmax+1]>1||v[p.sfbmax+2]>1))break}if(!f(e,p,v,l,k))break;0!=p.scalefac_scale&&(R=254);var M=u-p.part2_length;if(M<=0)break;for(;(p.part2_3_length=r.count_bits(_,l,p,g))>M&&p.global_gain<=R;)p.global_gain++;if(p.global_gain>R)break;if(0==b.over_count){for(;(p.part2_3_length=r.count_bits(_,l,p,g))>E&&p.global_gain<=R;)p.global_gain++;if(p.global_gain>R)break}if(o.calc_noise(p,a,v,I,g),I.bits=p.part2_3_length,0!=(d(t.block_type!=L.SHORT_TYPE?e.quant_comp:e.quant_comp_short,b,I,p,v)?1:0))E=t.part2_3_length,b=I,t.assign(p),T=0,s.arraycopy(l,0,h,0,576);else if(0==_.full_outer_loop){if(++T>A&&0==b.over_count)break;if(3==_.noise_shaping_amp&&k&&T>30)break;if(3==_.noise_shaping_amp&&k&&p.global_gain-y>15)break}}while(p.global_gain+p.scalefac_scale<255);3==_.noise_shaping_amp?k?S=!0:(p.assign(t),s.arraycopy(h,0,l,0,576),T=0,y=p.global_gain,k=!0):S=!0}return e.VBR==m.vbr_rh||e.VBR==m.vbr_mtrh?s.arraycopy(h,0,l,0,576):0!=(1&_.substep_shaping)&&trancate_smallspectrums(_,t,a,l),b.over_count},this.iteration_finish_one=function(e,n,o){var a=e.l3_side,i=a.tt[n][o];r.best_scalefac_store(e,n,o,a),1==e.use_best_huffman&&r.best_huffman_divide(e,i),t.ResvAdjust(e,i)},this.VBR_encode_granule=function(e,t,o,r,a,i,c){var u,d=e.internal_flags,m=new F,f=n(576),_=c,p=c+1,h=(c+i)/2,v=0,b=d.sfb21_extra;l.fill(m.l3_enc,0);do{d.sfb21_extra=!(h>_-42)&&b,outer_loop(e,t,o,r,a,h)<=0?(v=1,p=t.part2_3_length,m.assign(t),s.arraycopy(r,0,f,0,576),u=(c=p-32)-i,h=(c+i)/2):(u=c-(i=h+32),h=(c+i)/2,0!=v&&(v=2,t.assign(m),s.arraycopy(f,0,r,0,576)))}while(u>12);d.sfb21_extra=b,2==v&&s.arraycopy(m.l3_enc,0,t.l3_enc,0,576)},this.get_framebits=function(n,o){var r=n.internal_flags;r.bitrate_index=r.VBR_min_bitrate;var a=e.getframebits(n);r.bitrate_index=1,a=e.getframebits(n);for(var i=1;i<=r.VBR_max_bitrate;i++){r.bitrate_index=i;var l=new y(a);o[i]=t.ResvFrameBegin(n,l),a=l.bits}},this.VBR_old_prepare=function(e,n,r,a,i,l,s,c,u){var d,m=e.internal_flags,f=0,_=1,p=0;m.bitrate_index=m.VBR_max_bitrate;var h=t.ResvFrameBegin(e,new y(0))/m.mode_gr;get_framebits(e,l);for(var v=0;v<m.mode_gr;v++){var b=o.on_pe(e,n,c[v],h,v,0);m.mode_ext==L.MPG_MD_MS_LR&&(ms_convert(m.l3_side,v),o.reduce_side(c[v],r[v],h,b));for(var g=0;g<m.channels_out;++g){var E=m.l3_side.tt[v][g];E.block_type!=L.SHORT_TYPE?(f=1.28/(1+Math.exp(3.5-n[v][g]/300))-.05,d=m.PSY.mask_adjust-f):(f=2.56/(1+Math.exp(3.5-n[v][g]/300))-.14,d=m.PSY.mask_adjust_short-f),m.masking_lower=Math.pow(10,.1*d),init_outer_loop(m,E),u[v][g]=o.calc_xmin(e,a[v][g],E,i[v][g]),0!=u[v][g]&&(_=0),s[v][g]=126,p+=c[v][g]}}for(v=0;v<m.mode_gr;v++)for(g=0;g<m.channels_out;g++)p>l[m.VBR_max_bitrate]&&(c[v][g]*=l[m.VBR_max_bitrate],c[v][g]/=p),s[v][g]>c[v][g]&&(s[v][g]=c[v][g]);return _},this.bitpressure_strategy=function(e,t,n,o){for(var r=0;r<e.mode_gr;r++)for(var a=0;a<e.channels_out;a++){for(var i=e.l3_side.tt[r][a],l=t[r][a],s=0,c=0;c<i.psy_lmax;c++)l[s++]*=1+.029*c*c/L.SBMAX_l/L.SBMAX_l;if(i.block_type==L.SHORT_TYPE)for(c=i.sfb_smin;c<L.SBMAX_s;c++)l[s++]*=1+.029*c*c/L.SBMAX_s/L.SBMAX_s,l[s++]*=1+.029*c*c/L.SBMAX_s/L.SBMAX_s,l[s++]*=1+.029*c*c/L.SBMAX_s/L.SBMAX_s;o[r][a]=0|Math.max(n[r][a],.9*o[r][a])}},this.VBR_new_prepare=function(e,n,r,a,i,l){var s,c=e.internal_flags,u=1,d=0,m=0;if(e.free_format)c.bitrate_index=0,f=new y(d),s=t.ResvFrameBegin(e,f),d=f.bits,i[0]=s;else{c.bitrate_index=c.VBR_max_bitrate;var f=new y(d);t.ResvFrameBegin(e,f),d=f.bits,get_framebits(e,i),s=i[c.VBR_max_bitrate]}for(var _=0;_<c.mode_gr;_++){o.on_pe(e,n,l[_],d,_,0),c.mode_ext==L.MPG_MD_MS_LR&&ms_convert(c.l3_side,_);for(var p=0;p<c.channels_out;++p){var h=c.l3_side.tt[_][p];c.masking_lower=Math.pow(10,.1*c.PSY.mask_adjust),init_outer_loop(c,h),0!=o.calc_xmin(e,r[_][p],h,a[_][p])&&(u=0),m+=l[_][p]}}for(_=0;_<c.mode_gr;_++)for(p=0;p<c.channels_out;p++)m>s&&(l[_][p]*=s,l[_][p]/=m);return u},this.calc_target_bits=function(n,r,a,i,l,s){var c,u,d,m,f=n.internal_flags,_=f.l3_side,p=0;f.bitrate_index=f.VBR_max_bitrate;var h=new y(p);for(s[0]=t.ResvFrameBegin(n,h),p=h.bits,f.bitrate_index=1,p=e.getframebits(n)-8*f.sideinfo_len,l[0]=p/(f.mode_gr*f.channels_out),p=n.VBR_mean_bitrate_kbps*n.framesize*1e3,0!=(1&f.substep_shaping)&&(p*=1.09),p/=n.out_samplerate,p-=8*f.sideinfo_len,p/=f.mode_gr*f.channels_out,(c=.93+.07*(11-n.compression_ratio)/5.5)<.9&&(c=.9),c>1&&(c=1),u=0;u<f.mode_gr;u++){var v=0;for(d=0;d<f.channels_out;d++){if(i[u][d]=int(c*p),r[u][d]>700){var b=int((r[u][d]-700)/1.4),g=_.tt[u][d];i[u][d]=int(c*p),g.block_type==L.SHORT_TYPE&&b<p/2&&(b=p/2),b>3*p/2?b=3*p/2:b<0&&(b=0),i[u][d]+=b}i[u][d]>Y.MAX_BITS_PER_CHANNEL&&(i[u][d]=Y.MAX_BITS_PER_CHANNEL),v+=i[u][d]}if(v>Y.MAX_BITS_PER_GRANULE)for(d=0;d<f.channels_out;++d)i[u][d]*=Y.MAX_BITS_PER_GRANULE,i[u][d]/=v}if(f.mode_ext==L.MPG_MD_MS_LR)for(u=0;u<f.mode_gr;u++)o.reduce_side(i[u],a[u],p*f.channels_out,Y.MAX_BITS_PER_GRANULE);for(m=0,u=0;u<f.mode_gr;u++)for(d=0;d<f.channels_out;d++)i[u][d]>Y.MAX_BITS_PER_CHANNEL&&(i[u][d]=Y.MAX_BITS_PER_CHANNEL),m+=i[u][d];if(m>s[0])for(u=0;u<f.mode_gr;u++)for(d=0;d<f.channels_out;d++)i[u][d]*=s[0],i[u][d]/=m}}function V(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*c.SQRT2*.5/2384e-9,.017876148*c.SQRT2*.5/2384e-9,.003134727*c.SQRT2*.5/2384e-9,.002457142*c.SQRT2*.5/2384e-9,971317e-9*c.SQRT2*.5/2384e-9,218868e-9*c.SQRT2*.5/2384e-9,101566e-9*c.SQRT2*.5/2384e-9,13828e-9*c.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],o=t[L.SHORT_TYPE],r=t[L.SHORT_TYPE],a=t[L.SHORT_TYPE],i=t[L.SHORT_TYPE],u=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function d(t,n,o){for(var r,a,i,l=10,s=n+238-14-286,u=-15;u<0;u++){var d,m,f;d=e[l+-10],m=t[s+-224]*d,f=t[n+224]*d,d=e[l+-9],m+=t[s+-160]*d,f+=t[n+160]*d,d=e[l+-8],m+=t[s+-96]*d,f+=t[n+96]*d,d=e[l+-7],m+=t[s+-32]*d,f+=t[n+32]*d,d=e[l+-6],m+=t[s+32]*d,f+=t[n+-32]*d,d=e[l+-5],m+=t[s+96]*d,f+=t[n+-96]*d,d=e[l+-4],m+=t[s+160]*d,f+=t[n+-160]*d,d=e[l+-3],m+=t[s+224]*d,f+=t[n+-224]*d,d=e[l+-2],m+=t[n+-256]*d,f-=t[s+256]*d,d=e[l+-1],m+=t[n+-192]*d,f-=t[s+192]*d,d=e[l+0],m+=t[n+-128]*d,f-=t[s+128]*d,d=e[l+1],m+=t[n+-64]*d,f-=t[s+64]*d,d=e[l+2],m+=t[n+0]*d,f-=t[s+0]*d,d=e[l+3],m+=t[n+64]*d,f-=t[s+-64]*d,d=e[l+4],m+=t[n+128]*d,f-=t[s+-128]*d,d=e[l+5],m+=t[n+192]*d,d=(f-=t[s+-192]*d)-(m*=e[l+6]),o[30+2*u]=f+m,o[31+2*u]=e[l+7]*d,l+=18,n--,s++}f=t[n+-16]*e[l+-10],m=t[n+-32]*e[l+-2],f+=(t[n+-48]-t[n+16])*e[l+-9],m+=t[n+-96]*e[l+-1],f+=(t[n+-80]+t[n+48])*e[l+-8],m+=t[n+-160]*e[l+0],f+=(t[n+-112]-t[n+80])*e[l+-7],m+=t[n+-224]*e[l+1],f+=(t[n+-144]+t[n+112])*e[l+-6],m-=t[n+32]*e[l+2],f+=(t[n+-176]-t[n+144])*e[l+-5],m-=t[n+96]*e[l+3],f+=(t[n+-208]+t[n+176])*e[l+-4],m-=t[n+160]*e[l+4],f+=(t[n+-240]-t[n+208])*e[l+-3],r=(m-=t[n+224])-f,a=m+f,f=o[14],m=o[15]-f,o[31]=a+f,o[30]=r+m,o[15]=r-m,o[14]=a-f,i=o[28]-o[0],o[0]+=o[28],o[28]=i*e[l+-36+7],i=o[29]-o[1],o[1]+=o[29],o[29]=i*e[l+-36+7],i=o[26]-o[2],o[2]+=o[26],o[26]=i*e[l+-72+7],i=o[27]-o[3],o[3]+=o[27],o[27]=i*e[l+-72+7],i=o[24]-o[4],o[4]+=o[24],o[24]=i*e[l+-108+7],i=o[25]-o[5],o[5]+=o[25],o[25]=i*e[l+-108+7],i=o[22]-o[6],o[6]+=o[22],o[22]=i*c.SQRT2,i=o[23]-o[7],o[7]+=o[23],o[23]=i*c.SQRT2-o[7],o[7]-=o[6],o[22]-=o[7],o[23]-=o[22],i=o[6],o[6]=o[31]-i,o[31]=o[31]+i,i=o[7],o[7]=o[30]-i,o[30]=o[30]+i,i=o[22],o[22]=o[15]-i,o[15]=o[15]+i,i=o[23],o[23]=o[14]-i,o[14]=o[14]+i,i=o[20]-o[8],o[8]+=o[20],o[20]=i*e[l+-180+7],i=o[21]-o[9],o[9]+=o[21],o[21]=i*e[l+-180+7],i=o[18]-o[10],o[10]+=o[18],o[18]=i*e[l+-216+7],i=o[19]-o[11],o[11]+=o[19],o[19]=i*e[l+-216+7],i=o[16]-o[12],o[12]+=o[16],o[16]=i*e[l+-252+7],i=o[17]-o[13],o[13]+=o[17],o[17]=i*e[l+-252+7],i=-o[20]+o[24],o[20]+=o[24],o[24]=i*e[l+-216+7],i=-o[21]+o[25],o[21]+=o[25],o[25]=i*e[l+-216+7],i=o[4]-o[8],o[4]+=o[8],o[8]=i*e[l+-216+7],i=o[5]-o[9],o[5]+=o[9],o[9]=i*e[l+-216+7],i=o[0]-o[12],o[0]+=o[12],o[12]=i*e[l+-72+7],i=o[1]-o[13],o[1]+=o[13],o[13]=i*e[l+-72+7],i=o[16]-o[28],o[16]+=o[28],o[28]=i*e[l+-72+7],i=-o[17]+o[29],o[17]+=o[29],o[29]=i*e[l+-72+7],i=c.SQRT2*(o[2]-o[10]),o[2]+=o[10],o[10]=i,i=c.SQRT2*(o[3]-o[11]),o[3]+=o[11],o[11]=i,i=c.SQRT2*(-o[18]+o[26]),o[18]+=o[26],o[26]=i-o[18],i=c.SQRT2*(-o[19]+o[27]),o[19]+=o[27],o[27]=i-o[19],i=o[2],o[19]-=o[3],o[3]-=i,o[2]=o[31]-i,o[31]+=i,i=o[3],o[11]-=o[19],o[18]-=i,o[3]=o[30]-i,o[30]+=i,i=o[18],o[27]-=o[11],o[19]-=i,o[18]=o[15]-i,o[15]+=i,i=o[19],o[10]-=i,o[19]=o[14]-i,o[14]+=i,i=o[10],o[11]-=i,o[10]=o[23]-i,o[23]+=i,i=o[11],o[26]-=i,o[11]=o[22]-i,o[22]+=i,i=o[26],o[27]-=i,o[26]=o[7]-i,o[7]+=i,i=o[27],o[27]=o[6]-i,o[6]+=i,i=c.SQRT2*(o[0]-o[4]),o[0]+=o[4],o[4]=i,i=c.SQRT2*(o[1]-o[5]),o[1]+=o[5],o[5]=i,i=c.SQRT2*(o[16]-o[20]),o[16]+=o[20],o[20]=i,i=c.SQRT2*(o[17]-o[21]),o[17]+=o[21],o[21]=i,i=-c.SQRT2*(o[8]-o[12]),o[8]+=o[12],o[12]=i-o[8],i=-c.SQRT2*(o[9]-o[13]),o[9]+=o[13],o[13]=i-o[9],i=-c.SQRT2*(o[25]-o[29]),o[25]+=o[29],o[29]=i-o[25],i=-c.SQRT2*(o[24]+o[28]),o[24]-=o[28],o[28]=i-o[24],i=o[24]-o[16],o[24]=i,i=o[20]-i,o[20]=i,i=o[28]-i,o[28]=i,i=o[25]-o[17],o[25]=i,i=o[21]-i,o[21]=i,i=o[29]-i,o[29]=i,i=o[17]-o[1],o[17]=i,i=o[9]-i,o[9]=i,i=o[25]-i,o[25]=i,i=o[5]-i,o[5]=i,i=o[21]-i,o[21]=i,i=o[13]-i,o[13]=i,i=o[29]-i,o[29]=i,i=o[1]-o[0],o[1]=i,i=o[16]-i,o[16]=i,i=o[17]-i,o[17]=i,i=o[8]-i,o[8]=i,i=o[9]-i,o[9]=i,i=o[24]-i,o[24]=i,i=o[25]-i,o[25]=i,i=o[4]-i,o[4]=i,i=o[5]-i,o[5]=i,i=o[20]-i,o[20]=i,i=o[21]-i,o[21]=i,i=o[12]-i,o[12]=i,i=o[13]-i,o[13]=i,i=o[28]-i,o[28]=i,i=o[29]-i,o[29]=i,i=o[0],o[0]+=o[31],o[31]-=i,i=o[1],o[1]+=o[30],o[30]-=i,i=o[16],o[16]+=o[15],o[15]-=i,i=o[17],o[17]+=o[14],o[14]-=i,i=o[8],o[8]+=o[23],o[23]-=i,i=o[9],o[9]+=o[22],o[22]-=i,i=o[24],o[24]+=o[7],o[7]-=i,i=o[25],o[25]+=o[6],o[6]-=i,i=o[4],o[4]+=o[27],o[27]-=i,i=o[5],o[5]+=o[26],o[26]-=i,i=o[20],o[20]+=o[11],o[11]-=i,i=o[21],o[21]+=o[10],o[10]-=i,i=o[12],o[12]+=o[19],o[19]-=i,i=o[13],o[13]+=o[18],o[18]-=i,i=o[28],o[28]+=o[3],o[3]-=i,i=o[29],o[29]+=o[2],o[2]-=i}function m(e,n){for(var o=0;o<3;o++){var r,a,i,l,s,c;a=(l=e[n+6]*t[L.SHORT_TYPE][0]-e[n+15])+(r=e[n+0]*t[L.SHORT_TYPE][2]-e[n+9]),i=l-r,s=(l=e[n+15]*t[L.SHORT_TYPE][0]+e[n+6])+(r=e[n+9]*t[L.SHORT_TYPE][2]+e[n+0]),c=-l+r,r=2069978111953089e-26*(e[n+3]*t[L.SHORT_TYPE][1]-e[n+12]),l=2069978111953089e-26*(e[n+12]*t[L.SHORT_TYPE][1]+e[n+3]),e[n+0]=190752519173728e-25*a+r,e[n+15]=190752519173728e-25*-s+l,i=.8660254037844387*i*1907525191737281e-26,s=.5*s*1907525191737281e-26+l,e[n+3]=i-s,e[n+6]=i+s,a=.5*a*1907525191737281e-26-r,c=.8660254037844387*c*1907525191737281e-26,e[n+9]=a+c,e[n+12]=a-c,n++}}this.mdct_sub48=function(e,c,f){for(var _,p,h,v,b,g,E,S,k,y,T,B,A,I,R,M,w,C,x,F,N,D=c,V=286,O=0;O<e.channels_out;O++){for(var P=0;P<e.mode_gr;P++){for(var H,U=e.l3_side.tt[P][O],q=U.xr,Y=0,X=e.sb_sample[O][1-P],j=0,G=0;G<9;G++)for(d(D,V,X[j]),d(D,V+32,X[j+1]),j+=2,V+=64,H=1;H<32;H+=2)X[j-1][H]*=-1;for(H=0;H<32;H++,Y+=18){var $=U.block_type,z=e.sb_sample[O][P],K=e.sb_sample[O][1-P];if(0!=U.mixed_block_flag&&H<2&&($=0),e.amp_filter[H]<1e-12)l.fill(q,Y+0,Y+18,0);else{if(e.amp_filter[H]<1)for(G=0;G<18;G++)K[G][u[H]]*=e.amp_filter[H];if($==L.SHORT_TYPE){for(G=-3;G<0;G++){var W=t[L.SHORT_TYPE][G+3];q[Y+3*G+9]=z[9+G][u[H]]*W-z[8-G][u[H]],q[Y+3*G+18]=z[14-G][u[H]]*W+z[15+G][u[H]],q[Y+3*G+10]=z[15+G][u[H]]*W-z[14-G][u[H]],q[Y+3*G+19]=K[2-G][u[H]]*W+K[3+G][u[H]],q[Y+3*G+11]=K[3+G][u[H]]*W-K[2-G][u[H]],q[Y+3*G+20]=K[8-G][u[H]]*W+K[9+G][u[H]]}m(q,Y)}else{var Q=n(18);for(G=-9;G<0;G++){var Z,J;Z=t[$][G+27]*K[G+9][u[H]]+t[$][G+36]*K[8-G][u[H]],J=t[$][G+9]*z[G+9][u[H]]-t[$][G+18]*z[8-G][u[H]],Q[G+9]=Z-J*o[3+G+9],Q[G+18]=Z*o[3+G+9]+J}_=q,p=Y,v=void 0,b=void 0,void 0,void 0,void 0,void 0,void 0,T=void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,x=void 0,void 0,void 0,g=(h=Q)[17]-h[9],S=h[15]-h[11],k=h[14]-h[12],y=h[0]+h[8],T=h[1]+h[7],B=h[2]+h[6],A=h[3]+h[5],_[p+17]=y+B-A-(T-h[4]),b=(y+B-A)*r[19]+(T-h[4]),v=(g-S-k)*r[18],_[p+5]=v+b,_[p+6]=v-b,E=(h[16]-h[10])*r[18],T=T*r[19]+h[4],v=g*r[12]+E+S*r[13]+k*r[14],b=-y*r[16]+T-B*r[17]+A*r[15],_[p+1]=v+b,_[p+2]=v-b,v=g*r[13]-E-S*r[14]+k*r[12],b=-y*r[17]+T-B*r[15]+A*r[16],_[p+9]=v+b,_[p+10]=v-b,v=g*r[14]-E+S*r[12]-k*r[13],b=y*r[15]-T+B*r[16]-A*r[17],_[p+13]=v+b,_[p+14]=v-b,I=h[8]-h[0],M=h[6]-h[2],w=h[5]-h[3],C=h[17]+h[9],x=h[16]+h[10],F=h[15]+h[11],N=h[14]+h[12],_[p+0]=C+F+N+(x+h[13]),v=(C+F+N)*r[19]-(x+h[13]),b=(I-M+w)*r[18],_[p+11]=v+b,_[p+12]=v-b,R=(h[7]-h[1])*r[18],x=h[13]-x*r[19],v=C*r[15]-x+F*r[16]+N*r[17],b=I*r[14]+R+M*r[12]+w*r[13],_[p+3]=v+b,_[p+4]=v-b,v=-C*r[17]+x-F*r[15]-N*r[16],b=I*r[13]+R-M*r[14]-w*r[12],_[p+7]=v+b,_[p+8]=v-b,v=-C*r[16]+x-F*r[17]-N*r[15],b=I*r[12]-R+M*r[13]-w*r[14],_[p+15]=v+b,_[p+16]=v-b}}if($!=L.SHORT_TYPE&&0!=H)for(G=7;G>=0;--G){var ee,te;ee=q[Y+G]*a[20+G]+q[Y+-1-G]*i[28+G],te=q[Y+G]*i[28+G]-q[Y+-1-G]*a[20+G],q[Y+-1-G]=ee,q[Y+G]=te}}}if(D=f,V=286,1==e.mode_gr)for(var ne=0;ne<18;ne++)s.arraycopy(e.sb_sample[O][1][ne],0,e.sb_sample[O][0][ne],0,32)}}}function O(){this.thm=new q,this.en=new q}function L(){var e=L.FFTOFFSET,r=L.MPG_MD_MS_LR,a=null;this.psy=null;var l=null,c=null,u=null;this.setModules=function(e,t,n,o){a=e,this.psy=t,l=t,c=o,u=n};var d=new V;this.lame_encode_mp3_frame=function(_,p,h,v,b,g){var E,S=i([2,2]);S[0][0]=new O,S[0][1]=new O,S[1][0]=new O,S[1][1]=new O;var k,y=i([2,2]);y[0][0]=new O,y[0][1]=new O,y[1][0]=new O,y[1][1]=new O;var T,B,A,I=[null,null],R=_.internal_flags,M=o([2,4]),w=[.5,.5],C=[[0,0],[0,0]],x=[[0,0],[0,0]];if(I[0]=p,I[1]=h,0==R.lame_encode_frame_init&&function(e,t){var o,r,a=e.internal_flags;if(0==a.lame_encode_frame_init){var i,l,s=n(2014),c=n(2014);for(a.lame_encode_frame_init=1,i=0,l=0;i<286+576*(1+a.mode_gr);++i)i<576*a.mode_gr?(s[i]=0,2==a.channels_out&&(c[i]=0)):(s[i]=t[0][l],2==a.channels_out&&(c[i]=t[1][l]),++l);for(r=0;r<a.mode_gr;r++)for(o=0;o<a.channels_out;o++)a.l3_side.tt[r][o].block_type=L.SHORT_TYPE;d.mdct_sub48(a,s,c)}}(_,I),R.padding=0,(R.slot_lag-=R.frac_SpF)<0&&(R.slot_lag+=_.out_samplerate,R.padding=1),0!=R.psymodel){var F=[null,null],N=0,D=t(2);for(A=0;A<R.mode_gr;A++){for(B=0;B<R.channels_out;B++)F[B]=I[B],N=576+576*A-L.FFTOFFSET;if(0!=(_.VBR==m.vbr_mtrh||_.VBR==m.vbr_mt?l.L3psycho_anal_vbr(_,F,N,A,S,y,C[A],x[A],M[A],D):l.L3psycho_anal_ns(_,F,N,A,S,y,C[A],x[A],M[A],D)))return-4;for(_.mode==f.JOINT_STEREO&&(w[A]=M[A][2]+M[A][3],w[A]>0&&(w[A]=M[A][3]/w[A])),B=0;B<R.channels_out;B++){var V=R.l3_side.tt[A][B];V.block_type=D[B],V.mixed_block_flag=0}}}else for(A=0;A<R.mode_gr;A++)for(B=0;B<R.channels_out;B++)R.l3_side.tt[A][B].block_type=L.NORM_TYPE,R.l3_side.tt[A][B].mixed_block_flag=0,x[A][B]=C[A][B]=700;if(function(e){var t,n;if(0!=e.ATH.useAdjust)if(n=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(n+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(n+=n,t+=t),2==e.mode_gr&&(n=Math.max(n,t)),n*=.5,(n*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var o=31.98*n+625e-6;e.ATH.adjust>=o?(e.ATH.adjust*=.075*o+.925,e.ATH.adjust<o&&(e.ATH.adjust=o)):e.ATH.adjustLimit>=o?e.ATH.adjust=o:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=o}else e.ATH.adjust=1}(R),d.mdct_sub48(R,I[0],I[1]),R.mode_ext=L.MPG_MD_LR_LR,_.force_ms)R.mode_ext=L.MPG_MD_MS_LR;else if(_.mode==f.JOINT_STEREO){var P=0,H=0;for(A=0;A<R.mode_gr;A++)for(B=0;B<R.channels_out;B++)P+=x[A][B],H+=C[A][B];if(P<=1*H){var U=R.l3_side.tt[0],q=R.l3_side.tt[R.mode_gr-1];U[0].block_type==U[1].block_type&&q[0].block_type==q[1].block_type&&(R.mode_ext=L.MPG_MD_MS_LR)}}if(R.mode_ext==r?(k=y,T=x):(k=S,T=C),_.analysis&&null!=R.pinfo)for(A=0;A<R.mode_gr;A++)for(B=0;B<R.channels_out;B++)R.pinfo.ms_ratio[A]=R.ms_ratio[A],R.pinfo.ms_ener_ratio[A]=w[A],R.pinfo.blocktype[A][B]=R.l3_side.tt[A][B].block_type,R.pinfo.pe[A][B]=T[A][B],s.arraycopy(R.l3_side.tt[A][B].xr,0,R.pinfo.xr[A][B],0,576),R.mode_ext==r&&(R.pinfo.ers[A][B]=R.pinfo.ers[A][B+2],s.arraycopy(R.pinfo.energy[A][B+2],0,R.pinfo.energy[A][B],0,R.pinfo.energy[A][B].length));if(_.VBR==m.vbr_off||_.VBR==m.vbr_abr){var Y,X;for(Y=0;Y<18;Y++)R.nsPsy.pefirbuf[Y]=R.nsPsy.pefirbuf[Y+1];for(X=0,A=0;A<R.mode_gr;A++)for(B=0;B<R.channels_out;B++)X+=T[A][B];for(R.nsPsy.pefirbuf[18]=X,X=R.nsPsy.pefirbuf[9],Y=0;Y<9;Y++)X+=(R.nsPsy.pefirbuf[Y]+R.nsPsy.pefirbuf[18-Y])*L.fircoef[Y];for(X=3350*R.mode_gr*R.channels_out/X,A=0;A<R.mode_gr;A++)for(B=0;B<R.channels_out;B++)T[A][B]*=X}if(R.iteration_loop.iteration_loop(_,T,w,k),a.format_bitstream(_),E=a.copy_buffer(R,v,b,g,1),_.bWriteVbrTag&&c.addVbrFrame(_),_.analysis&&null!=R.pinfo){for(B=0;B<R.channels_out;B++){var j;for(j=0;j<e;j++)R.pinfo.pcmdata[B][j]=R.pinfo.pcmdata[B][j+_.framesize];for(j=e;j<1600;j++)R.pinfo.pcmdata[B][j]=I[B][j-e]}u.set_frame_pinfo(_,k)}return function(e){var t,n;for(e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(n=0;n<e.channels_out;++n){var o=0|e.l3_side.tt[t][n].block_type;0!=e.l3_side.tt[t][n].mixed_block_flag&&(o=4),e.bitrate_blockType_Hist[e.bitrate_index][o]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][o]++,e.bitrate_blockType_Hist[15][5]++}}(R),E}}function P(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function H(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[t(4),t(4)];for(var e=0;e<2;e++)for(var n=0;n<2;n++)this.tt[e][n]=new F}function U(){this.last_en_subshort=o([4,9]),this.lastAttacks=t(4),this.pefirbuf=n(19),this.longfact=n(L.SBMAX_l),this.shortfact=n(L.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function q(){this.l=n(L.SBMAX_l),this.s=o([L.SBMAX_s,3]);var e=this;this.assign=function(t){s.arraycopy(t.l,0,e.l,0,L.SBMAX_l);for(var n=0;n<L.SBMAX_s;n++)for(var o=0;o<3;o++)e.s[n][o]=t.s[n][o]}}function Y(){function a(){this.write_timing=0,this.ptr=0,this.buf=e(40)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=o([2,Y.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new H,this.ms_ratio=n(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=t(2),this.CurrentStep=t(2),this.masking_lower=0,this.bv_scf=t(576),this.pseudohalf=t(N.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Y.BPC+1),this.itime=function(e){return new Float64Array(e)}(2),this.sideinfo_len=0,this.sb_sample=o([2,2,18,L.SBLIMIT]),this.amp_filter=n(32),this.header=new Array(Y.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new w,this.minval_l=n(L.CBANDS),this.minval_s=n(L.CBANDS),this.nb_1=o([4,L.CBANDS]),this.nb_2=o([4,L.CBANDS]),this.nb_s1=o([4,L.CBANDS]),this.nb_s2=o([4,L.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=n(4),this.loudness_sq=o([2,2]),this.loudness_sq_save=n(2),this.mld_l=n(L.SBMAX_l),this.mld_s=n(L.SBMAX_s),this.bm_l=t(L.SBMAX_l),this.bo_l=t(L.SBMAX_l),this.bm_s=t(L.SBMAX_s),this.bo_s=t(L.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=r([L.CBANDS,2]),this.s3ind_s=r([L.CBANDS,2]),this.numlines_s=t(L.CBANDS),this.numlines_l=t(L.CBANDS),this.rnumlines_l=n(L.CBANDS),this.mld_cb_l=n(L.CBANDS),this.mld_cb_s=n(L.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=n(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=t(2),this.nsPsy=new U,this.VBR_seek_table=new P,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=r([16,5]),this.bitrate_blockType_Hist=r([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var i=0;i<this.en.length;i++)this.en[i]=new q;for(i=0;i<this.thm.length;i++)this.thm[i]=new q;for(i=0;i<this.header.length;i++)this.header[i]=new a}function X(){var e=n(L.BLKSIZE),t=n(L.BLKSIZE_s/2),o=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(e,t,n){var r,a,i,l=0,s=t+(n<<=1);r=4;do{var u,d,m,f,_,p,h;h=r>>1,p=(_=r<<1)+(f=r),r=_<<1,i=(a=t)+h;do{y=e[a+0]-e[a+f],k=e[a+0]+e[a+f],I=e[a+_]-e[a+p],B=e[a+_]+e[a+p],e[a+_]=k-B,e[a+0]=k+B,e[a+p]=y-I,e[a+f]=y+I,y=e[i+0]-e[i+f],k=e[i+0]+e[i+f],I=c.SQRT2*e[i+p],B=c.SQRT2*e[i+_],e[i+_]=k-B,e[i+0]=k+B,e[i+p]=y-I,e[i+f]=y+I,i+=r,a+=r}while(a<s);for(d=o[l+0],u=o[l+1],m=1;m<h;m++){var v,b;v=1-2*u*u,b=2*u*d,a=t+m,i=t+f-m;do{var g,E,S,k,y,T,B,A,I,R;E=b*e[a+f]-v*e[i+f],g=v*e[a+f]+b*e[i+f],y=e[a+0]-g,k=e[a+0]+g,T=e[i+0]-E,S=e[i+0]+E,E=b*e[a+p]-v*e[i+p],g=v*e[a+p]+b*e[i+p],I=e[a+_]-g,B=e[a+_]+g,R=e[i+_]-E,A=e[i+_]+E,E=u*B-d*R,g=d*B+u*R,e[a+_]=k-g,e[a+0]=k+g,e[i+p]=T-E,e[i+f]=T+E,E=d*A-u*I,g=u*A+d*I,e[i+_]=S-g,e[i+0]=S+g,e[a+p]=y-E,e[a+f]=y+E,i+=r,a+=r}while(a<s);d=(v=d)*o[l+0]-u*o[l+1],u=v*o[l+1]+u*o[l+0]}l+=2}while(r<n)}var a=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,n,o,i,l){for(var s=0;s<3;s++){var c=L.BLKSIZE_s/2,u=65535&192*(s+1),d=L.BLKSIZE_s/8-1;do{var m,f,_,p,h,v=255&a[d<<2];f=(m=t[v]*i[o][l+v+u])-(h=t[127-v]*i[o][l+v+u+128]),m+=h,p=(_=t[v+64]*i[o][l+v+u+64])-(h=t[63-v]*i[o][l+v+u+192]),_+=h,c-=4,n[s][c+0]=m+_,n[s][c+2]=m-_,n[s][c+1]=f+p,n[s][c+3]=f-p,f=(m=t[v+1]*i[o][l+v+u+1])-(h=t[126-v]*i[o][l+v+u+129]),m+=h,p=(_=t[v+65]*i[o][l+v+u+65])-(h=t[62-v]*i[o][l+v+u+193]),_+=h,n[s][c+L.BLKSIZE_s/2+0]=m+_,n[s][c+L.BLKSIZE_s/2+2]=m-_,n[s][c+L.BLKSIZE_s/2+1]=f+p,n[s][c+L.BLKSIZE_s/2+3]=f-p}while(--d>=0);r(n[s],c,L.BLKSIZE_s/2)}},this.fft_long=function(t,n,o,i,l){var s=L.BLKSIZE/8-1,c=L.BLKSIZE/2;do{var u,d,m,f,_,p=255&a[s];d=(u=e[p]*i[o][l+p])-(_=e[p+512]*i[o][l+p+512]),u+=_,f=(m=e[p+256]*i[o][l+p+256])-(_=e[p+768]*i[o][l+p+768]),m+=_,n[0+(c-=4)]=u+m,n[c+2]=u-m,n[c+1]=d+f,n[c+3]=d-f,d=(u=e[p+1]*i[o][l+p+1])-(_=e[p+513]*i[o][l+p+513]),u+=_,f=(m=e[p+257]*i[o][l+p+257])-(_=e[p+769]*i[o][l+p+769]),m+=_,n[c+L.BLKSIZE/2+0]=u+m,n[c+L.BLKSIZE/2+2]=u-m,n[c+L.BLKSIZE/2+1]=d+f,n[c+L.BLKSIZE/2+3]=d-f}while(--s>=0);r(n,c,L.BLKSIZE/2)},this.init_fft=function(n){for(var o=0;o<L.BLKSIZE;o++)e[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/L.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/L.BLKSIZE);for(o=0;o<L.BLKSIZE_s/2;o++)t[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/L.BLKSIZE_s))}}function j(){var e=new X,r=2.302585092994046,a=1/217621504/(L.BLKSIZE/2),i=.3,s=21,_=.2302585093;function p(e,t){for(var n=0,o=0;o<L.BLKSIZE/2;++o)n+=e[o]*t.ATH.eql_w[o];return n*a}function h(t,n,o,r,a,i,l,s,u,d,m){var f=t.internal_flags;if(u<2)e.fft_long(f,r[a],u,d,m),e.fft_short(f,i[l],u,d,m);else if(2==u){for(var _=L.BLKSIZE-1;_>=0;--_){var h=r[a+0][_],v=r[a+1][_];r[a+0][_]=(h+v)*c.SQRT2*.5,r[a+1][_]=(h-v)*c.SQRT2*.5}for(var b=2;b>=0;--b)for(_=L.BLKSIZE_s-1;_>=0;--_)h=i[l+0][b][_],v=i[l+1][b][_],i[l+0][b][_]=(h+v)*c.SQRT2*.5,i[l+1][b][_]=(h-v)*c.SQRT2*.5}for(n[0]=r[a+0][0],n[0]*=n[0],_=L.BLKSIZE/2-1;_>=0;--_){var g=r[a+0][L.BLKSIZE/2-_],E=r[a+0][L.BLKSIZE/2+_];n[L.BLKSIZE/2-_]=.5*(g*g+E*E)}for(b=2;b>=0;--b)for(o[b][0]=i[l+0][b][0],o[b][0]*=o[b][0],_=L.BLKSIZE_s/2-1;_>=0;--_)g=i[l+0][b][L.BLKSIZE_s/2-_],E=i[l+0][b][L.BLKSIZE_s/2+_],o[b][L.BLKSIZE_s/2-_]=.5*(g*g+E*E);var S=0;for(_=11;_<L.HBLKSIZE;_++)S+=n[_];if(f.tot_ener[u]=S,t.analysis){for(_=0;_<L.HBLKSIZE;_++)f.pinfo.energy[s][u][_]=f.pinfo.energy_save[u][_],f.pinfo.energy_save[u][_]=n[_];f.pinfo.pe[s][u]=f.pe[u]}2==t.athaa_loudapprox&&u<2&&(f.loudness_sq[s][u]=f.loudness_sq_save[u],f.loudness_sq_save[u]=p(n,f))}var v,b,g,E=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],S=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],k=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],y=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function T(e,t,n,o,r,a){var i,l,s;if(t>e){if(!(t<e*b))return e+t;i=t/e}else{if(e>=t*b)return e+t;i=e/t}if(e+=t,o+3<=6){if(i>=v)return e;var u=0|c.FAST_LOG10_X(i,16);return e*k[u]}return u=0|c.FAST_LOG10_X(i,16),t=0!=a?r.ATH.cb_s[n]*r.ATH.adjust:r.ATH.cb_l[n]*r.ATH.adjust,e<g*t?e>t?(l=1,u<=13&&(l=y[u]),s=c.FAST_LOG10_X(e/t,10/15),e*((S[u]-l)*s+l)):u>13?e:e*y[u]:e*S[u]}var B=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function A(e,t,n){var o;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(o=t>e?t/e:e/t,-2<=n&&n<=2){if(o>=v)return e+t;var r=0|c.FAST_LOG10_X(o,16);return(e+t)*B[r]}return o<b?e+t:(e<t&&(e=t),e)}function I(e,t,n,o,r){var a,i,l=0,s=0;for(a=i=0;a<L.SBMAX_s;++i,++a){for(var c=e.bo_s[a],u=e.npart_s,d=c<u?c:u;i<d;)l+=t[i],s+=n[i],i++;if(e.en[o].s[a][r]=l,e.thm[o].s[a][r]=s,i>=u){++a;break}var m=e.PSY.bo_s_weight[a],f=1-m;l=m*t[i],s=m*n[i],e.en[o].s[a][r]+=l,e.thm[o].s[a][r]+=s,l=f*t[i],s=f*n[i]}for(;a<L.SBMAX_s;++a)e.en[o].s[a][r]=0,e.thm[o].s[a][r]=0}function R(e,t,n,o){var r,a,i=0,l=0;for(r=a=0;r<L.SBMAX_l;++a,++r){for(var s=e.bo_l[r],c=e.npart_l,u=s<c?s:c;a<u;)i+=t[a],l+=n[a],a++;if(e.en[o].l[r]=i,e.thm[o].l[r]=l,a>=c){++r;break}var d=e.PSY.bo_l_weight[r],m=1-d;i=d*t[a],l=d*n[a],e.en[o].l[r]+=i,e.thm[o].l[r]+=l,i=m*t[a],l=m*n[a]}for(;r<L.SBMAX_l;++r)e.en[o].l[r]=0,e.thm[o].l[r]=0}function M(e,t,n,o,r,a){var i,l,s=e.internal_flags;for(l=i=0;l<s.npart_s;++l){for(var c=0,u=s.numlines_s[l],d=0;d<u;++d,++i){c+=t[a][i]}n[l]=c}for(i=l=0;l<s.npart_s;l++){var m=s.s3ind_s[l][0],f=s.s3_ss[i++]*n[m];for(++m;m<=s.s3ind_s[l][1];)f+=s.s3_ss[i]*n[m],++i,++m;var _=2*s.nb_s1[r][l];if(o[l]=Math.min(f,_),s.blocktype_old[1&r]==L.SHORT_TYPE){_=16*s.nb_s2[r][l];var p=o[l];o[l]=Math.min(_,p)}s.nb_s2[r][l]=s.nb_s1[r][l],s.nb_s1[r][l]=f}for(;l<=L.CBANDS;++l)n[l]=0,o[l]=0}function w(e,t,n){return n>=1?e:n<=0?t:t>0?Math.pow(e/t,n)*t:0}var C=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function x(e,t){for(var n=309.07,o=0;o<L.SBMAX_s-1;o++)for(var a=0;a<3;a++){var i=e.thm.s[o][a];if(i>0){var l=i*t,s=e.en.s[o][a];s>l&&(n+=s>1e10*l?C[o]*(10*r):C[o]*c.FAST_LOG10(s/l))}}return n}var F=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function N(e,t){for(var n=281.0575,o=0;o<L.SBMAX_l-1;o++){var a=e.thm.l[o];if(a>0){var i=a*t,l=e.en.l[o];l>i&&(n+=l>1e10*i?F[o]*(10*r):F[o]*c.FAST_LOG10(l/i))}}return n}function D(e,t,n,o,r){var a,i;for(a=i=0;a<e.npart_l;++a){var l,s=0,c=0;for(l=0;l<e.numlines_l[a];++l,++i){var u=t[i];s+=u,c<u&&(c=u)}n[a]=s,o[a]=c,r[a]=s*e.rnumlines_l[a]}}function V(e,t,n,o){var r=E.length-1,a=0,i=n[a]+n[a+1];for(i>0?((l=t[a])<t[a+1]&&(l=t[a+1]),(s=0|(i=20*(2*l-i)/(i*(e.numlines_l[a]+e.numlines_l[a+1]-1))))>r&&(s=r),o[a]=s):o[a]=0,a=1;a<e.npart_l-1;a++){var l,s;(i=n[a-1]+n[a]+n[a+1])>0?((l=t[a-1])<t[a]&&(l=t[a]),l<t[a+1]&&(l=t[a+1]),(s=0|(i=20*(3*l-i)/(i*(e.numlines_l[a-1]+e.numlines_l[a]+e.numlines_l[a+1]-1))))>r&&(s=r),o[a]=s):o[a]=0}(i=n[a-1]+n[a])>0?((l=t[a-1])<t[a]&&(l=t[a]),(s=0|(i=20*(2*l-i)/(i*(e.numlines_l[a-1]+e.numlines_l[a]-1))))>r&&(s=r),o[a]=s):o[a]=0}var O=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function P(t,n,o,r,a,i,l,s){var u=t.internal_flags;if(r<2)e.fft_long(u,l[s],r,n,o);else if(2==r)for(var d=L.BLKSIZE-1;d>=0;--d){var m=l[s+0][d],f=l[s+1][d];l[s+0][d]=(m+f)*c.SQRT2*.5,l[s+1][d]=(m-f)*c.SQRT2*.5}for(i[0]=l[s+0][0],i[0]*=i[0],d=L.BLKSIZE/2-1;d>=0;--d){var _=l[s+0][L.BLKSIZE/2-d],p=l[s+0][L.BLKSIZE/2+d];i[L.BLKSIZE/2-d]=.5*(_*_+p*p)}var h=0;for(d=11;d<L.HBLKSIZE;d++)h+=i[d];if(u.tot_ener[r]=h,t.analysis){for(d=0;d<L.HBLKSIZE;d++)u.pinfo.energy[a][r][d]=u.pinfo.energy_save[r][d],u.pinfo.energy_save[r][d]=i[d];u.pinfo.pe[a][r]=u.pe[r]}}function H(t,n,o,r,a,i,l,s){var u=t.internal_flags;if(0==a&&r<2&&e.fft_short(u,l[s],r,n,o),2==r)for(var d=L.BLKSIZE_s-1;d>=0;--d){var m=l[s+0][a][d],f=l[s+1][a][d];l[s+0][a][d]=(m+f)*c.SQRT2*.5,l[s+1][a][d]=(m-f)*c.SQRT2*.5}for(i[a][0]=l[s+0][a][0],i[a][0]*=i[a][0],d=L.BLKSIZE_s/2-1;d>=0;--d){var _=l[s+0][a][L.BLKSIZE_s/2-d],p=l[s+0][a][L.BLKSIZE_s/2+d];i[a][L.BLKSIZE_s/2-d]=.5*(_*_+p*p)}}function U(e,t,n,o){var r=e.internal_flags;2==e.athaa_loudapprox&&n<2&&(r.loudness_sq[t][n]=r.loudness_sq_save[n],r.loudness_sq_save[n]=p(o,r))}this.L3psycho_anal_ns=function(e,r,a,c,d,_,p,v,b,g){var S,k,y,B,A,C,F,P,H,U,q=e.internal_flags,Y=o([2,L.BLKSIZE]),X=o([2,3,L.BLKSIZE_s]),j=n(L.CBANDS+1),G=n(L.CBANDS+1),$=n(L.CBANDS+2),z=t(2),K=t(2),W=o([2,576]),Q=t(L.CBANDS+2),Z=t(L.CBANDS+2);for(l.fill(Z,0),S=q.channels_out,e.mode==f.JOINT_STEREO&&(S=4),H=e.VBR==m.vbr_off?0==q.ResvMax?0:q.ResvSize/q.ResvMax*.5:e.VBR==m.vbr_rh||e.VBR==m.vbr_mtrh||e.VBR==m.vbr_mt?.6:1,k=0;k<q.channels_out;k++){var J=r[k],ee=a+576-350-s+192;for(B=0;B<576;B++){var te,ne;for(te=J[ee+B+10],ne=0,A=0;A<9;A+=2)te+=O[A]*(J[ee+B+A]+J[ee+B+s-A]),ne+=O[A+1]*(J[ee+B+A+1]+J[ee+B+s-A-1]);W[k][B]=te+ne}d[c][k].en.assign(q.en[k]),d[c][k].thm.assign(q.thm[k]),S>2&&(_[c][k].en.assign(q.en[k+2]),_[c][k].thm.assign(q.thm[k+2]))}for(k=0;k<S;k++){var oe,re=n(12),ae=[0,0,0,0],ie=n(12),le=1,se=n(L.CBANDS),ce=n(L.CBANDS),ue=[0,0,0,0],de=n(L.HBLKSIZE),me=o([3,L.HBLKSIZE_s]);for(B=0;B<3;B++)re[B]=q.nsPsy.last_en_subshort[k][B+6],ie[B]=re[B]/q.nsPsy.last_en_subshort[k][B+4],ae[0]+=re[B];if(2==k)for(B=0;B<576;B++){var fe,_e;fe=W[0][B],_e=W[1][B],W[0][B]=fe+_e,W[1][B]=fe-_e}var pe=W[1&k],he=0;for(B=0;B<9;B++){for(var ve=he+64,be=1;he<ve;he++)be<Math.abs(pe[he])&&(be=Math.abs(pe[he]));q.nsPsy.last_en_subshort[k][B]=re[B+3]=be,ae[1+B/3]+=be,be>re[B+3-2]?be/=re[B+3-2]:be=re[B+3-2]>10*be?re[B+3-2]/(10*be):0,ie[B+3]=be}if(e.analysis){var ge=ie[0];for(B=1;B<12;B++)ge<ie[B]&&(ge=ie[B]);q.pinfo.ers[c][k]=q.pinfo.ers_save[k],q.pinfo.ers_save[k]=ge}for(oe=3==k?q.nsPsy.attackthre_s:q.nsPsy.attackthre,B=0;B<12;B++)0==ue[B/3]&&ie[B]>oe&&(ue[B/3]=B%3+1);for(B=1;B<4;B++)(ae[B-1]>ae[B]?ae[B-1]/ae[B]:ae[B]/ae[B-1])<1.7&&(ue[B]=0,1==B&&(ue[0]=0));for(0!=ue[0]&&0!=q.nsPsy.lastAttacks[k]&&(ue[0]=0),3!=q.nsPsy.lastAttacks[k]&&ue[0]+ue[1]+ue[2]+ue[3]==0||(le=0,0!=ue[1]&&0!=ue[0]&&(ue[1]=0),0!=ue[2]&&0!=ue[1]&&(ue[2]=0),0!=ue[3]&&0!=ue[2]&&(ue[3]=0)),k<2?K[k]=le:0==le&&(K[0]=K[1]=0),b[k]=q.tot_ener[k],h(e,de,me,Y,1&k,X,1&k,c,k,r,a),D(q,de,j,se,ce),V(q,se,ce,Q),P=0;P<3;P++){var Ee,Se;for(M(e,me,G,$,k,P),I(q,G,$,k,P),F=0;F<L.SBMAX_s;F++){if(Se=q.thm[k].s[F][P],Se*=.8,ue[P]>=2||1==ue[P+1]){var ke=0!=P?P-1:2;be=w(q.thm[k].s[F][ke],Se,.6*H),Se=Math.min(Se,be)}1==ue[P]?(ke=0!=P?P-1:2,be=w(q.thm[k].s[F][ke],Se,i*H),Se=Math.min(Se,be)):(0!=P&&3==ue[P-1]||0==P&&3==q.nsPsy.lastAttacks[k])&&(ke=2!=P?P+1:0,be=w(q.thm[k].s[F][ke],Se,i*H),Se=Math.min(Se,be)),Ee=re[3*P+3]+re[3*P+4]+re[3*P+5],6*re[3*P+5]<Ee&&(Se*=.5,6*re[3*P+4]<Ee&&(Se*=.5)),q.thm[k].s[F][P]=Se}}for(q.nsPsy.lastAttacks[k]=ue[2],C=0,y=0;y<q.npart_l;y++){for(var ye=q.s3ind[y][0],Te=j[ye]*E[Q[ye]],Be=q.s3_ll[C++]*Te;++ye<=q.s3ind[y][1];)Te=j[ye]*E[Q[ye]],Be=T(Be,q.s3_ll[C++]*Te,ye,ye-y,q,0);Be*=.158489319246111,q.blocktype_old[1&k]==L.SHORT_TYPE?$[y]=Be:$[y]=w(Math.min(Be,Math.min(2*q.nb_1[k][y],16*q.nb_2[k][y])),Be,H),q.nb_2[k][y]=q.nb_1[k][y],q.nb_1[k][y]=Be}for(;y<=L.CBANDS;++y)j[y]=0,$[y]=0;R(q,j,$,k)}for(e.mode!=f.STEREO&&e.mode!=f.JOINT_STEREO||e.interChRatio>0&&function(e,t){var n=e.internal_flags;if(n.channels_out>1){for(var o=0;o<L.SBMAX_l;o++){var r=n.thm[0].l[o],a=n.thm[1].l[o];n.thm[0].l[o]+=a*t,n.thm[1].l[o]+=r*t}for(o=0;o<L.SBMAX_s;o++)for(var i=0;i<3;i++)r=n.thm[0].s[o][i],a=n.thm[1].s[o][i],n.thm[0].s[o][i]+=a*t,n.thm[1].s[o][i]+=r*t}}(e,e.interChRatio),e.mode==f.JOINT_STEREO&&(function(e){for(var t=0;t<L.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var n=e.mld_l[t]*e.en[3].l[t],o=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],n));n=e.mld_l[t]*e.en[2].l[t];var r=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],n));e.thm[2].l[t]=o,e.thm[3].l[t]=r}for(t=0;t<L.SBMAX_s;t++)for(var a=0;a<3;a++)e.thm[0].s[t][a]>1.58*e.thm[1].s[t][a]||e.thm[1].s[t][a]>1.58*e.thm[0].s[t][a]||(n=e.mld_s[t]*e.en[3].s[t][a],o=Math.max(e.thm[2].s[t][a],Math.min(e.thm[3].s[t][a],n)),n=e.mld_s[t]*e.en[2].s[t][a],r=Math.max(e.thm[3].s[t][a],Math.min(e.thm[2].s[t][a],n)),e.thm[2].s[t][a]=o,e.thm[3].s[t][a]=r)}(q),U=e.msfix,Math.abs(U)>0&&function(e,t,n){var o=t,r=Math.pow(10,n);t*=2,o*=2;for(var a=0;a<L.SBMAX_l;a++)u=e.ATH.cb_l[e.bm_l[a]]*r,(l=Math.min(Math.max(e.thm[0].l[a],u),Math.max(e.thm[1].l[a],u)))*t<(s=Math.max(e.thm[2].l[a],u))+(c=Math.max(e.thm[3].l[a],u))&&(s*=d=l*o/(s+c),c*=d),e.thm[2].l[a]=Math.min(s,e.thm[2].l[a]),e.thm[3].l[a]=Math.min(c,e.thm[3].l[a]);for(r*=L.BLKSIZE_s/L.BLKSIZE,a=0;a<L.SBMAX_s;a++)for(var i=0;i<3;i++){var l,s,c,u,d;u=e.ATH.cb_s[e.bm_s[a]]*r,(l=Math.min(Math.max(e.thm[0].s[a][i],u),Math.max(e.thm[1].s[a][i],u)))*t<(s=Math.max(e.thm[2].s[a][i],u))+(c=Math.max(e.thm[3].s[a][i],u))&&(s*=d=l*t/(s+c),c*=d),e.thm[2].s[a][i]=Math.min(e.thm[2].s[a][i],s),e.thm[3].s[a][i]=Math.min(e.thm[3].s[a][i],c)}}(q,U,e.ATHlower*q.ATH.adjust)),function(e,t,n,o){var r=e.internal_flags;e.short_blocks!=u.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var a=0;a<r.channels_out;a++)o[a]=L.NORM_TYPE,e.short_blocks==u.short_block_dispensed&&(t[a]=1),e.short_blocks==u.short_block_forced&&(t[a]=0),0!=t[a]?r.blocktype_old[a]==L.SHORT_TYPE&&(o[a]=L.STOP_TYPE):(o[a]=L.SHORT_TYPE,r.blocktype_old[a]==L.NORM_TYPE&&(r.blocktype_old[a]=L.START_TYPE),r.blocktype_old[a]==L.STOP_TYPE&&(r.blocktype_old[a]=L.SHORT_TYPE)),n[a]=r.blocktype_old[a],r.blocktype_old[a]=o[a]}(e,K,g,z),k=0;k<S;k++){var Ae,Ie,Re,Me=0;k>1?(Ae=v,Me=-2,Ie=L.NORM_TYPE,g[0]!=L.SHORT_TYPE&&g[1]!=L.SHORT_TYPE||(Ie=L.SHORT_TYPE),Re=_[c][k-2]):(Ae=p,Me=0,Ie=g[k],Re=d[c][k]),Ie==L.SHORT_TYPE?Ae[Me+k]=x(Re,q.masking_lower):Ae[Me+k]=N(Re,q.masking_lower),e.analysis&&(q.pinfo.pe[c][k]=Ae[Me+k])}return 0};var q=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function Y(e,t,n){if(0==n)for(var o=0;o<e.npart_s;o++)e.nb_s2[t][o]=e.nb_s1[t][o],e.nb_s1[t][o]=0}function j(e,t){for(var n=0;n<e.npart_l;n++)e.nb_2[t][n]=e.nb_1[t][n],e.nb_1[t][n]=0}function G(e,t,o,r,a,i){var l,s,c,u=e.internal_flags,d=new float[L.CBANDS],m=n(L.CBANDS),f=new int[L.CBANDS];for(c=s=0;c<u.npart_s;++c){var _=0,p=0,h=u.numlines_s[c];for(l=0;l<h;++l,++s){var v=t[i][s];_+=v,p<v&&(p=v)}o[c]=_,d[c]=p,m[c]=_/h}for(;c<L.CBANDS;++c)d[c]=0,m[c]=0;for(function(e,t,n,o){var r=E.length-1,a=0,i=n[a]+n[a+1];for(i>0?((l=t[a])<t[a+1]&&(l=t[a+1]),(s=0|(i=20*(2*l-i)/(i*(e.numlines_s[a]+e.numlines_s[a+1]-1))))>r&&(s=r),o[a]=s):o[a]=0,a=1;a<e.npart_s-1;a++){var l,s;(i=n[a-1]+n[a]+n[a+1])>0?((l=t[a-1])<t[a]&&(l=t[a]),l<t[a+1]&&(l=t[a+1]),(s=0|(i=20*(3*l-i)/(i*(e.numlines_s[a-1]+e.numlines_s[a]+e.numlines_s[a+1]-1))))>r&&(s=r),o[a]=s):o[a]=0}(i=n[a-1]+n[a])>0?((l=t[a-1])<t[a]&&(l=t[a]),(s=0|(i=20*(2*l-i)/(i*(e.numlines_s[a-1]+e.numlines_s[a]-1))))>r&&(s=r),o[a]=s):o[a]=0}(u,d,m,f),s=c=0;c<u.npart_s;c++){var b,g,S,k,y,T=u.s3ind_s[c][0],B=u.s3ind_s[c][1];for(b=f[T],g=1,k=u.s3_ss[s]*o[T]*E[f[T]],++s,++T;T<=B;)b+=f[T],g+=1,k=A(k,S=u.s3_ss[s]*o[T]*E[f[T]],T-c),++s,++T;k*=y=.5*E[b=(1+2*b)/(2*g)],r[c]=k,u.nb_s2[a][c]=u.nb_s1[a][c],u.nb_s1[a][c]=k,S=d[c],S*=u.minval_s[c],S*=y,r[c]>S&&(r[c]=S),u.masking_lower>1&&(r[c]*=u.masking_lower),r[c]>o[c]&&(r[c]=o[c]),u.masking_lower<1&&(r[c]*=u.masking_lower)}for(;c<L.CBANDS;++c)o[c]=0,r[c]=0}function $(e,o,r,a,l){var s,c=n(L.CBANDS),u=n(L.CBANDS),d=t(L.CBANDS+2);D(e,o,r,c,u),V(e,c,u,d);var m=0;for(s=0;s<e.npart_l;s++){var f,_,p,h=e.s3ind[s][0],v=e.s3ind[s][1],b=0,g=0;for(b=d[h],g+=1,_=e.s3_ll[m]*r[h]*E[d[h]],++m,++h;h<=v;)b+=d[h],g+=1,_=A(_,f=e.s3_ll[m]*r[h]*E[d[h]],h-s),++m,++h;if(_*=p=.5*E[b=(1+2*b)/(2*g)],e.blocktype_old[1&l]==L.SHORT_TYPE){var S=2*e.nb_1[l][s];a[s]=S>0?Math.min(_,S):Math.min(_,r[s]*i)}else{var k=16*e.nb_2[l][s],y=2*e.nb_1[l][s];k<=0&&(k=_),y<=0&&(y=_),S=e.blocktype_old[1&l]==L.NORM_TYPE?Math.min(y,k):y,a[s]=Math.min(_,S)}e.nb_2[l][s]=e.nb_1[l][s],e.nb_1[l][s]=_,f=c[s],f*=e.minval_l[s],f*=p,a[s]>f&&(a[s]=f),e.masking_lower>1&&(a[s]*=e.masking_lower),a[s]>r[s]&&(a[s]=r[s]),e.masking_lower<1&&(a[s]*=e.masking_lower)}for(;s<L.CBANDS;++s)r[s]=0,a[s]=0}function z(e,t,n,o,r,a,i){for(var l,s,c=2*a,u=a>0?Math.pow(10,r):1,d=0;d<i;++d){var m=e[2][d],f=e[3][d],_=t[0][d],p=t[1][d],h=t[2][d],v=t[3][d];if(_<=1.58*p&&p<=1.58*_){var b=n[d]*f,g=n[d]*m;s=Math.max(h,Math.min(v,b)),l=Math.max(v,Math.min(h,g))}else s=h,l=v;if(a>0){var E,S,k=o[d]*u;if(E=Math.min(Math.max(_,k),Math.max(p,k)),(S=(h=Math.max(s,k))+(v=Math.max(l,k)))>0&&E*c<S){var y=E*c/S;h*=y,v*=y}s=Math.min(h,s),l=Math.min(v,l)}s>m&&(s=m),l>f&&(l=f),t[2][d]=s,t[3][d]=l}}function K(e,t){var n;return(n=e>=0?27*-e:e*t)<=-72?0:Math.exp(n*_)}function W(e){var t,n,o,r,a=0;for(a=0;K(a,e)>1e-20;a-=1);for(o=a,r=0;Math.abs(r-o)>1e-12;)K(a=(r+o)/2,e)>0?r=a:o=a;for(t=o,a=0,a=0;K(a,e)>1e-20;a+=1);for(o=0,r=a;Math.abs(r-o)>1e-12;)K(a=(r+o)/2,e)>0?o=a:r=a;n=r;var i,l=0;for(i=0;i<=1e3;++i)l+=K(a=t+i*(n-t)/1e3,e);return 1001/(l*(n-t))}function Q(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function Z(e,o,r,a,i,l,s,c,u,d,m,f){var _,p=n(L.CBANDS+1),h=c/(f>15?1152:384),v=t(L.HBLKSIZE);c/=u;var b=0,g=0;for(_=0;_<L.CBANDS;_++){var E;for(M=Q(c*b),p[_]=c*b,E=b;Q(c*E)-M<.34&&E<=u/2;E++);for(e[_]=E-b,g=_+1;b<E;)v[b++]=_;if(b>u/2){b=u/2,++_;break}}p[_]=c*b;for(var S=0;S<f;S++){var k,y,T,B,A;T=d[S],B=d[S+1],(k=0|Math.floor(.5+m*(T-.5)))<0&&(k=0),(y=0|Math.floor(.5+m*(B-.5)))>u/2&&(y=u/2),r[S]=(v[k]+v[y])/2,o[S]=v[y];var I=h*B;s[S]=(I-p[o[S]])/(p[o[S]+1]-p[o[S]]),s[S]<0?s[S]=0:s[S]>1&&(s[S]=1),A=Q(c*d[S]*m),A=Math.min(A,15.5)/15.5,l[S]=Math.pow(10,1.25*(1-Math.cos(Math.PI*A))-2.5)}b=0;for(var R=0;R<g;R++){var M,w,C=e[R];M=Q(c*b),w=Q(c*(b+C-1)),a[R]=.5*(M+w),M=Q(c*(b-.5)),w=Q(c*(b+C-.5)),i[R]=w-M,b+=C}return g}function J(e,t,r,a,i,l){var s,c,u,d,m,f=o([L.CBANDS,L.CBANDS]),p=0;if(l)for(var h=0;h<t;h++)for(s=0;s<t;s++){var v=(c=void 0,void 0,void 0,m=void 0,c=r[h]-r[s],u=(c*=c>=0?3:1.5)>=.5&&c<=2.5?8*((m=c-.5)*m-2*m):0,((d=15.811389+7.5*(c+=.474)-17.5*Math.sqrt(1+c*c))<=-60?0:(c=Math.exp((u+d)*_),c/=.6609193))*a[s]);f[h][s]=v*i[h]}else for(s=0;s<t;s++){var b=15+Math.min(21/r[s],12),g=W(b);for(h=0;h<t;h++)v=g*K(r[h]-r[s],b)*a[s],f[h][s]=v*i[h]}for(h=0;h<t;h++){for(s=0;s<t&&!(f[h][s]>0);s++);for(e[h][0]=s,s=t-1;s>0&&!(f[h][s]>0);s--);e[h][1]=s,p+=e[h][1]-e[h][0]+1}var E=n(p),S=0;for(h=0;h<t;h++)for(s=e[h][0];s<=e[h][1];s++)E[S++]=f[h][s];return E}function ee(e){var t=Q(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function te(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_vbr=function(e,r,a,i,l,c,d,m,_,p){var h=e.internal_flags,v=n(L.HBLKSIZE),b=o([3,L.HBLKSIZE_s]),g=o([2,L.BLKSIZE]),E=o([2,3,L.BLKSIZE_s]),S=o([4,L.CBANDS]),k=o([4,L.CBANDS]),y=o([4,3]),T=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],B=t(2),A=e.mode==f.JOINT_STEREO?4:h.channels_out;!function(e,t,r,a,i,l,c,u,d,m){for(var _=o([2,576]),p=e.internal_flags,h=p.channels_out,v=e.mode==f.JOINT_STEREO?4:h,b=0;b<h;b++){firbuf=t[b];for(var g=r+576-350-s+192,E=0;E<576;E++){var S,k;S=firbuf[g+E+10],k=0;for(var y=0;y<9;y+=2)S+=q[y]*(firbuf[g+E+y]+firbuf[g+E+s-y]),k+=q[y+1]*(firbuf[g+E+y+1]+firbuf[g+E+s-y-1]);_[b][E]=S+k}i[a][b].en.assign(p.en[b]),i[a][b].thm.assign(p.thm[b]),v>2&&(l[a][b].en.assign(p.en[b+2]),l[a][b].thm.assign(p.thm[b+2]))}for(b=0;b<v;b++){var T=n(12),B=n(12),A=[0,0,0,0],I=_[1&b],R=0,M=3==b?p.nsPsy.attackthre_s:p.nsPsy.attackthre,w=1;if(2==b)for(E=0,y=576;y>0;++E,--y){var C=_[0][E],x=_[1][E];_[0][E]=C+x,_[1][E]=C-x}for(E=0;E<3;E++)B[E]=p.nsPsy.last_en_subshort[b][E+6],T[E]=B[E]/p.nsPsy.last_en_subshort[b][E+4],A[0]+=B[E];for(E=0;E<9;E++){for(var F=R+64,N=1;R<F;R++)N<Math.abs(I[R])&&(N=Math.abs(I[R]));p.nsPsy.last_en_subshort[b][E]=B[E+3]=N,A[1+E/3]+=N,N>B[E+3-2]?N/=B[E+3-2]:N=B[E+3-2]>10*N?B[E+3-2]/(10*N):0,T[E+3]=N}for(E=0;E<3;++E){var D=B[3*E+3]+B[3*E+4]+B[3*E+5],V=1;6*B[3*E+5]<D&&(V*=.5,6*B[3*E+4]<D&&(V*=.5)),u[b][E]=V}if(e.analysis){var O=T[0];for(E=1;E<12;E++)O<T[E]&&(O=T[E]);p.pinfo.ers[a][b]=p.pinfo.ers_save[b],p.pinfo.ers_save[b]=O}for(E=0;E<12;E++)0==d[b][E/3]&&T[E]>M&&(d[b][E/3]=E%3+1);for(E=1;E<4;E++){var L=A[E-1],P=A[E];Math.max(L,P)<4e4&&L<1.7*P&&P<1.7*L&&(1==E&&d[b][0]<=d[b][E]&&(d[b][0]=0),d[b][E]=0)}d[b][0]<=p.nsPsy.lastAttacks[b]&&(d[b][0]=0),3!=p.nsPsy.lastAttacks[b]&&d[b][0]+d[b][1]+d[b][2]+d[b][3]==0||(w=0,0!=d[b][1]&&0!=d[b][0]&&(d[b][1]=0),0!=d[b][2]&&0!=d[b][1]&&(d[b][2]=0),0!=d[b][3]&&0!=d[b][2]&&(d[b][3]=0)),b<2?m[b]=w:0==w&&(m[0]=m[1]=0),c[b]=p.tot_ener[b]}}(e,r,a,i,l,c,_,y,T,B),function(e,t){var n=e.internal_flags;e.short_blocks!=u.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var o=0;o<n.channels_out;o++)e.short_blocks==u.short_block_dispensed&&(t[o]=1),e.short_blocks==u.short_block_forced&&(t[o]=0)}(e,B);for(var M=0;M<A;M++)P(e,r,a,M,i,v,g,F=1&M),U(e,i,M,v),0!=B[F]?$(h,v,S[M],k[M],M):j(h,M);for(B[0]+B[1]==2&&e.mode==f.JOINT_STEREO&&z(S,k,h.mld_cb_l,h.ATH.cb_l,e.ATHlower*h.ATH.adjust,e.msfix,h.npart_l),M=0;M<A;M++)0!=B[F=1&M]&&R(h,S[M],k[M],M);for(var C=0;C<3;C++){for(M=0;M<A;++M)0!=B[F=1&M]?Y(h,M,C):(H(e,r,a,M,C,b,E,F),G(e,b,S[M],k[M],M,C));for(B[0]+B[1]==0&&e.mode==f.JOINT_STEREO&&z(S,k,h.mld_cb_s,h.ATH.cb_s,e.ATHlower*h.ATH.adjust,e.msfix,h.npart_s),M=0;M<A;++M)0==B[F=1&M]&&I(h,S[M],k[M],M,C)}for(M=0;M<A;M++){var F;if(0==B[F=1&M])for(var D=0;D<L.SBMAX_s;D++){var V=n(3);for(C=0;C<3;C++){var O=h.thm[M].s[D][C];if(O*=.8,T[M][C]>=2||1==T[M][C+1]){var X=0!=C?C-1:2,K=w(h.thm[M].s[D][X],O,.36);O=Math.min(O,K)}else 1==T[M][C]?(X=0!=C?C-1:2,K=w(h.thm[M].s[D][X],O,.18),O=Math.min(O,K)):(0!=C&&3==T[M][C-1]||0==C&&3==h.nsPsy.lastAttacks[M])&&(X=2!=C?C+1:0,K=w(h.thm[M].s[D][X],O,.18),O=Math.min(O,K));O*=y[M][C],V[C]=O}for(C=0;C<3;C++)h.thm[M].s[D][C]=V[C]}}for(M=0;M<A;M++)h.nsPsy.lastAttacks[M]=T[M][2];for(function(e,t,n){for(var o=e.internal_flags,r=0;r<o.channels_out;r++){var a=L.NORM_TYPE;0!=t[r]?o.blocktype_old[r]==L.SHORT_TYPE&&(a=L.STOP_TYPE):(a=L.SHORT_TYPE,o.blocktype_old[r]==L.NORM_TYPE&&(o.blocktype_old[r]=L.START_TYPE),o.blocktype_old[r]==L.STOP_TYPE&&(o.blocktype_old[r]=L.SHORT_TYPE)),n[r]=o.blocktype_old[r],o.blocktype_old[r]=a}}(e,B,p),M=0;M<A;M++){var W,Q,Z,J;M>1?(W=m,Q=-2,Z=L.NORM_TYPE,p[0]!=L.SHORT_TYPE&&p[1]!=L.SHORT_TYPE||(Z=L.SHORT_TYPE),J=c[i][M-2]):(W=d,Q=0,Z=p[M],J=l[i][M]),Z==L.SHORT_TYPE?W[Q+M]=x(J,h.masking_lower):W[Q+M]=N(J,h.masking_lower),e.analysis&&(h.pinfo.pe[i][M]=W[Q+M])}return 0},this.psymodel_init=function(t){var o,a,i=t.internal_flags,l=!0,s=13,c=0,u=0,f=-8.25,_=-4.5,p=n(L.CBANDS),h=n(L.CBANDS),E=n(L.CBANDS),S=t.out_samplerate;switch(t.experimentalZ){default:l=!0;break;case 1:l=t.VBR!=m.vbr_mtrh&&t.VBR!=m.vbr_mt;break;case 2:l=!1;break;case 3:s=8,c=-1.75,u=-.0125,f=-8.25,_=-2.25}for(i.ms_ener_ratio_old=.25,i.blocktype_old[0]=i.blocktype_old[1]=L.NORM_TYPE,o=0;o<4;++o){for(var k=0;k<L.CBANDS;++k)i.nb_1[o][k]=1e20,i.nb_2[o][k]=1e20,i.nb_s1[o][k]=i.nb_s2[o][k]=1;for(var y=0;y<L.SBMAX_l;y++)i.en[o].l[y]=1e20,i.thm[o].l[y]=1e20;for(k=0;k<3;++k){for(y=0;y<L.SBMAX_s;y++)i.en[o].s[y][k]=1e20,i.thm[o].s[y][k]=1e20;i.nsPsy.lastAttacks[o]=0}for(k=0;k<9;k++)i.nsPsy.last_en_subshort[o][k]=10}for(i.loudness_sq_save[0]=i.loudness_sq_save[1]=0,i.npart_l=Z(i.numlines_l,i.bo_l,i.bm_l,p,h,i.mld_l,i.PSY.bo_l_weight,S,L.BLKSIZE,i.scalefac_band.l,L.BLKSIZE/1152,L.SBMAX_l),o=0;o<i.npart_l;o++){var T=c;p[o]>=s&&(T=u*(p[o]-s)/(24-s)+c*(24-p[o])/(24-s)),E[o]=Math.pow(10,T/10),i.numlines_l[o]>0?i.rnumlines_l[o]=1/i.numlines_l[o]:i.rnumlines_l[o]=0}for(i.s3_ll=J(i.s3ind,i.npart_l,p,h,E,l),k=0,o=0;o<i.npart_l;o++){I=d.MAX_VALUE;for(var B=0;B<i.numlines_l[o];B++,k++){var A=S*k/(1e3*L.BLKSIZE);R=this.ATHformula(1e3*A,t)-20,R=Math.pow(10,.1*R),I>(R*=i.numlines_l[o])&&(I=R)}i.ATH.cb_l[o]=I,(I=20*p[o]/10-20)>6&&(I=100),I<-15&&(I=-15),I-=8,i.minval_l[o]=Math.pow(10,I/10)*i.numlines_l[o]}for(i.npart_s=Z(i.numlines_s,i.bo_s,i.bm_s,p,h,i.mld_s,i.PSY.bo_s_weight,S,L.BLKSIZE_s,i.scalefac_band.s,L.BLKSIZE_s/384,L.SBMAX_s),k=0,o=0;o<i.npart_s;o++){var I;for(T=f,p[o]>=s&&(T=_*(p[o]-s)/(24-s)+f*(24-p[o])/(24-s)),E[o]=Math.pow(10,T/10),I=d.MAX_VALUE,B=0;B<i.numlines_s[o];B++,k++){var R;A=S*k/(1e3*L.BLKSIZE_s),R=this.ATHformula(1e3*A,t)-20,R=Math.pow(10,.1*R),I>(R*=i.numlines_s[o])&&(I=R)}i.ATH.cb_s[o]=I,I=7*p[o]/12-7,p[o]>12&&(I*=1+3.1*Math.log(1+I)),p[o]<12&&(I*=1+2.3*Math.log(1-I)),I<-15&&(I=-15),I-=8,i.minval_s[o]=Math.pow(10,I/10)*i.numlines_s[o]}i.s3_ss=J(i.s3ind_s,i.npart_s,p,h,E,l),v=Math.pow(10,9/16),b=Math.pow(10,1.5),g=Math.pow(10,1.5),e.init_fft(i),i.decay=Math.exp(-1*r/(.01*S/192)),a=3.5,0!=(2&t.exp_nspsytune)&&(a=1),Math.abs(t.msfix)>0&&(a=t.msfix),t.msfix=a;for(var M=0;M<i.npart_l;M++)i.s3ind[M][1]>i.npart_l-1&&(i.s3ind[M][1]=i.npart_l-1);var w=576*i.mode_gr/S;if(i.ATH.decay=Math.pow(10,-1.2*w),i.ATH.adjust=.01,i.ATH.adjustLimit=1,-1!=t.ATHtype){var C=t.out_samplerate/L.BLKSIZE,x=0;for(A=0,o=0;o<L.BLKSIZE/2;++o)A+=C,i.ATH.eql_w[o]=1/Math.pow(10,this.ATHformula(A,t)/10),x+=i.ATH.eql_w[o];for(x=1/x,o=L.BLKSIZE/2;--o>=0;)i.ATH.eql_w[o]*=x}for(M=k=0;M<i.npart_s;++M)for(o=0;o<i.numlines_s[M];++o)++k;for(M=k=0;M<i.npart_l;++M)for(o=0;o<i.numlines_l[M];++o)++k;for(k=0,o=0;o<i.npart_l;o++)A=S*(k+i.numlines_l[o]/2)/(1*L.BLKSIZE),i.mld_cb_l[o]=ee(A),k+=i.numlines_l[o];for(;o<L.CBANDS;++o)i.mld_cb_l[o]=1;for(k=0,o=0;o<i.npart_s;o++)A=S*(k+i.numlines_s[o]/2)/(1*L.BLKSIZE_s),i.mld_cb_s[o]=ee(A),k+=i.numlines_s[o];for(;o<L.CBANDS;++o)i.mld_cb_s[o]=1;return 0},this.ATHformula=function(e,t){var n;switch(t.ATHtype){case 0:n=te(e,9);break;case 1:n=te(e,-1);break;default:n=te(e,0);break;case 3:n=te(e,1)+6;break;case 4:n=te(e,t.ATHcurve)}return n}}function G(){var e,t,o,i,l,c=this;G.V9=410,G.V8=420,G.V7=430,G.V6=440,G.V5=450,G.V4=460,G.V3=470,G.V2=480,G.V1=490,G.V0=500,G.R3MIX=1e3,G.STANDARD=1001,G.EXTREME=1002,G.INSANE=1003,G.STANDARD_FAST=1004,G.EXTREME_FAST=1005,G.MEDIUM=1006,G.MEDIUM_FAST=1007,G.LAME_MAXMP3BUFFER=147456;var d,_,h,v=new j;function b(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=n(L.SBMAX_l),this.bo_s_weight=n(L.SBMAX_s)}function E(){this.lowerlimit=0}function S(e,t){this.lowpass=t}this.enc=new L,this.setModules=function(n,r,a,s,c,u,m,f,p){e=n,t=r,o=a,i=s,l=c,d=u,_=f,h=p,this.enc.setModules(t,v,i,d)};var y=4294479419;function T(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function B(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:case 11025:return t.version=0,0;case 24e3:case 12e3:return t.version=0,1;case 16e3:case 8e3:return t.version=0,2;default:return t.version=0,-1}}function w(e,t,n){n<16e3&&(t=2);for(var o=k.bitrate_table[t][1],r=2;r<=14;r++)k.bitrate_table[t][r]>0&&Math.abs(k.bitrate_table[t][r]-e)<Math.abs(o-e)&&(o=k.bitrate_table[t][r]);return o}function C(e,t,n){n<16e3&&(t=2);for(var o=0;o<=14;o++)if(k.bitrate_table[t][o]>0&&k.bitrate_table[t][o]==e)return o;return-1}function x(e,t){var n=[new S(8,2e3),new S(16,3700),new S(24,3900),new S(32,5500),new S(40,7e3),new S(48,7500),new S(56,1e4),new S(64,11e3),new S(80,13500),new S(96,15100),new S(112,15600),new S(128,17e3),new S(160,17500),new S(192,18600),new S(224,19400),new S(256,19700),new S(320,20500)],o=c.nearestBitrateFullIndex(t);e.lowerlimit=n[o].lowpass}function F(e){var t=L.BLKSIZE+e.framesize-L.FFTOFFSET;return Math.max(t,512+e.framesize-32)}function N(e,t,n,o,r,a){var i=c.enc.lame_encode_mp3_frame(e,t,n,o,r,a);return e.frameNum++,i}function D(){this.n_in=0,this.n_out=0}function V(){this.num_used=0}function O(e,t,n){var o=Math.PI*t;(e/=n)<0&&(e=0),e>1&&(e=1);var r=e-.5,a=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(r)<1e-9?o/Math.PI:a*Math.sin(n*o*r)/(Math.PI*n*r)}function P(e,t,o,r,a,i,l,s,c){var u,d,m=e.internal_flags,f=0,_=e.out_samplerate/function e(t,n){return 0!=n?e(n,t%n):t}(e.out_samplerate,e.in_samplerate);_>Y.BPC&&(_=Y.BPC);var p=Math.abs(m.resample_ratio-Math.floor(.5+m.resample_ratio))<1e-4?1:0,h=1/m.resample_ratio;h>1&&(h=1);var v=31;0==v%2&&--v;var b=(v+=p)+1;if(0==m.fill_buffer_resample_init){for(m.inbuf_old[0]=n(b),m.inbuf_old[1]=n(b),u=0;u<=2*_;++u)m.blackfilt[u]=n(b);for(m.itime[0]=0,m.itime[1]=0,f=0;f<=2*_;f++){var g=0,E=(f-_)/(2*_);for(u=0;u<=v;u++)g+=m.blackfilt[f][u]=O(u-E,h,v);for(u=0;u<=v;u++)m.blackfilt[f][u]/=g}m.fill_buffer_resample_init=1}var S=m.inbuf_old[c];for(d=0;d<r;d++){var k,y;if(k=d*m.resample_ratio,v+(f=0|Math.floor(k-m.itime[c]))-v/2>=l)break;E=k-m.itime[c]-(f+v%2*.5),y=0|Math.floor(2*E*_+_+.5);var T=0;for(u=0;u<=v;++u){var B=0|u+f-v/2;T+=(B<0?S[b+B]:a[i+B])*m.blackfilt[y][u]}t[o+d]=T}if(s.num_used=Math.min(l,v+f-v/2),m.itime[c]+=s.num_used-d*m.resample_ratio,s.num_used>=b)for(u=0;u<b;u++)S[u]=a[i+s.num_used+u-b];else{var A=b-s.num_used;for(u=0;u<A;++u)S[u]=S[u+s.num_used];for(f=0;u<b;++u,++f)S[u]=a[i+f]}return d}function H(e,t,n,o,r,a){var i=e.internal_flags;if(i.resample_ratio<.9999||i.resample_ratio>1.0001)for(var l=0;l<i.channels_out;l++){var s=new V;a.n_out=P(e,t[l],i.mf_size,e.framesize,n[l],o,r,s,l),a.n_in=s.num_used}else{a.n_out=Math.min(e.framesize,r),a.n_in=a.n_out;for(var c=0;c<a.n_out;++c)t[0][i.mf_size+c]=n[0][o+c],2==i.channels_out&&(t[1][i.mf_size+c]=n[1][o+c])}}this.lame_init=function(){var e=new A;return 0!=function(e){var t;return e.class_id=y,t=e.internal_flags=new Y,e.mode=f.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=m.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=L.ENCDELAY+L.POSTDELAY,e.encoder_padding=0,t.mf_size=L.ENCDELAY-L.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}(e)?null:(e.lame_allocated_gfp=1,e)},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],n=0,o=0,r=0,a=0;a=t[16],r=16,o=t[16],n=16;for(var i=0;i<16;i++)if(Math.max(e,t[i+1])!=e){a=t[i+1],r=i+1,o=t[i],n=i;break}return a-e>e-o?n:r},this.lame_init_params=function(n){var a,c,S,A=n.internal_flags;if(A.Class_ID=0,null==A.ATH&&(A.ATH=new M),null==A.PSY&&(A.PSY=new b),null==A.rgdata&&(A.rgdata=new I),A.channels_in=n.num_channels,1==A.channels_in&&(n.mode=f.MONO),A.channels_out=n.mode==f.MONO?1:2,A.mode_ext=L.MPG_MD_MS_LR,n.mode==f.MONO&&(n.force_ms=!1),n.VBR==m.vbr_off&&128!=n.VBR_mean_bitrate_kbps&&0==n.brate&&(n.brate=n.VBR_mean_bitrate_kbps),n.VBR==m.vbr_off||n.VBR==m.vbr_mtrh||n.VBR==m.vbr_mt||(n.free_format=!1),n.VBR==m.vbr_off&&0==n.brate&&g.EQ(n.compression_ratio,0)&&(n.compression_ratio=11.025),n.VBR==m.vbr_off&&n.compression_ratio>0&&(0==n.out_samplerate&&(n.out_samplerate=map2MP3Frequency(int(.97*n.in_samplerate))),n.brate=0|16*n.out_samplerate*A.channels_out/(1e3*n.compression_ratio),A.samplerate_index=B(n.out_samplerate,n),n.free_format||(n.brate=w(n.brate,n.version,n.out_samplerate))),0!=n.out_samplerate&&(n.out_samplerate<16e3?(n.VBR_mean_bitrate_kbps=Math.max(n.VBR_mean_bitrate_kbps,8),n.VBR_mean_bitrate_kbps=Math.min(n.VBR_mean_bitrate_kbps,64)):n.out_samplerate<32e3?(n.VBR_mean_bitrate_kbps=Math.max(n.VBR_mean_bitrate_kbps,8),n.VBR_mean_bitrate_kbps=Math.min(n.VBR_mean_bitrate_kbps,160)):(n.VBR_mean_bitrate_kbps=Math.max(n.VBR_mean_bitrate_kbps,32),n.VBR_mean_bitrate_kbps=Math.min(n.VBR_mean_bitrate_kbps,320))),0==n.lowpassfreq){var F=16e3;switch(n.VBR){case m.vbr_off:x(N=new E,n.brate),F=N.lowerlimit;break;case m.vbr_abr:var N;x(N=new E,n.VBR_mean_bitrate_kbps),F=N.lowerlimit;break;case m.vbr_rh:var D=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=n.VBR_q&&n.VBR_q<=9){var V=D[n.VBR_q],O=D[n.VBR_q+1],P=n.VBR_q_frac;F=linear_int(V,O,P)}else F=19500;break;default:D=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950],0<=n.VBR_q&&n.VBR_q<=9?(V=D[n.VBR_q],O=D[n.VBR_q+1],P=n.VBR_q_frac,F=linear_int(V,O,P)):F=19500}n.mode!=f.MONO||n.VBR!=m.vbr_off&&n.VBR!=m.vbr_abr||(F*=1.5),n.lowpassfreq=0|F}if(0==n.out_samplerate&&(2*n.lowpassfreq>n.in_samplerate&&(n.lowpassfreq=n.in_samplerate/2),n.out_samplerate=(a=0|n.lowpassfreq,S=44100,(c=n.in_samplerate)>=48e3?S=48e3:c>=44100?S=44100:c>=32e3?S=32e3:c>=24e3?S=24e3:c>=22050?S=22050:c>=16e3?S=16e3:c>=12e3?S=12e3:c>=11025?S=11025:c>=8e3&&(S=8e3),-1==a?S:(a<=15960&&(S=44100),a<=15250&&(S=32e3),a<=11220&&(S=24e3),a<=9970&&(S=22050),a<=7230&&(S=16e3),a<=5420&&(S=12e3),a<=4510&&(S=11025),a<=3970&&(S=8e3),c<S?c>44100?48e3:c>32e3?44100:c>24e3?32e3:c>22050?24e3:c>16e3?22050:c>12e3?16e3:c>11025?12e3:c>8e3?11025:8e3:S))),n.lowpassfreq=Math.min(20500,n.lowpassfreq),n.lowpassfreq=Math.min(n.out_samplerate/2,n.lowpassfreq),n.VBR==m.vbr_off&&(n.compression_ratio=16*n.out_samplerate*A.channels_out/(1e3*n.brate)),n.VBR==m.vbr_abr&&(n.compression_ratio=16*n.out_samplerate*A.channels_out/(1e3*n.VBR_mean_bitrate_kbps)),n.bWriteVbrTag||(n.findReplayGain=!1,n.decode_on_the_fly=!1,A.findPeakSample=!1),A.findReplayGain=n.findReplayGain,A.decode_on_the_fly=n.decode_on_the_fly,A.decode_on_the_fly&&(A.findPeakSample=!0),A.findReplayGain&&e.InitGainAnalysis(A.rgdata,n.out_samplerate)==p.INIT_GAIN_ANALYSIS_ERROR)return n.internal_flags=null,-6;switch(A.decode_on_the_fly&&!n.decode_only&&(null!=A.hip&&h.hip_decode_exit(A.hip),A.hip=h.hip_decode_init()),A.mode_gr=n.out_samplerate<=24e3?1:2,n.framesize=576*A.mode_gr,n.encoder_delay=L.ENCDELAY,A.resample_ratio=n.in_samplerate/n.out_samplerate,n.VBR){case m.vbr_mt:case m.vbr_rh:case m.vbr_mtrh:n.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][n.VBR_q];break;case m.vbr_abr:n.compression_ratio=16*n.out_samplerate*A.channels_out/(1e3*n.VBR_mean_bitrate_kbps);break;default:n.compression_ratio=16*n.out_samplerate*A.channels_out/(1e3*n.brate)}if(n.mode==f.NOT_SET&&(n.mode=f.JOINT_STEREO),n.highpassfreq>0?(A.highpass1=2*n.highpassfreq,n.highpasswidth>=0?A.highpass2=2*(n.highpassfreq+n.highpasswidth):A.highpass2=2*n.highpassfreq,A.highpass1/=n.out_samplerate,A.highpass2/=n.out_samplerate):(A.highpass1=0,A.highpass2=0),n.lowpassfreq>0?(A.lowpass2=2*n.lowpassfreq,n.lowpasswidth>=0?(A.lowpass1=2*(n.lowpassfreq-n.lowpasswidth),A.lowpass1<0&&(A.lowpass1=0)):A.lowpass1=2*n.lowpassfreq,A.lowpass1/=n.out_samplerate,A.lowpass2/=n.out_samplerate):(A.lowpass1=0,A.lowpass2=0),function(e){var t=e.internal_flags,n=32,o=-1;if(t.lowpass1>0){for(var r=999,a=0;a<=31;a++)(u=a/31)>=t.lowpass2&&(n=Math.min(n,a)),t.lowpass1<u&&u<t.lowpass2&&(r=Math.min(r,a));t.lowpass1=999==r?(n-.75)/31:(r-.75)/31,t.lowpass2=n/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,s.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var i=-1;for(a=0;a<=31;a++)(u=a/31)<=t.highpass1&&(o=Math.max(o,a)),t.highpass1<u&&u<t.highpass2&&(i=Math.max(i,a));t.highpass1=o/31,t.highpass2=-1==i?(o+.75)/31:(i+.75)/31}for(a=0;a<32;a++){var l,c,u=a/31;l=t.highpass2>t.highpass1?T((t.highpass2-u)/(t.highpass2-t.highpass1+1e-20)):1,c=t.lowpass2>t.lowpass1?T((u-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[a]=l*c}}(n),A.samplerate_index=B(n.out_samplerate,n),A.samplerate_index<0)return n.internal_flags=null,-1;if(n.VBR==m.vbr_off){if(n.free_format)A.bitrate_index=0;else if(n.brate=w(n.brate,n.version,n.out_samplerate),A.bitrate_index=C(n.brate,n.version,n.out_samplerate),A.bitrate_index<=0)return n.internal_flags=null,-1}else A.bitrate_index=1;n.analysis&&(n.bWriteVbrTag=!1),null!=A.pinfo&&(n.bWriteVbrTag=!1),t.init_bit_stream_w(A);for(var H,U=A.samplerate_index+3*n.version+6*(n.out_samplerate<16e3?1:0),q=0;q<L.SBMAX_l+1;q++)A.scalefac_band.l[q]=i.sfBandIndex[U].l[q];for(q=0;q<L.PSFB21+1;q++){var Y=(A.scalefac_band.l[22]-A.scalefac_band.l[21])/L.PSFB21,X=A.scalefac_band.l[21]+q*Y;A.scalefac_band.psfb21[q]=X}for(A.scalefac_band.psfb21[L.PSFB21]=576,q=0;q<L.SBMAX_s+1;q++)A.scalefac_band.s[q]=i.sfBandIndex[U].s[q];for(q=0;q<L.PSFB12+1;q++)Y=(A.scalefac_band.s[13]-A.scalefac_band.s[12])/L.PSFB12,X=A.scalefac_band.s[12]+q*Y,A.scalefac_band.psfb12[q]=X;for(A.scalefac_band.psfb12[L.PSFB12]=192,1==n.version?A.sideinfo_len=1==A.channels_out?21:36:A.sideinfo_len=1==A.channels_out?13:21,n.error_protection&&(A.sideinfo_len+=2),function(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&_.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=r([16,5]),t.bitrate_blockType_Hist=r([16,6]),t.PeakSample=0,e.bWriteVbrTag&&d.InitVbrTag(e)}(n),A.Class_ID=y,H=0;H<19;H++)A.nsPsy.pefirbuf[H]=700*A.mode_gr*A.channels_out;switch(-1==n.ATHtype&&(n.ATHtype=4),n.VBR){case m.vbr_mt:n.VBR=m.vbr_mtrh;case m.vbr_mtrh:null==n.useTemporal&&(n.useTemporal=!1),o.apply_preset(n,500-10*n.VBR_q,0),n.quality<0&&(n.quality=LAME_DEFAULT_QUALITY),n.quality<5&&(n.quality=0),n.quality>5&&(n.quality=5),A.PSY.mask_adjust=n.maskingadjust,A.PSY.mask_adjust_short=n.maskingadjust_short,n.experimentalY?A.sfb21_extra=!1:A.sfb21_extra=n.out_samplerate>44e3,A.iteration_loop=new VBRNewIterationLoop(l);break;case m.vbr_rh:o.apply_preset(n,500-10*n.VBR_q,0),A.PSY.mask_adjust=n.maskingadjust,A.PSY.mask_adjust_short=n.maskingadjust_short,n.experimentalY?A.sfb21_extra=!1:A.sfb21_extra=n.out_samplerate>44e3,n.quality>6&&(n.quality=6),n.quality<0&&(n.quality=LAME_DEFAULT_QUALITY),A.iteration_loop=new VBROldIterationLoop(l);break;default:var G;A.sfb21_extra=!1,n.quality<0&&(n.quality=LAME_DEFAULT_QUALITY),(G=n.VBR)==m.vbr_off&&(n.VBR_mean_bitrate_kbps=n.brate),o.apply_preset(n,n.VBR_mean_bitrate_kbps,0),n.VBR=G,A.PSY.mask_adjust=n.maskingadjust,A.PSY.mask_adjust_short=n.maskingadjust_short,G==m.vbr_off?A.iteration_loop=new R(l):A.iteration_loop=new ABRIterationLoop(l)}if(n.VBR!=m.vbr_off){if(A.VBR_min_bitrate=1,A.VBR_max_bitrate=14,n.out_samplerate<16e3&&(A.VBR_max_bitrate=8),0!=n.VBR_min_bitrate_kbps&&(n.VBR_min_bitrate_kbps=w(n.VBR_min_bitrate_kbps,n.version,n.out_samplerate),A.VBR_min_bitrate=C(n.VBR_min_bitrate_kbps,n.version,n.out_samplerate),A.VBR_min_bitrate<0))return-1;if(0!=n.VBR_max_bitrate_kbps&&(n.VBR_max_bitrate_kbps=w(n.VBR_max_bitrate_kbps,n.version,n.out_samplerate),A.VBR_max_bitrate=C(n.VBR_max_bitrate_kbps,n.version,n.out_samplerate),A.VBR_max_bitrate<0))return-1;n.VBR_min_bitrate_kbps=k.bitrate_table[n.version][A.VBR_min_bitrate],n.VBR_max_bitrate_kbps=k.bitrate_table[n.version][A.VBR_max_bitrate],n.VBR_mean_bitrate_kbps=Math.min(k.bitrate_table[n.version][A.VBR_max_bitrate],n.VBR_mean_bitrate_kbps),n.VBR_mean_bitrate_kbps=Math.max(k.bitrate_table[n.version][A.VBR_min_bitrate],n.VBR_mean_bitrate_kbps)}return n.tune&&(A.PSY.mask_adjust+=n.tune_value_a,A.PSY.mask_adjust_short+=n.tune_value_a),function(e){var t=e.internal_flags;switch(e.quality){default:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}(n),n.athaa_type<0?A.ATH.useAdjust=3:A.ATH.useAdjust=n.athaa_type,A.ATH.aaSensitivityP=Math.pow(10,n.athaa_sensitivity/-10),null==n.short_blocks&&(n.short_blocks=u.short_block_allowed),n.short_blocks!=u.short_block_allowed||n.mode!=f.JOINT_STEREO&&n.mode!=f.STEREO||(n.short_blocks=u.short_block_coupled),n.quant_comp<0&&(n.quant_comp=1),n.quant_comp_short<0&&(n.quant_comp_short=0),n.msfix<0&&(n.msfix=0),n.exp_nspsytune=1|n.exp_nspsytune,n.internal_flags.nsPsy.attackthre<0&&(n.internal_flags.nsPsy.attackthre=j.NSATTACKTHRE),n.internal_flags.nsPsy.attackthre_s<0&&(n.internal_flags.nsPsy.attackthre_s=j.NSATTACKTHRE_S),n.scale<0&&(n.scale=1),n.ATHtype<0&&(n.ATHtype=4),n.ATHcurve<0&&(n.ATHcurve=4),n.athaa_loudapprox<0&&(n.athaa_loudapprox=2),n.interChRatio<0&&(n.interChRatio=0),null==n.useTemporal&&(n.useTemporal=!0),A.slot_lag=A.frac_SpF=0,n.VBR==m.vbr_off&&(A.slot_lag=A.frac_SpF=72e3*(n.version+1)*n.brate%n.out_samplerate|0),i.iteration_init(n),v.psymodel_init(n),0},this.lame_encode_flush=function(e,n,o,r){var i,l,s,c,u=e.internal_flags,d=a([2,1152]),m=0,f=u.mf_samples_to_encode-L.POSTDELAY,p=F(e);if(u.mf_samples_to_encode<1)return 0;for(i=0,e.in_samplerate!=e.out_samplerate&&(f+=16*e.out_samplerate/e.in_samplerate),(s=e.framesize-f%e.framesize)<576&&(s+=e.framesize),e.encoder_padding=s,c=(f+s)/e.framesize;c>0&&m>=0;){var h=p-u.mf_size,v=e.frameNum;h*=e.in_samplerate,(h/=e.out_samplerate)>1152&&(h=1152),h<1&&(h=1),l=r-i,0==r&&(l=0),o+=m=this.lame_encode_buffer(e,d[0],d[1],h,n,o,l),i+=m,c-=v!=e.frameNum?1:0}if(u.mf_samples_to_encode=0,m<0)return m;if(l=r-i,0==r&&(l=0),t.flush_bitstream(e),(m=t.copy_buffer(u,n,o,l,1))<0)return m;if(o+=m,l=r-(i+=m),0==r&&(l=0),e.write_id3tag_automatic){if(_.id3tag_write_v1(e),(m=t.copy_buffer(u,n,o,l,0))<0)return m;i+=m}return i},this.lame_encode_buffer=function(o,r,a,i,l,s,c){var u=o.internal_flags,d=[null,null];if(u.Class_ID!=y)return-3;if(0==i)return 0;!function(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=n(t),e.in_buffer_1=n(t),e.in_buffer_nsamples=t)}(u,i),d[0]=u.in_buffer_0,d[1]=u.in_buffer_1;for(var m=0;m<i;m++)d[0][m]=r[m],u.channels_in>1&&(d[1][m]=a[m]);return function(n,o,r,a,i,l,s){var c,u,d,m,f,_=n.internal_flags,h=0,v=[null,null],b=[null,null];if(_.Class_ID!=y)return-3;if(0==a)return 0;if((f=t.copy_buffer(_,i,l,s,0))<0)return f;if(l+=f,h+=f,b[0]=o,b[1]=r,g.NEQ(n.scale,0)&&g.NEQ(n.scale,1))for(u=0;u<a;++u)b[0][u]*=n.scale,2==_.channels_out&&(b[1][u]*=n.scale);if(g.NEQ(n.scale_left,0)&&g.NEQ(n.scale_left,1))for(u=0;u<a;++u)b[0][u]*=n.scale_left;if(g.NEQ(n.scale_right,0)&&g.NEQ(n.scale_right,1))for(u=0;u<a;++u)b[1][u]*=n.scale_right;if(2==n.num_channels&&1==_.channels_out)for(u=0;u<a;++u)b[0][u]=.5*(b[0][u]+b[1][u]),b[1][u]=0;m=F(n),v[0]=_.mfbuf[0],v[1]=_.mfbuf[1];for(var E=0;a>0;){var S,k,T=[null,null];T[0]=b[0],T[1]=b[1];var B=new D;if(H(n,v,T,E,a,B),S=B.n_in,k=B.n_out,_.findReplayGain&&!_.decode_on_the_fly&&e.AnalyzeSamples(_.rgdata,v[0],_.mf_size,v[1],_.mf_size,k,_.channels_out)==p.GAIN_ANALYSIS_ERROR)return-6;if(a-=S,E+=S,_.channels_out,_.mf_size+=k,_.mf_samples_to_encode<1&&(_.mf_samples_to_encode=L.ENCDELAY+L.POSTDELAY),_.mf_samples_to_encode+=k,_.mf_size>=m){var A=s-h;if(0==s&&(A=0),(c=N(n,v[0],v[1],i,l,A))<0)return c;for(l+=c,h+=c,_.mf_size-=n.framesize,_.mf_samples_to_encode-=n.framesize,d=0;d<_.channels_out;d++)for(u=0;u<_.mf_size;u++)v[d][u]=v[d][u+n.framesize]}}return h}(o,d[0],d[1],i,l,s,c)}}function $(){this.setModules=function(e,t){}}function z(){this.setModules=function(e,t,n){}}function K(){}function W(){this.setModules=function(e,t){}}function Q(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function Z(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}N.SFBMAX=3*L.SBMAX_s,L.ENCDELAY=576,L.POSTDELAY=1152,L.MDCTDELAY=48,L.FFTOFFSET=224+L.MDCTDELAY,L.DECDELAY=528,L.SBLIMIT=32,L.CBANDS=64,L.SBPSY_l=21,L.SBPSY_s=12,L.SBMAX_l=22,L.SBMAX_s=13,L.PSFB21=6,L.PSFB12=6,L.BLKSIZE=1024,L.HBLKSIZE=L.BLKSIZE/2+1,L.BLKSIZE_s=256,L.HBLKSIZE_s=L.BLKSIZE_s/2+1,L.NORM_TYPE=0,L.START_TYPE=1,L.SHORT_TYPE=2,L.STOP_TYPE=3,L.MPG_MD_LR_LR=0,L.MPG_MD_LR_I=1,L.MPG_MD_MS_LR=2,L.MPG_MD_MS_I=3,L.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],Y.MFSIZE=3456+L.ENCDELAY-L.MDCTDELAY,Y.MAX_HEADER_BUF=256,Y.MAX_BITS_PER_CHANNEL=4095,Y.MAX_BITS_PER_GRANULE=7680,Y.BPC=320,Q.RIFF=Z("RIFF"),Q.WAVE=Z("WAVE"),Q.fmt_=Z("fmt "),Q.data=Z("data"),Q.readHeader=function(e){var t=new Q,n=e.getUint32(0,!1);if(Q.RIFF==n&&(e.getUint32(4,!0),Q.WAVE==e.getUint32(8,!1)&&Q.fmt_==e.getUint32(12,!1))){var o=e.getUint32(16,!0),r=20;switch(o){case 16:case 18:t.channels=e.getUint16(r+2,!0),t.sampleRate=e.getUint32(r+4,!0);break;default:throw"extended fmt chunk not implemented"}r+=o;for(var a=Q.data,i=0;a!=n&&(n=e.getUint32(r,!1),i=e.getUint32(r+4,!0),a!=n);)r+=i+8;return t.dataLen=i,t.dataOffset=r+8,t}},N.SFBMAX=3*L.SBMAX_s,Jr.Mp3Encoder=function(t,n,o){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),t=1,n=44100,o=128);var r=new G,a=new $,i=new p,l=new g,s=new h,c=new C,u=new D,d=new E,m=new _,S=new W,k=new b,y=new v,T=new z,B=new K;r.setModules(i,l,s,c,u,d,m,S,B),l.setModules(i,B,m,d),S.setModules(l,m),s.setModules(r),u.setModules(l,k,c,y),c.setModules(y,k,r.enc.psy),k.setModules(l),y.setModules(c),d.setModules(r,l,m),a.setModules(T,B),T.setModules(m,S,s);var A=r.lame_init();A.num_channels=t,A.in_samplerate=n,A.brate=o,A.mode=f.STEREO,A.quality=3,A.bWriteVbrTag=!1,A.disable_reservoir=!0,A.write_id3tag_automatic=!1,r.lame_init_params(A);var I=1152,R=0|1.25*I+7200,M=e(R);this.encodeBuffer=function(n,o){1==t&&(o=n),n.length>I&&(I=n.length,M=e(R=0|1.25*I+7200));var a=r.lame_encode_buffer(A,n,o,n.length,M,0,R);return new Int8Array(M.subarray(0,a))},this.flush=function(){var e=r.lame_encode_flush(A,M,0,R);return new Int8Array(M.subarray(0,e))}},Jr.WavHeader=Q}Zr.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("TextCollection");return e.openBlock(),e.createElementBlock(e.Fragment,null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model.values)||void 0===l?void 0:l.$values,(function(n){return e.openBlock(),e.createBlock(s,{model:n,"is-multiline":t.isMultiline,"is-rich-text":t.isRichText,"validation-status":t.validationStatus},null,8,["model","is-multiline","is-rich-text","validation-status"])})),256)),e.createElementVNode("span",{class:"fa fa-plus-circle",onClick:n[0]||(n[0]=function(e){return t.addText(t.store,t.model)})})],64)},Jr();var ea=function(){function e(t){o(this,e),this.bitRate=t.bitRate,this.sampleRate=t.sampleRate,this.dataBuffer=[],this.encoder=new Jr.Mp3Encoder(1,this.sampleRate,this.bitRate)}return a(e,[{key:"encode",value:function(e){for(var t=this._convertBuffer(e),n=t.length,o=0;n>=0;o+=1152){var r=t.subarray(o,o+1152),a=this.encoder.encodeBuffer(r);this.dataBuffer.push(new Int8Array(a)),n-=1152}}},{key:"finish",value:function(){this.dataBuffer.push(this.encoder.flush());var e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}},{key:"_floatTo16BitPCM",value:function(e,t){for(var n=0;n<e.length;n++){var o=Math.max(-1,Math.min(1,e[n]));t[n]=o<0?32768*o:32767*o}}},{key:"_convertBuffer",value:function(e){var t=new Float32Array(e),n=new Int16Array(e.length);return this._floatTo16BitPCM(t,n),n}}]),e}(),ta=function(){function e(t){o(this,e),this.bufferSize=t.bufferSize||4096,this.sampleRate=t.sampleRate,this.samples=t.samples}return a(e,[{key:"finish",value:function(){this._joinSamples();var e=new ArrayBuffer(44+2*this.samples.length),t=new DataView(e);this._writeString(t,0,"RIFF"),t.setUint32(4,36+2*this.samples.length,!0),this._writeString(t,8,"WAVE"),this._writeString(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,1,!0),t.setUint32(24,this.sampleRate,!0),t.setUint32(28,4*this.sampleRate,!0),t.setUint16(32,4,!0),t.setUint16(34,16,!0),this._writeString(t,36,"data"),t.setUint32(40,2*this.samples.length,!0),this._floatTo16BitPCM(t,44,this.samples);var n=new Blob([t],{type:"audio/wav"});return{id:Date.now(),blob:n,url:URL.createObjectURL(n)}}},{key:"_floatTo16BitPCM",value:function(e,t,n){for(var o=0;o<n.length;o++,t+=2){var r=Math.max(-1,Math.min(1,n[o]));e.setInt16(t,r<0?32768*r:32767*r,!0)}}},{key:"_joinSamples",value:function(){for(var e=this.samples.length*this.bufferSize,t=new Float64Array(e),n=0,o=0;o<this.samples.length;o++){var r=this.samples[o];t.set(r,n),n+=r.length}this.samples=t}},{key:"_writeString",value:function(e,t,n){for(var o=0;o<n.length;o++)e.setUint8(t+o,n.charCodeAt(o))}}]),e}();var na=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.format=t.format,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=1024,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}return a(e,[{key:"start",value:function(){this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia({video:!1,audio:{channelCount:1,echoCancellation:!1}}).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this._isMp3()&&!this.lameEncoder&&(this.lameEncoder=new ea(this.encoderOptions))}},{key:"stop",value:function(){this.stream.getTracks().forEach((function(e){return e.stop()})),this.input.disconnect(),this.processor.disconnect(),this.context.close();var e,t=null;this._isMp3()?t=this.lameEncoder.finish():(t=new ta({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples}).finish(),this.wavSamples=[]),t.duration=(e=this.duration)?new Date(1e3*e).toISOString().substr(14,5):null,this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}},{key:"pause",value:function(){this.stream.getTracks().forEach((function(e){return e.stop()})),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}},{key:"recordList",value:function(){return this.records}},{key:"lastRecord",value:function(){return this.records.slice(-1).pop()}},{key:"_micCaptured",value:function(e){var t=this;this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=function(e){var n=e.inputBuffer.getChannelData(0),o=0;t._isMp3()?t.lameEncoder.encode(n):t.wavSamples.push(new Float32Array(n));for(var r=0;r<n.length;++r)o+=n[r]*n[r];t.duration=parseFloat(t._duration)+parseFloat(t.context.currentTime.toFixed(2)),t.volume=Math.sqrt(o/n.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}},{key:"_micError",value:function(e){this.micFailed&&this.micFailed(e)}},{key:"_isMp3",value:function(){return"mp3"===this.format.toLowerCase()}}]),e}(),oa=e.defineComponent({name:"AudioRecorder",components:{},props:{model:{type:Object,required:!0}},methods:{},setup:function(){console.log("setup");var t="Click on record to start recording.",n=new na({micFailed:function(){o.recording=!1,o.instructionMessage=t,o.errorMessage="Failed to use microphone. Please refresh and try again and permit the use of a microphone."},bitRate:92,sampleRate:44100,format:"mp3"}),o=e.reactive({recording:!1,recordedAudio:void 0,recordedBlob:void 0,recorder:n,successMessage:"",errorMessage:"",instructionMessage:t});return{state:o,stopRecording:function(){o.recording=!1,console.log("stopRecording");var e=o.recorder;e.stop();var t=e.recordList();o.recordedAudio=t[t.length-1].url,console.log("recordedAudio",o.recordedAudio),o.recordedBlob=t[t.length-1].blob,console.log("recordedBlob",o.recordedAudio),o.recordedAudio&&(o.successMessage="Successfully recorded your story!",o.instructionMessage="")},initRecorder:function(){o.instructionMessage="Initializing...",o.recordedAudio=void 0,o.recording=!0,o.recorder.start(),o.successMessage="",o.errorMessage="",o.instructionMessage="Click stop to stop recording."}}}}),ra=function(t){return e.pushScopeId("data-v-702fccb1"),t=t(),e.popScopeId(),t},aa=ra((function(){return e.createElementVNode("br",null,null,-1)})),ia=e.createTextVNode("  "),la={key:2},sa={key:3},ca={class:"success"},ua={key:4},da={class:"danger"},ma=["src"],fa=[e.createTextVNode(" Your browser does not support the "),ra((function(){return e.createElementVNode("code",null,"audio",-1)})),e.createTextVNode(" element. ")];He("\n.success[data-v-702fccb1] {\r\n        color: green;\n}\n.danger[data-v-702fccb1] {\r\n        color: red;\n}\r\n"),oa.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",null,[aa,t.state.recording?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("button",{key:0,href:"#",onClick:n[0]||(n[0]=function(){return t.initRecorder&&t.initRecorder.apply(t,arguments)}),role:"button"},"record")),ia,t.state.recording?(e.openBlock(),e.createElementBlock("button",{key:1,class:"record-btn",href:"#",onClick:n[1]||(n[1]=function(){return t.stopRecording&&t.stopRecording.apply(t,arguments)}),role:"button"},"stop recording")):e.createCommentVNode("",!0),t.state.instructionMessage?(e.openBlock(),e.createElementBlock("div",la,[e.createElementVNode("p",null,e.toDisplayString(t.state.instructionMessage),1)])):e.createCommentVNode("",!0),t.state.successMessage?(e.openBlock(),e.createElementBlock("div",sa,[e.createElementVNode("p",ca,e.toDisplayString(t.state.successMessage),1)])):e.createCommentVNode("",!0),t.state.errorMessage?(e.openBlock(),e.createElementBlock("div",ua,[e.createElementVNode("p",da,e.toDisplayString(t.state.errorMessage),1)])):e.createCommentVNode("",!0),t.state.recordedAudio?(e.openBlock(),e.createElementBlock("audio",{key:5,controls:"",src:t.state.recordedAudio,type:"audio/mpeg",class:"mx-auto"},fa,8,ma)):e.createCommentVNode("",!0)])},oa.__scopeId="data-v-702fccb1";var _a=e.defineComponent({name:"FieldBase",props:{model:{type:null,required:!0}},components:{AttachmentField:hr,CheckboxField:vr,DateField:Or,DecimalField:Lr,EmailField:Pr,InfoField:Hr,IntegerField:qr,RadioField:Yr,SelectField:$r,MultilingualTextField:Zr,AudioRecorderField:oa},setup:function(e){var t=E(),n=Ho.getFieldType(e.model),o=Ho.cssClass(e.model),r=!1;return n!==Sn.EmailField&&n!==Sn.DateField&&n!==Sn.DecimalField&&n!==Sn.IntegerField&&n!==Sn.MonolingualTextField||(r=!0),{store:t,FieldTypes:Sn,ValidationStatus:kn,fieldType:n,cssClass:o,isMonolingualField:r}},methods:{addMonoLingualField:function(e,t){e.commit(Xo.APPEND_MONOLINGUAL_VALUE,t)}}}),pa={class:"col-md-3 field-name"},ha={key:0,style:{color:"red"}},va={class:"col-md-9 field-value"},ba={key:0,style:{color:"red"}},ga={key:1,style:{color:"red"}},Ea={key:13},Sa={key:14};_a.render=function(t,n,o,r,a,i){var l,s,c=e.resolveComponent("InfoField"),u=e.resolveComponent("AttachmentField"),d=e.resolveComponent("CheckboxField"),m=e.resolveComponent("DateField"),f=e.resolveComponent("DecimalField"),_=e.resolveComponent("EmailField"),p=e.resolveComponent("IntegerField"),h=e.resolveComponent("RadioField"),v=e.resolveComponent("SelectField"),b=e.resolveComponent("MultilingualTextField"),g=e.resolveComponent("AudioRecorderField");return t.fieldType===t.FieldTypes.InfoSection?(e.openBlock(),e.createBlock(c,{key:0,model:t.model,class:e.normalizeClass(t.cssClass)},null,8,["model","class"])):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(t.cssClass+" row")},[e.createElementVNode("div",pa,[e.createTextVNode(e.toDisplayString(t.model.name.concatenatedContent)+" ",1),this.model.required?(e.openBlock(),e.createElementBlock("span",ha,"*")):e.createCommentVNode("",!0)]),e.createElementVNode("div",va,[(null===(l=t.model)||void 0===l?void 0:l.validationStatus)===t.ValidationStatus.VALUE_REQUIRED?(e.openBlock(),e.createElementBlock("div",ba,"This field requires a value.")):e.createCommentVNode("",!0),(null===(s=t.model)||void 0===s?void 0:s.validationStatus)===t.ValidationStatus.INVALID?(e.openBlock(),e.createElementBlock("div",ga,"This field has an invalid value.")):e.createCommentVNode("",!0),t.fieldType===t.FieldTypes.AttachmentField?(e.openBlock(),e.createBlock(u,{key:2,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.CheckboxField?(e.openBlock(),e.createBlock(d,{key:3,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.DateField?(e.openBlock(),e.createBlock(m,{key:4,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.DecimalField?(e.openBlock(),e.createBlock(f,{key:5,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.EmailField?(e.openBlock(),e.createBlock(_,{key:6,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.IntegerField?(e.openBlock(),e.createBlock(p,{key:7,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.RadioField?(e.openBlock(),e.createBlock(h,{key:8,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.SelectField?(e.openBlock(),e.createBlock(v,{key:9,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.TextArea?(e.openBlock(),e.createBlock(b,{key:10,model:t.model,"is-multiline":!0},null,8,["model"])):t.fieldType===t.FieldTypes.TextField?(e.openBlock(),e.createBlock(b,{key:11,model:t.model,"is-multiline":!1},null,8,["model"])):t.fieldType===t.FieldTypes.AudioRecorderField?(e.openBlock(),e.createBlock(g,{key:12,model:t.model},null,8,["model"])):t.fieldType===t.FieldTypes.CompositeField?(e.openBlock(),e.createElementBlock("div",Ea," TODO: Implement editor template for the CompositeField")):t.fieldType===t.FieldTypes.TableField?(e.openBlock(),e.createElementBlock("div",Sa," TODO: Implement editor template for the TableField")):e.createCommentVNode("",!0),!0===t.isMonolingualField?(e.openBlock(),e.createElementBlock("span",{key:15,class:"fa fa-plus-circle",onClick:n[0]||(n[0]=function(e){return t.addMonoLingualField(t.store,t.model)})})):e.createCommentVNode("",!0)])],2))};var ka=e.defineComponent({name:"FieldContainerReference",components:{FieldPrimitive:_a},props:{model:{type:null,required:!0}},setup:function(t){var n=E(),o=e.ref(t.model.refId);return{refId:o,source:e.computed((function(){return n.getters.metadataSet(o.value)}))}}});ka.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("FieldPrimitive");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.source.fields)||void 0===l?void 0:l.$values,(function(t){return e.openBlock(),e.createBlock(s,{model:t},null,8,["model"])})),256)};var ya=e.defineComponent({name:"Field",props:{model:{type:null,required:!0}},components:{FieldPrimitive:_a,FieldContainerReference:ka},setup:function(e){return{isFieldContainerReference:Ho.getFieldType(e.model)==Sn.FieldContainerReference}}});ya.render=function(t,n,o,r,a,i){var l=e.resolveComponent("FieldContainerReference"),s=e.resolveComponent("FieldPrimitive");return t.isFieldContainerReference?(e.openBlock(),e.createBlock(l,{key:0,model:t.model},null,8,["model"])):(e.openBlock(),e.createBlock(s,{key:1,model:t.model},null,8,["model"]))};var Ta=e.defineComponent({name:"FieldContainer",props:{model:null},components:{Field:ya}});Ta.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("Field");return e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.model.fields)||void 0===l?void 0:l.$values,(function(t){return e.openBlock(),e.createBlock(s,{model:t},null,8,["model"])})),256)};var Ba=e.defineComponent({name:"ChildFormSubmission",components:{ChildForm:Ta,ChildView:zn},props:c,setup:function(t){var n=t.queryParameters,o=t.dataAttributes,r=Po.Guid.parse(n.iid),a=Po.Guid.parse(o["template-id"]),i=Po.Guid.parse(o["child-form-id"]),l=o["response-form-id"],s=o["is-admin"],c=(null==l?void 0:l.length)>0?Po.Guid.parse(l):void 0,u=E(),d=u.state;u.commit(Xo.REMOVE_FIELD_CONTAINERS),u.commit(Ko.SET_ITEM_TEMPLATE_ID,a),u.commit(Ko.SET_FORM_ID,i),u.commit(Zo.SET_PARENT_ITEM_ID,r),u.dispatch(tr.LOAD_FORM),u.dispatch(tr.LOAD_SUBMISSIONS),c&&(u.commit(Zo.SET_RESPONSE_FORM_ID,c),u.dispatch(tr.LOAD_RESPONSE_FORM));var m=e.ref([]),f=e.computed((function(){var e;return null===(e=u.state.formInstances)||void 0===e?void 0:e.$values})),_=function(e){return m.value[e],m.value[e]=!m.value[e],m.value.forEach((function(t,n){t&&n!==e&&(m.value[n]=!1)})),!1};return{store:u,childForm:e.computed((function(){return d.form})),childSubmissions:e.computed((function(){var e;return null===(e=d.formInstances)||void 0===e?void 0:e.$values})),submissionStatus:e.computed((function(){return d.submissionStatus})),eSubmissionStatus:Lo,eValidationStatus:kn,childResponseFormId:c,childResponseForm:e.computed((function(){return d.childResponseForm})),responseDisplayFlags:m,toggleDisplayResponse:_,submitChildResponse:function(e){var t;u.dispatch(tr.SUBMIT_CHILD_RESPONSE_FORM,null===(t=f.value[e])||void 0===t?void 0:t.id),_(e)},isAdmin:s}},storeConfig:{state:$o,actions:cr,mutations:nr,getters:{}},methods:{submitChildForm:function(){this.store.dispatch(tr.SUBMIT_CHILD_FORM)},removeResponseForm:function(e){confirm("Do you really want to delete this item?")&&this.store.dispatch(tr.DELETE_CHILD_RESPONSE_INSTANCE,e)},removeChildForm:function(e){confirm("Do you really want to delete this item?")&&this.store.dispatch(tr.DELETE_CHILD_INSTANCE,e)}}}),Aa=function(t){return e.pushScopeId("data-v-7768b5b2"),t=t(),e.popScopeId(),t},Ia={key:0,class:"submissionForm"},Ra={key:0,class:"alert alert-danger"},Ma={key:1},wa={key:0,class:"alert alert-info"},Ca={key:1,class:"alert alert-info"},xa={key:2,class:"alert alert-danger"},Fa={key:1,class:"mt-2 submissionInstanceList"},Na=Aa((function(){return e.createElementVNode("h3",null,"Responses",-1)})),Da={class:"submissionInstance"},Va={key:0,class:"text-right"},Oa=["onClick"],La=[Aa((function(){return e.createElementVNode("span",{class:"fas fa-reply replyBtn"},null,-1)}))],Pa=["onClick"],Ha={class:"ml-3 submissionInstanceList"},Ua={key:0,class:"mb-2"},qa={key:0,class:"childResponseForm"},Ya={key:0,class:"alert alert-danger"},Xa=["onClick"],ja={class:"submissionInstance"},Ga={key:0,class:"text-right"},$a=["onClick"];var za,Ka;He("\n.fa-remove[data-v-7768b5b2] {\r\n\t\tcolor: red;\r\n\t\tmargin-left: 30px;\n}\r\n"),Ba.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("ChildForm"),c=e.resolveComponent("ChildView");return e.openBlock(),e.createElementBlock(e.Fragment,null,[t.childForm&&Object.keys(t.childForm).length>0?(e.openBlock(),e.createElementBlock("div",Ia,[e.createVNode(s,{model:t.childForm},null,8,["model"]),(null===(l=t.childForm)||void 0===l?void 0:l.validationStatus)===t.eValidationStatus.INVALID?(e.openBlock(),e.createElementBlock("div",Ra,"Form validation failed.")):(e.openBlock(),e.createElementBlock("div",Ma,[t.submissionStatus===t.eSubmissionStatus.InProgress?(e.openBlock(),e.createElementBlock("div",wa,"Submitting...")):e.createCommentVNode("",!0),t.submissionStatus===t.eSubmissionStatus.Success?(e.openBlock(),e.createElementBlock("div",Ca,"Submission successful")):e.createCommentVNode("",!0),t.submissionStatus===t.eSubmissionStatus.Fail?(e.openBlock(),e.createElementBlock("div",xa,"Submission failed")):e.createCommentVNode("",!0)])),e.createElementVNode("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=function(e){return t.submitChildForm()})},"Submit")])):e.createCommentVNode("",!0),t.childSubmissions&&t.childSubmissions.length>0?(e.openBlock(),e.createElementBlock("div",Fa,[Na,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.childSubmissions,(function(n,o){var r;return e.openBlock(),e.createElementBlock("div",Da,[e.createVNode(c,{model:n,"hide-field-names":!0},null,8,["model"]),t.responseDisplayFlags[o]?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Va,[e.createElementVNode("a",{href:"#",class:"text-decoration-none",onClick:function(e){return t.toggleDisplayResponse(o)},onclick:"return false;"},La,8,Oa),t.isAdmin?(e.openBlock(),e.createElementBlock("span",{key:0,class:"fas fa-remove",onClick:function(e){t.removeChildForm(n)}},null,8,Pa)):e.createCommentVNode("",!0)])),e.createElementVNode("div",Ha,[t.childResponseFormId?(e.openBlock(),e.createElementBlock("div",Ua,[t.responseDisplayFlags[o]?(e.openBlock(),e.createElementBlock("div",qa,[e.createVNode(s,{model:t.childResponseForm},null,8,["model"]),(null===(r=t.childResponseForm)||void 0===r?void 0:r.validationStatus)===t.eValidationStatus.INVALID?(e.openBlock(),e.createElementBlock("div",Ya,"Response validation failed.")):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-primary submitBtn",onClick:function(e){return t.submitChildResponse(o)}},"Submit",8,Xa)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.childFieldContainers.$values,(function(n,o){return e.openBlock(),e.createElementBlock("div",ja,[e.createVNode(c,{model:n,"hide-field-names":!0},null,8,["model"]),t.isAdmin?(e.openBlock(),e.createElementBlock("div",Ga,[e.createElementVNode("span",{class:"fas fa-remove deleteBtn",onClick:function(e){t.removeResponseForm(n)}},null,8,$a)])):e.createCommentVNode("",!0)])})),256))])])})),256))])):e.createCommentVNode("",!0)],64)},Ba.__scopeId="data-v-7768b5b2",function(e){e.LOAD_FORM="LOAD_FORM",e.SUBMIT_FORM="SUBMIT_FORM"}(Ka||(Ka={}));var Wa=(i(za={},Ka.LOAD_FORM,(function(e){var t=window.location.origin+"/applets/api/itemtemplates/".concat(e.state.itemTemplateId,"/data-form/").concat(e.state.formId);fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Ko.SET_FORM,t),e.commit(Xo.APPEND_FIELD_DATA,t)})).catch((function(e){console.error("Actions.LOAD_FORM Error: ",e)}))})),i(za,Ka.SUBMIT_FORM,(function(e){var t=e.state.form;if(t&&sr(t)){e.commit(Ko.SET_SUBMISSION_STATUS,"InProgress");var n=window.location.origin+"/applets/api/items/?itemTemplateId=".concat(e.state.itemTemplateId,"&groupId=").concat(e.state.groupId?e.state.groupId:"","&collectionId=").concat(e.state.collectionId),o=new FormData;o.append("datamodel",JSON.stringify(t));var r=function(t){e.state.flattenedFileModels[t].length>0&&e.state.flattenedFileModels[t].forEach((function(e){console.log("File: ",e.name),o.append("files",e),o.append("fileKeys",t)}))};for(var a in e.state.flattenedFileModels)r(a);fetch(n,{body:o,method:"post",headers:{encType:"multipart/form-data"}}).then((function(e){return e.json()})).then((function(){e.commit(Xo.REMOVE_FIELD_CONTAINERS),e.commit(Ko.SET_FORM,null),e.commit(Ko.SET_SUBMISSION_STATUS,"Success")})).catch((function(t){e.commit(Ko.SET_SUBMISSION_STATUS,"Fail"),console.log(t)}))}})),za),Qa=e.defineComponent({name:"FormSubmission",components:{SubmissionForm:Ta},props:c,setup:function(t){console.log("props: ",JSON.stringify(t));var n=t.dataAttributes,o=Po.Guid.parse(n["template-id"]),r=Po.Guid.parse(n["form-id"]),a=Po.Guid.parse(n["collection-id"]),i=n["group-id"]?Po.Guid.parse(n["group-id"]):null,l=E();return l.commit(Xo.REMOVE_FIELD_CONTAINERS),l.commit(Ko.SET_ITEM_TEMPLATE_ID,o),l.commit(Ko.SET_FORM_ID,r),l.commit(Ko.SET_COLLECTION_ID,a),l.commit(Ko.SET_GROUP_ID,i),l.dispatch(Ka.LOAD_FORM),{store:l,submissionForm:e.computed((function(){return l.state.form})),submissionStatus:e.computed((function(){return l.state.submissionStatus})),eSubmissionStatus:Lo,eValidationStatus:kn,submitForm:function(){return l.dispatch(Ka.SUBMIT_FORM)}}},storeConfig:{state:Go,actions:Wa,mutations:Jo}}),Za={key:0},Ja={key:1,class:"alert alert-danger"},ei={key:2},ti={key:0,class:"alert alert-info"},ni={key:1,class:"alert alert-info"},oi={key:2,class:"alert alert-danger"};Qa.render=function(t,n,o,r,a,i){var l,s=e.resolveComponent("SubmissionForm");return e.openBlock(),e.createElementBlock(e.Fragment,null,[t.submissionForm&&Object.keys(t.submissionForm).length>0?(e.openBlock(),e.createElementBlock("div",Za,[e.createVNode(s,{model:t.submissionForm},null,8,["model"]),e.createElementVNode("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=function(e){return t.submitForm()})},"Submit")])):e.createCommentVNode("",!0),(null===(l=t.submissionForm)||void 0===l?void 0:l.validationStatus)===t.eValidationStatus.INVALID?(e.openBlock(),e.createElementBlock("div",Ja,"Form validation failed.")):(e.openBlock(),e.createElementBlock("div",ei,[t.submissionStatus===t.eSubmissionStatus.InProgress?(e.openBlock(),e.createElementBlock("div",ti,"Submitting...")):e.createCommentVNode("",!0),t.submissionStatus===t.eSubmissionStatus.Success?(e.openBlock(),e.createElementBlock("div",ni,"Submission successful")):e.createCommentVNode("",!0),t.submissionStatus===t.eSubmissionStatus.Fail?(e.openBlock(),e.createElementBlock("div",oi,"Submission failed")):e.createCommentVNode("",!0)]))],64)};var ri,ai;!function(e){e.SET_TEMPLATE_ID="SET_TEMPLATE_ID",e.SET_COLLECTION_ID="SET_COLLECTION_ID",e.SET_GROUP_ID="SET_GROUP_ID",e.SET_REPORT_FIELDS="SET_REPORT_FIELDS",e.SET_REPORT_DATA="SET_REPORT_DATA",e.SET_DETAILED_VIEW_URL="SET_DETAILED_VIEW_URL",e.SET_STATUS="SET_STATUS",e.SET_ID="SET_ID"}(ai||(ai={}));var ii,li=(i(ri={},ai.SET_TEMPLATE_ID,(function(e,t){e.itemTemplateID=t})),i(ri,ai.SET_COLLECTION_ID,(function(e,t){e.collectionID=t})),i(ri,ai.SET_GROUP_ID,(function(e,t){e.groupId=t})),i(ri,ai.SET_REPORT_FIELDS,(function(e,t){e.reportFields=t})),i(ri,ai.SET_REPORT_DATA,(function(e,t){e.reportData=t})),i(ri,ai.SET_DETAILED_VIEW_URL,(function(e,t){e.detailedViewUrl=t})),i(ri,ai.SET_STATUS,(function(e,t){e.templateStatus=t})),i(ri,ai.SET_ID,(function(e,t){e.id=t})),ri);!function(e){e.LOAD_DATA="LOAD_DATA"}(ii||(ii={}));var si=i({},ii.LOAD_DATA,(function(e,t){console.log("Store: ",JSON.stringify(e.state));var n=window.location.origin+"/applets/api/items/GetReportData/".concat(e.state.groupId,"/template/").concat(e.state.itemTemplateID,"/collection/").concat(e.state.collectionID,"?startDate=").concat(t.startDate?t.startDate:"","&endDate=").concat(t.endDate?t.endDate:"","&status=").concat(t.status?t.status:"");console.log("reports Load API: ",n);var o=new FormData;o.append("datamodel",JSON.stringify(e.state.reportFields)),fetch(n,{body:o,method:"post",headers:{encType:"multipart/form-data"}}).then((function(e){return e.json()})).then((function(t){e.commit(ai.SET_REPORT_DATA,t)}))})),ci=e.defineComponent({name:"Report",components:{},props:c,setup:function(t){var n=E(),o=t.dataAttributes,r=Po.Guid.parse(o["template-id"]);n.commit(ai.SET_TEMPLATE_ID,r),n.state.itemTemplateId=r;var a=Po.Guid.parse(o["collection-id"]);n.commit(ai.SET_COLLECTION_ID,a),n.state.collectionId=a;var i=Po.Guid.parse(o["group-id"]);n.commit(ai.SET_GROUP_ID,i),n.state.groupId=i;var l=JSON.parse(o["selected-fields"]);n.commit(ai.SET_REPORT_FIELDS,l),n.state.reportFields=l;var s=JSON.parse(o.status);n.commit(ai.SET_STATUS,s),n.state.templateStatus=s;var c=t.queryParameters;n.commit(ai.SET_ID,c.iid);var u=o["detailed-url"],d=e.ref(null),m=e.ref(null),f=e.ref(null);return{store:n,selectedFields:l,reportRows:e.computed((function(){return n.state.reportData})),loadData:function(){return n.dispatch(ii.LOAD_DATA,{startDate:d.value,endDate:m.value,status:f.value})},queryParams:c,templateStatus:s,detailedViewURL:function(e){return u+e},fromDate:d,toDate:m,selectedStatus:f}},storeConfig:{state:{itemTemplateID:null,collectionID:null,groupId:null,reportFields:null,reportData:null,detailedViewUrl:null,templateStatus:null,id:null},actions:si,mutations:li,getters:{}}}),ui=e.createElementVNode("h3",null,"Report",-1),di={class:"row col-md-12"},mi={class:"col-md-6 form-group"},fi=e.createElementVNode("label",null,"From:",-1),_i={class:"col-md-6 form-group"},pi=e.createElementVNode("label",{class:"form-label"},"To:",-1),hi={class:"col-md-6 form-group"},vi=e.createElementVNode("label",{class:"form-label"},"Status:",-1),bi=e.createElementVNode("option",{disabled:"",value:""},"Please select one",-1),gi=e.createElementVNode("option",{value:""},null,-1),Ei=["value"],Si={class:"col-md-6 form-group"},ki={class:"table"},yi=e.createElementVNode("th",null,null,-1),Ti=e.createElementVNode("th",null,"Submitted Date",-1),Bi=e.createElementVNode("th",null,"Status",-1),Ai=["href"],Ii={key:0},Ri={key:1},Mi={key:2},wi={key:3},Ci={key:4};ci.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[ui,e.createElementVNode("div",di,[e.createElementVNode("div",mi,[fi,e.withDirectives(e.createElementVNode("input",{type:"date",name:"startDate",id:"startDate","onUpdate:modelValue":n[0]||(n[0]=function(e){return t.fromDate=e}),class:"form-control"},null,512),[[e.vModelText,t.fromDate]])]),e.createElementVNode("div",_i,[pi,e.withDirectives(e.createElementVNode("input",{type:"date",name:"endDate",id:"endDate","onUpdate:modelValue":n[1]||(n[1]=function(e){return t.toDate=e}),class:"form-control"},null,512),[[e.vModelText,t.toDate]])]),e.createElementVNode("div",hi,[vi,e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":n[2]||(n[2]=function(e){return t.selectedStatus=e}),class:"form-control",style:{width:"auto"}},[bi,gi,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.templateStatus,(function(t){return e.openBlock(),e.createElementBlock("option",{value:t.id},e.toDisplayString(t.status),9,Ei)})),256))],512),[[e.vModelSelect,t.selectedStatus]])]),e.createElementVNode("div",Si,[e.createElementVNode("button",{class:"btn btn-primary",onClick:n[3]||(n[3]=function(e){return t.loadData()})},"Execute")])]),e.createElementVNode("table",ki,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[yi,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.selectedFields,(function(t){return e.openBlock(),e.createElementBlock("th",null,e.toDisplayString(t.fieldName),1)})),256)),Ti,Bi])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.reportRows,(function(n){return e.openBlock(),e.createElementBlock("tr",null,[e.createElementVNode("td",null,[e.createElementVNode("a",{href:t.detailedViewURL(n.itemId),class:"fa fa-eye",target:"_blank"},null,8,Ai)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.cells,(function(t){return e.openBlock(),e.createElementBlock("td",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.values,(function(t){return e.openBlock(),e.createElementBlock("div",null,["MultilingualText"===t.renderType?(e.openBlock(),e.createElementBlock("div",Ii,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.values,(function(t){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.value),1)})),256))])):e.createCommentVNode("",!0),"Options"===t.renderType?(e.openBlock(),e.createElementBlock("ul",Ri,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.values,(function(t){return e.openBlock(),e.createElementBlock("li",null,e.toDisplayString(t.value),1)})),256))])):e.createCommentVNode("",!0),"MonolingualText"===t.renderType?(e.openBlock(),e.createElementBlock("div",Mi,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.values,(function(t){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.value),1)})),256))])):e.createCommentVNode("",!0),"Attachment"===t.renderType?(e.openBlock(),e.createElementBlock("div",wi,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.values,(function(t){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.value),1)})),256))])):e.createCommentVNode("",!0),"Audio"===t.renderType?(e.openBlock(),e.createElementBlock("div",Ci,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.values,(function(t){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.value),1)})),256))])):e.createCommentVNode("",!0)])})),256))])})),256)),e.createElementVNode("td",null,[e.createElementVNode("div",null,e.toDisplayString(n.created),1)]),e.createElementVNode("td",null,[e.createElementVNode("div",null,e.toDisplayString(n.status),1)])])})),256))])])],64)};var xi=n({},$),Fi=n({},ae),Ni=n({},J),Di=e.defineComponent({name:"ImageCarousel",components:{},props:{model:{type:null,required:!0},fileUrl:{type:null,required:!0}},setup:function(t){return{files:e.computed((function(){return t.model.files.$values})),fieldUrl:e.computed((function(){return t.fileUrl})),file1stId:e.computed((function(){return t.model.files.$values[0].id}))}}}),Vi=e.createElementVNode("h5",null,"Carousel",-1),Oi={id:"carouselSlides",class:"carousel slide","data-ride":"carousel"},Li={class:"carousel-inner"},Pi=["src"],Hi=e.createElementVNode("a",{class:"carousel-control-prev",href:"#carouselSlides",role:"button","data-slide":"prev"},[e.createElementVNode("span",{class:"carousel-control-prev-icon","aria-hidden":"true"}),e.createElementVNode("span",{class:"sr-only"},"Previous")],-1),Ui=e.createElementVNode("a",{class:"carousel-control-next",href:"#carouselSlides",role:"button","data-slide":"next"},[e.createElementVNode("span",{class:"carousel-control-next-icon","aria-hidden":"true"}),e.createElementVNode("span",{class:"sr-only"},"Next")],-1);Di.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[Vi,e.createElementVNode("div",Oi,[e.createElementVNode("div",Li,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.model.files.$values,(function(n){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(n.id===t.file1stId?"carousel-item active":"carousel-item"),key:n.id},[e.createElementVNode("img",{class:"d-block w-100",src:t.fileUrl+n.fileName},null,8,Pi)],2)})),128))]),Hi,Ui])],64)};var qi=e.defineComponent({name:"ImageGallery",components:{},props:{model:{type:null,required:!0},fileUrl:{type:null,required:!0}},setup:function(t){return{files:e.computed((function(){return t.model.files.$values})),fieldUrl:e.computed((function(){return t.fileUrl}))}}}),Yi=e.createElementVNode("h5",null,"Gallery",-1),Xi={class:"container"},ji={class:"d-flex flex-row"},Gi=["src","alt"];qi.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock(e.Fragment,null,[Yi,e.createElementVNode("div",Xi,[e.createElementVNode("div",ji,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.files,(function(n){return e.openBlock(),e.createElementBlock("img",{src:t.fileUrl+n.fileName,class:"w-100 shadow-1-strong rounded mb-4",alt:n.originalFileName},null,8,Gi)})),256))])])],64)};var $i=e.defineComponent({name:"PdfViewer",components:{},props:{fileUrl:{type:null,required:!1}},setup:function(t){var n=window.location.origin+"/assets/js/vendor/pdfjs-2.13.216/web/viewer.html?file=";return{fileUrl:e.computed((function(){return t.fileUrl})),pdfViewerPath:n}}}),zi={class:"pdfViewer"},Ki=["src"];He("\n.pdfViewer[data-v-97ebf75e] {\r\n        width: 50%;\r\n        height: 79vh;\r\n        min-width: 400px;\n}\r\n"),$i.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",zi,[e.createElementVNode("iframe",{height:"100%",width:"100%",src:t.pdfViewerPath+t.fileUrl},null,8,Ki)])},$i.__scopeId="data-v-97ebf75e";var Wi=e.defineComponent({name:"FieldComponent",components:{ImageCarousel:Di,ImageGallery:qi,PdfViewer:$i},props:{model:{type:null,required:!0}},setup:function(t){var n,o=E(),r="";if(null!==(n=t.model.field)&&void 0!==n&&n.$type.includes("AttachmentField")){var a=e.ref(o.state.item.id),i=e.ref(o.getters.dataItemId(t.model.component.formTemplateId)),l=e.ref(t.model.component.fieldId);r=window.location.origin+"/api/items/"+a.value+"/"+i.value+"/"+l.value+"/"}var s="";return t.model.component.displayImagesMode&&(s="gallery"==t.model.component.displayImagesMode?"gallery":"carousel"),{htmlWrapperTag:e.computed((function(){var e;return(null===(e=t.model.component.type)||void 0===e?void 0:e.length)>0?t.model.component.type:"div"})),componentType:e.computed((function(){return t.model.component.$type.split(",")[0]})),field:e.computed((function(){return t.model.field})),fieldType:e.computed((function(){var e,n;return null===(e=t.model.field)||void 0===e||null===(n=e.$type)||void 0===n?void 0:n.split(",")[0]})),fileUrl:r,displayImagesMode:s,cssClasses:e.computed((function(){return t.model.component.cssClasses?t.model.component.cssClasses:""}))}},methods:{formatDate:function(e){return pe(e).format("MMM DD, YYYY")},formatToDecimal:function(e,t){return Number(e).toFixed(t)},getSelectedFieldLabels:function(e){return yn.getSelectedFieldLabels(e.options.$values)}}}),Qi={class:"fieldType"},Zi=e.createElementVNode("hr",null,null,-1),Ji={key:0},el={key:1},tl={key:2},nl={key:3},ol={key:4},rl={key:5},al=["href"],il=e.createElementVNode("br",null,null,-1),ll=["src"],sl=e.createElementVNode("br",null,null,-1),cl={key:3,controls:""},ul=["src","type"],dl=e.createTextVNode(" Your browser does not support the audio element. "),ml=e.createElementVNode("hr",null,null,-1);Wi.render=function(t,n,o,r,a,i){var l=e.resolveComponent("ImageCarousel"),s=e.resolveComponent("ImageGallery"),c=e.resolveComponent("PdfViewer");return e.openBlock(),e.createElementBlock("div",Qi,[Zi,"Catfish.Core.Models.Contents.Fields.TextArea"===t.fieldType||"Catfish.Core.Models.Contents.Fields.TextField"===t.fieldType?(e.openBlock(),e.createElementBlock("div",Ji,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.values.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.values.$values,(function(n){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.htmlWrapperTag),{class:e.normalizeClass(t.cssClasses)},{default:e.withCtx((function(){return[e.createTextVNode(e.toDisplayString(n.value),1)]})),_:2},1032,["class"])})),256))])})),256))])):t.fieldType.includes("Catfish.Core.Models.Contents.Fields.EmailField")||"Catfish.Core.Models.Contents.Fields.MonolingualTextField"===t.fieldType||"Catfish.Core.Models.Contents.Fields.IntegerField"===t.fieldType?(e.openBlock(),e.createElementBlock("div",el,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.values.$values,(function(n){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.htmlWrapperTag),{class:e.normalizeClass(t.cssClasses)},{default:e.withCtx((function(){return[e.createTextVNode(e.toDisplayString(n.value),1)]})),_:2},1032,["class"])})),256))])):"Catfish.Core.Models.Contents.Fields.DecimalField"===t.fieldType?(e.openBlock(),e.createElementBlock("div",tl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.values.$values,(function(n){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.htmlWrapperTag),{class:e.normalizeClass(t.cssClasses)},{default:e.withCtx((function(){return[e.createTextVNode(e.toDisplayString(t.formatToDecimal(n.value,2)),1)]})),_:2},1032,["class"])})),256))])):"Catfish.Core.Models.Contents.Fields.DateField"===t.fieldType?(e.openBlock(),e.createElementBlock("div",nl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.field.values.$values,(function(n){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.htmlWrapperTag),{class:e.normalizeClass(t.cssClasses)},{default:e.withCtx((function(){return[e.createTextVNode(e.toDisplayString(t.formatDate(n.value)),1)]})),_:2},1032,["class"])})),256))])):"Catfish.Core.Models.Contents.Fields.OptionsField"===t.fieldType||"Catfish.Core.Models.Contents.Fields.CheckboxField"===t.fieldType||"Catfish.Core.Models.Contents.Fields.RadioField"===t.fieldType||"Catfish.Core.Models.Contents.Fields.SelectField"===t.fieldType?(e.openBlock(),e.createElementBlock("div",ol,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.htmlWrapperTag),{class:e.normalizeClass(t.cssClasses)},{default:e.withCtx((function(){return[e.createTextVNode(e.toDisplayString(t.getSelectedFieldLabels(t.field)),1)]})),_:1},8,["class"]))])):t.fieldType.includes("Catfish.Core.Models.Contents.Fields.AttachmentField")||"Catfish.Core.Models.Contents.Fields.AudioRecorderField"===t.fieldType?(e.openBlock(),e.createElementBlock("div",rl,["carousel"===t.displayImagesMode?(e.openBlock(),e.createBlock(l,{key:0,model:t.field,fileUrl:t.fileUrl},null,8,["model","fileUrl"])):"gallery"===t.displayImagesMode?(e.openBlock(),e.createBlock(s,{key:1,model:t.field,fileUrl:t.fileUrl},null,8,["model","fileUrl"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:2},e.renderList(t.field.files.$values,(function(n){return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(t.cssClasses)},[n.contentType.includes("pdf")?(e.openBlock(),e.createBlock(c,{key:0,fileUrl:t.fileUrl+n.fileName},null,8,["fileUrl"])):e.createCommentVNode("",!0),n.contentType.includes("pdf")?(e.openBlock(),e.createElementBlock("a",{key:1,href:t.fileUrl+n.fileName},e.toDisplayString(n.originalFileName),9,al)):e.createCommentVNode("",!0),il,n.contentType.includes("image")?(e.openBlock(),e.createElementBlock("img",{key:2,src:t.fileUrl+n.fileName},null,8,ll)):e.createCommentVNode("",!0),sl,n.contentType.includes("audio")?(e.openBlock(),e.createElementBlock("audio",cl,[e.createElementVNode("source",{src:t.fileUrl+n.fileName,type:n.contentType},null,8,ul),dl])):e.createCommentVNode("",!0)],2)})),256))])):e.createCommentVNode("",!0),ml])};var fl=e.defineComponent({name:"StaticComponent",components:{},props:{model:{type:null,required:!0}},setup:function(t){return{htmlWrapperTag:e.computed((function(){var e;return(null===(e=t.model.type)||void 0===e?void 0:e.length)>0?t.model.type:"div"}))}}}),_l={class:"staticType"},pl=e.createElementVNode("h3",null,"Static Field",-1);fl.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",_l,[pl,(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.htmlWrapperTag),{class:e.normalizeClass(t.model.cssClasses)},{default:e.withCtx((function(){return[e.createTextVNode(e.toDisplayString(t.model.content),1)]})),_:1},8,["class"]))])};var hl=e.defineComponent({name:"ItemLayout",components:{FieldComponent:Wi,StaticComponent:fl},props:c,setup:function(t){var n=E(),o=t.queryParameters;n.commit(K.SET_ID,o.iid);var r=t.dataAttributes,a=r["selected-components"],i=JSON.parse(a),l=r["is-admin"];n.dispatch(te.LOAD_ITEM),console.log("components length:"+i.length);var s=i.filter((function(e){return e.$type.includes("StaticText")}));return console.log("static Field:"+s.length),console.log(JSON.stringify(s)),{store:n,item:e.computed((function(){return n.state.item})),queryParams:o,isAdmin:l,components:i,staticFields:s,fields:e.computed((function(){return n.getters.fields(i)}))}},storeConfig:{state:xi,actions:Fi,mutations:Ni,getters:{dataItem:function(e){return function(t){var n,o,r;return null===(n=e.item)||void 0===n||null===(o=n.dataContainer)||void 0===o||null===(r=o.$values)||void 0===r?void 0:r.filter((function(e){return e.templateId===t}))[0]}},field:function(e){return function(t,n){var o,r,a,i,l;return null===(o=e.item)||void 0===o||null===(r=o.dataContainer)||void 0===r||null===(a=r.$values)||void 0===a||null===(i=a.filter((function(e){return e.templateId===t}))[0])||void 0===i||null===(l=i.fields.$values)||void 0===l?void 0:l.filter((function(e){return e.id===n}))}},fields:function(e){return function(t){for(var n=[],o=function(o){var r=t[o].formTemplateId,a=t[o].fieldId;if(void 0!==a&&a){var i,l,s,c,u,d=null===(i=e.item)||void 0===i||null===(l=i.dataContainer)||void 0===l||null===(s=l.$values)||void 0===s||null===(c=s.filter((function(e){return e.templateId===r}))[0])||void 0===c||null===(u=c.fields.$values)||void 0===u?void 0:u.filter((function(e){return e.id===a}))[0],m={component:t[o],field:d};n.push(m)}},r=0;r<(null==t?void 0:t.length);r++)o(r);return n}},dataItemId:function(e){return function(t){var n,o,r,a;return null===(n=e.item)||void 0===n||null===(o=n.dataContainer)||void 0===o||null===(r=o.$values)||void 0===r||null===(a=r.filter((function(e){return e.templateId===t}))[0])||void 0===a?void 0:a.id}}}}}),vl={class:"item"},bl=e.createElementVNode("h3",null,"ItemLayout",-1);hl.render=function(t,n,o,r,a,i){var l=e.resolveComponent("StaticComponent"),s=e.resolveComponent("FieldComponent");return e.openBlock(),e.createElementBlock("div",vl,[bl,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.staticFields,(function(t){return e.openBlock(),e.createBlock(l,{model:t},null,8,["model"])})),256)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.fields,(function(t){return e.openBlock(),e.createBlock(s,{model:t},null,8,["model"])})),256))])};var gl=n({},$),El=n({},ae),Sl=n({},J),kl=e.defineComponent({name:"ItemLayout",components:{},props:c,setup:function(t){var n=E(),o=t.queryParameters;n.commit(K.SET_ID,o.iid);var r=t.dataAttributes,a=r["selected-components"],i=JSON.parse(a),l=r["is-admin"];n.dispatch(te.LOAD_ITEM),console.log("components length:"+i.length);var s=i.filter((function(e){return e.$type.includes("StaticText")}));return console.log("static Field:"+s.length),console.log(JSON.stringify(s)),{store:n,item:e.computed((function(){return n.state.item})),queryParams:o,isAdmin:l,components:i,staticFields:s,fields:e.computed((function(){return n.getters.fields(i)}))}},storeConfig:{state:gl,actions:El,mutations:Sl,getters:{}}}),yl={class:"item"};kl.render=function(t,n,o,r,a,i){return e.openBlock(),e.createElementBlock("div",yl)};var Tl,Bl,Al=n(n({},jo),{},{id:null,item:null,permissionList:null});!function(e){e.SET_ID="SET_ID",e.SET_USER_PERMISSIONS="SET_USER_PERMISSIONS",e.SET_ITEM="SET_ITEM"}(Bl||(Bl={}));var Il,Rl,Ml=n(n({},Wo),{},(i(Tl={},Bl.SET_ID,(function(e,t){e.id=t})),i(Tl,Bl.SET_USER_PERMISSIONS,(function(e,t){e.permissionList=t})),i(Tl,Bl.SET_ITEM,(function(e,t){var n,o,r,a;e.item=t,null==t||null===(n=t.dataContainer)||void 0===n||null===(o=n.$values)||void 0===o||o.forEach((function(t){Uo(t,e)})),null==t||null===(r=t.metadataSets)||void 0===r||null===(a=r.$values)||void 0===a||a.forEach((function(t){Uo(t,e)}))})),Tl));!function(e){e.LOAD_ITEM="LOAD_ITEM",e.GET_USER_ACTIONS="GET_USER_ACTIONS",e.CHANGE_STATE="CHANGE_STATE",e.SAVE="SAVE"}(Rl||(Rl={}));var wl=(i(Il={},Rl.LOAD_ITEM,(function(e){var t=window.location.origin+"/applets/api/items/".concat(e.state.id);console.log("Item Load API: ",t),fetch(t).then((function(e){return e.json()})).then((function(t){e.commit(Bl.SET_ITEM,t)}))})),i(Il,Rl.GET_USER_ACTIONS,(function(e){var t=window.location.origin+"/applets/api/items/getUserPermissions/".concat(e.state.id);console.log("Permission Load API: ",t),fetch(t).then((function(e){return e.json()})).then((function(t){console.log(JSON.stringify(t)),e.commit(Bl.SET_USER_PERMISSIONS,t)}))})),i(Il,Rl.SAVE,(function(e){var t=window.location.origin+"/applets/api/items/update/";console.log("Item Update API: ",t);var n=e.state.item;if(n){var o=new FormData;o.append("item",JSON.stringify(n));var r=function(t){e.state.flattenedFileModels[t].length>0&&e.state.flattenedFileModels[t].forEach((function(e){console.log("File: ",e.name),o.append("files",e),o.append("fileKeys",t)}))};for(var a in e.state.flattenedFileModels)r(a);fetch(t,{body:o,method:"post",headers:{encType:"multipart/form-data"}}).then((function(e){return e.json()})).then((function(t){console.log(JSON.stringify(t)),e.commit(Xo.REMOVE_FIELD_CONTAINERS),e.commit(Bl.SET_ITEM,t)})).catch((function(e){console.log(e)}))}})),Il),Cl=e.defineComponent({name:"ItemDetails",components:{FieldContainerViewer:zn,FieldContainerEditor:Ta},props:c,setup:function(t){var n=E(),o=t.dataAttributes;console.log("Item Details setup ..."),console.log("props: ",JSON.stringify(t));var r=o["is-admin"];console.log("isAdmin: ",r);var a=t.queryParameters;n.commit(Bl.SET_ID,a.iid),n.dispatch(Rl.GET_USER_ACTIONS),n.dispatch(Rl.LOAD_ITEM);var i=e.ref(!1);return{store:n,queryParams:a,dataItem:e.computed((function(){return n.state.item})),getContainerName:function(e){var t;return null===(t=e.name)||void 0===t?void 0:t.values.$values.map((function(e){return e.value})).join(" | ")},isAdmin:r,editMode:i,hasEditPermission:function(){var e;return null!=(null===(e=n.state.permissionList)||void 0===e?void 0:e.map((function(e){var t;return null===(t=e.permissions)||void 0===t?void 0:t.find((function(e){return"Update"==e.action}))})).find((function(e){return null!=e})))},isEditable:function(e){if(i.value){var t,o=null===(t=n.state.permissionList.find((function(t){return t.formId==e.id})))||void 0===t?void 0:t.permissions;return null!=(null==o?void 0:o.find((function(e){return"Update"==e.action})))}return!1},isModified:e.computed((function(){return n.state.modified})),save:function(){return n.dispatch(Rl.SAVE)}}},storeConfig:{state:Al,actions:wl,mutations:Ml,getters:{metadataSet:function(e){return function(t){var n,o,r;return null===(n=e.item)||void 0===n||null===(o=n.metadataSets)||void 0===o||null===(r=o.$values)||void 0===r?void 0:r.find((function(e){return e.templateId===t}))}}}},methods:{}}),xl={class:"controls"},Fl={key:0},Nl={key:1};He("\n.field-name[data-v-24846760] {\r\n        font-weight: bold !important;\n}\n.fa-remove[data-v-24846760] {\r\n        color: red;\r\n        margin-left: 30px;\n}\n.controls[data-v-24846760]{\r\n        text-align:right;\n}\n.btn[data-v-24846760]{\r\n        margin: 5px;\n}\r\n"),Cl.render=function(t,n,o,r,a,i){var l,s,c,u,d=e.resolveComponent("FieldContainerEditor"),m=e.resolveComponent("FieldContainerViewer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xl,[t.isModified?(e.openBlock(),e.createElementBlock("button",{key:0,onClick:n[0]||(n[0]=function(e){return t.save()}),class:"btn btn-success"},"Save")):e.createCommentVNode("",!0),t.hasEditPermission()?(e.openBlock(),e.createElementBlock("button",{key:1,onClick:n[1]||(n[1]=function(e){return t.editMode=!t.editMode}),class:"btn btn-primary"},[t.editMode?(e.openBlock(),e.createElementBlock("span",Fl,"View")):(e.openBlock(),e.createElementBlock("span",Nl,"Edit"))])):e.createCommentVNode("",!0)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(l=t.dataItem)||void 0===l||null===(s=l.metadataSets)||void 0===s?void 0:s.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("h4",null,e.toDisplayString(t.getContainerName(n)),1),t.isEditable(n)?(e.openBlock(),e.createBlock(d,{key:0,model:n},null,8,["model"])):(e.openBlock(),e.createBlock(m,{key:1,model:n},null,8,["model"]))])})),256)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null===(c=t.dataItem)||void 0===c||null===(u=c.dataContainer)||void 0===u?void 0:u.$values,(function(n){return e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("h4",null,e.toDisplayString(t.getContainerName(n)),1),t.isEditable(n)?(e.openBlock(),e.createBlock(d,{key:0,model:n},null,8,["model"])):(e.openBlock(),e.createBlock(m,{key:1,model:n},null,8,["model"]))])})),256))],64)},Cl.__scopeId="data-v-24846760";var Dl=Object.freeze({__proto__:null,Carousel:u,KeywordSearch:Dt,ItemTemplateEditor:hn,ItemEditor:bn,ItemViewer:eo,ProcessManager:yo,Grid:Do,ChildFormSubmission:Ba,FormSubmission:Qa,Report:ci,ItemLayout:hl,EntityManager:kl,ItemDetails:Cl}),Vl=function(e){Object.entries(Dl).forEach((function(t){var n=l(t,2),o=n[0],r=n[1];e.component(o,r)}))},Ol=Object.freeze({__proto__:null,default:Vl,Carousel:u,KeywordSearch:Dt,ItemTemplateEditor:hn,ItemEditor:bn,ItemViewer:eo,ProcessManager:yo,Grid:Do,ChildFormSubmission:Ba,FormSubmission:Qa,Report:ci,ItemLayout:hl,EntityManager:kl,ItemDetails:Cl});return Object.entries(Ol).forEach((function(e){var t=l(e,2),n=t[0],o=t[1];"default"!==n&&(Vl[n]=o)})),Vl}(Vue);